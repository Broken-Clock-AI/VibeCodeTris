{"version":3,"file":"webworkerAll-C9kG2zA6.js","sources":["../../node_modules/pixi.js/lib/app/ResizePlugin.mjs","../../node_modules/pixi.js/lib/app/TickerPlugin.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/AbstractBitmapFont.mjs","../../node_modules/tiny-lru/dist/tiny-lru.js","../../node_modules/pixi.js/lib/scene/text/canvas/utils/fontStringFromTextStyle.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/CanvasTextMetrics.mjs","../../node_modules/pixi.js/lib/scene/text/TextStyle.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/utils/getCanvasFillStyle.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/DynamicBitmapFont.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/utils/getBitmapTextLayout.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/utils/resolveCharacters.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/BitmapFontManager.mjs","../../node_modules/pixi.js/lib/filters/defaults/defaultFilter.vert.mjs","../../node_modules/pixi.js/lib/filters/defaults/passthrough/passthrough.frag.mjs","../../node_modules/pixi.js/lib/filters/defaults/passthrough/passthrough.wgsl.mjs","../../node_modules/pixi.js/lib/filters/defaults/passthrough/PassthroughFilter.mjs","../../node_modules/pixi.js/lib/filters/FilterPipe.mjs","../../node_modules/pixi.js/lib/scene/container/bounds/getRenderableBounds.mjs","../../node_modules/pixi.js/lib/filters/FilterSystem.mjs","../../node_modules/pixi.js/lib/scene/mesh/shared/MeshGeometry.mjs","../../node_modules/pixi.js/lib/utils/canvas/getCanvasBoundingBox.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/CanvasTextGenerator.mjs","../../node_modules/pixi.js/lib/scene/text-html/HTMLTextRenderData.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/measureHtmlText.mjs","../../node_modules/pixi.js/lib/scene/graphics/shared/GraphicsPipe.mjs","../../node_modules/pixi.js/lib/scene/mesh-plane/PlaneGeometry.mjs","../../node_modules/pixi.js/lib/scene/mesh/shared/BatchableMesh.mjs","../../node_modules/pixi.js/lib/scene/mesh/shared/MeshPipe.mjs","../../node_modules/pixi.js/lib/scene/particle-container/gl/GlParticleContainerAdaptor.mjs","../../node_modules/pixi.js/lib/scene/particle-container/gpu/GpuParticleContainerAdaptor.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/utils/createIndicesForQuads.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/utils/generateParticleUpdateFunction.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/ParticleBuffer.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/shader/particles.frag.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/shader/particles.vert.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/shader/particles.wgsl.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/shader/ParticleShader.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/ParticleContainerPipe.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/GlParticleContainerPipe.mjs","../../node_modules/pixi.js/lib/scene/particle-container/shared/GpuParticleContainerPipe.mjs","../../node_modules/pixi.js/lib/scene/sprite-nine-slice/NineSliceGeometry.mjs","../../node_modules/pixi.js/lib/scene/sprite-nine-slice/NineSliceSpritePipe.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/shader/tilingBit.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/shader/TilingSpriteShader.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/utils/QuadGeometry.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/utils/setPositions.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/utils/applyMatrix.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/utils/setUvs.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/TilingSpritePipe.mjs","../../node_modules/pixi.js/lib/scene/text/sdfShader/shader-bits/localUniformMSDFBit.mjs","../../node_modules/pixi.js/lib/scene/text/sdfShader/shader-bits/mSDFBit.mjs","../../node_modules/pixi.js/lib/scene/text/sdfShader/SdfShader.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/BitmapTextPipe.mjs","../../node_modules/pixi.js/lib/scene/text-html/BatchableHTMLText.mjs","../../node_modules/pixi.js/lib/scene/text/utils/updateTextBounds.mjs","../../node_modules/pixi.js/lib/scene/text-html/HTMLTextPipe.mjs","../../node_modules/pixi.js/lib/utils/browser/isSafari.mjs","../../node_modules/pixi.js/lib/scene/text/utils/getPo2TextureFromSource.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/extractFontFamilies.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/loadFontAsBase64.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/loadFontCSS.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/getFontCss.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/getSVGUrl.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/getTemporaryCanvasFromImage.mjs","../../node_modules/pixi.js/lib/scene/text-html/utils/loadSVGImage.mjs","../../node_modules/pixi.js/lib/scene/text-html/HTMLTextSystem.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/BatchableText.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/CanvasTextPipe.mjs","../../node_modules/pixi.js/lib/scene/text/canvas/CanvasTextSystem.mjs","../../node_modules/pixi.js/lib/app/init.mjs","../../node_modules/pixi.js/lib/scene/graphics/init.mjs","../../node_modules/pixi.js/lib/scene/mesh/init.mjs","../../node_modules/pixi.js/lib/scene/particle-container/init.mjs","../../node_modules/pixi.js/lib/scene/text/init.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/init.mjs","../../node_modules/pixi.js/lib/scene/text-html/init.mjs","../../node_modules/pixi.js/lib/scene/sprite-tiling/init.mjs","../../node_modules/pixi.js/lib/scene/sprite-nine-slice/init.mjs","../../node_modules/pixi.js/lib/filters/init.mjs"],"sourcesContent":["import { ExtensionType } from '../extensions/Extensions.mjs';\n\n\"use strict\";\nclass ResizePlugin {\n  /**\n   * Initialize the plugin with scope of application instance\n   * @private\n   * @param {object} [options] - See application options\n   */\n  static init(options) {\n    Object.defineProperty(\n      this,\n      \"resizeTo\",\n      {\n        set(dom) {\n          globalThis.removeEventListener(\"resize\", this.queueResize);\n          this._resizeTo = dom;\n          if (dom) {\n            globalThis.addEventListener(\"resize\", this.queueResize);\n            this.resize();\n          }\n        },\n        get() {\n          return this._resizeTo;\n        }\n      }\n    );\n    this.queueResize = () => {\n      if (!this._resizeTo) {\n        return;\n      }\n      this._cancelResize();\n      this._resizeId = requestAnimationFrame(() => this.resize());\n    };\n    this._cancelResize = () => {\n      if (this._resizeId) {\n        cancelAnimationFrame(this._resizeId);\n        this._resizeId = null;\n      }\n    };\n    this.resize = () => {\n      if (!this._resizeTo) {\n        return;\n      }\n      this._cancelResize();\n      let width;\n      let height;\n      if (this._resizeTo === globalThis.window) {\n        width = globalThis.innerWidth;\n        height = globalThis.innerHeight;\n      } else {\n        const { clientWidth, clientHeight } = this._resizeTo;\n        width = clientWidth;\n        height = clientHeight;\n      }\n      this.renderer.resize(width, height);\n      this.render();\n    };\n    this._resizeId = null;\n    this._resizeTo = null;\n    this.resizeTo = options.resizeTo || null;\n  }\n  /**\n   * Clean up the ticker, scoped to application\n   * @private\n   */\n  static destroy() {\n    globalThis.removeEventListener(\"resize\", this.queueResize);\n    this._cancelResize();\n    this._cancelResize = null;\n    this.queueResize = null;\n    this.resizeTo = null;\n    this.resize = null;\n  }\n}\n/** @ignore */\nResizePlugin.extension = ExtensionType.Application;\n\nexport { ResizePlugin };\n//# sourceMappingURL=ResizePlugin.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\nimport { UPDATE_PRIORITY } from '../ticker/const.mjs';\nimport { Ticker } from '../ticker/Ticker.mjs';\n\n\"use strict\";\nclass TickerPlugin {\n  /**\n   * Initialize the plugin with scope of application instance\n   * @private\n   * @param {object} [options] - See application options\n   */\n  static init(options) {\n    options = Object.assign({\n      autoStart: true,\n      sharedTicker: false\n    }, options);\n    Object.defineProperty(\n      this,\n      \"ticker\",\n      {\n        set(ticker) {\n          if (this._ticker) {\n            this._ticker.remove(this.render, this);\n          }\n          this._ticker = ticker;\n          if (ticker) {\n            ticker.add(this.render, this, UPDATE_PRIORITY.LOW);\n          }\n        },\n        get() {\n          return this._ticker;\n        }\n      }\n    );\n    this.stop = () => {\n      this._ticker.stop();\n    };\n    this.start = () => {\n      this._ticker.start();\n    };\n    this._ticker = null;\n    this.ticker = options.sharedTicker ? Ticker.shared : new Ticker();\n    if (options.autoStart) {\n      this.start();\n    }\n  }\n  /**\n   * Clean up the ticker, scoped to application.\n   * @private\n   */\n  static destroy() {\n    if (this._ticker) {\n      const oldTicker = this._ticker;\n      this.ticker = null;\n      oldTicker.destroy();\n    }\n  }\n}\n/** @ignore */\nTickerPlugin.extension = ExtensionType.Application;\n\nexport { TickerPlugin };\n//# sourceMappingURL=TickerPlugin.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nclass AbstractBitmapFont extends EventEmitter {\n  constructor() {\n    super(...arguments);\n    /** The map of characters by character code. */\n    this.chars = /* @__PURE__ */ Object.create(null);\n    /**\n     * The line-height of the font face in pixels.\n     * @type {number}\n     */\n    this.lineHeight = 0;\n    /**\n     * The name of the font face\n     * @type {string}\n     */\n    this.fontFamily = \"\";\n    /** The metrics of the font face. */\n    this.fontMetrics = { fontSize: 0, ascent: 0, descent: 0 };\n    /**\n     * The offset of the font face from the baseline.\n     * @type {number}\n     */\n    this.baseLineOffset = 0;\n    /** The range and type of the distance field for this font. */\n    this.distanceField = { type: \"none\", range: 0 };\n    /** The map of base page textures (i.e., sheets of glyphs). */\n    this.pages = [];\n    /** should the fill for this font be applied as a tint to the text. */\n    this.applyFillAsTint = true;\n    /** The size of the font face in pixels. */\n    this.baseMeasurementFontSize = 100;\n    this.baseRenderedFontSize = 100;\n  }\n  /**\n   * The name of the font face.\n   * @deprecated since 8.0.0 Use `fontFamily` instead.\n   */\n  get font() {\n    deprecation(v8_0_0, \"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead.\");\n    return this.fontFamily;\n  }\n  /**\n   * The map of base page textures (i.e., sheets of glyphs).\n   * @deprecated since 8.0.0 Use `pages` instead.\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  /**\n   * The size of the font face in pixels.\n   * @deprecated since 8.0.0 Use `fontMetrics.fontSize` instead.\n   */\n  get size() {\n    deprecation(v8_0_0, \"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead.\");\n    return this.fontMetrics.fontSize;\n  }\n  /**\n   * The kind of distance field for this font or \"none\".\n   * @deprecated since 8.0.0 Use `distanceField.type` instead.\n   */\n  get distanceFieldRange() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead.\");\n    return this.distanceField.range;\n  }\n  /**\n   * The range of the distance field in pixels.\n   * @deprecated since 8.0.0 Use `distanceField.range` instead.\n   */\n  get distanceFieldType() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead.\");\n    return this.distanceField.type;\n  }\n  destroy(destroyTextures = false) {\n    this.emit(\"destroy\", this);\n    this.removeAllListeners();\n    for (const i in this.chars) {\n      this.chars[i].texture?.destroy();\n    }\n    this.chars = null;\n    if (destroyTextures) {\n      this.pages.forEach((page) => page.texture.destroy(true));\n      this.pages = null;\n    }\n  }\n}\n\nexport { AbstractBitmapFont };\n//# sourceMappingURL=AbstractBitmapFont.mjs.map\n","/**\n * tiny-lru\n *\n * @copyright 2025 Jason Mulligan <jason.mulligan@avoidwork.com>\n * @license BSD-3-Clause\n * @version 11.4.5\n */\n/**\n * A high-performance Least Recently Used (LRU) cache implementation with optional TTL support.\n * Items are automatically evicted when the cache reaches its maximum size,\n * removing the least recently used items first. All core operations (get, set, delete) are O(1).\n *\n * @class LRU\n * @example\n * // Create a cache with max 100 items\n * const cache = new LRU(100);\n * cache.set('key1', 'value1');\n * console.log(cache.get('key1')); // 'value1'\n *\n * @example\n * // Create a cache with TTL\n * const cache = new LRU(100, 5000); // 5 second TTL\n * cache.set('key1', 'value1');\n * // After 5 seconds, key1 will be expired\n */\nclass LRU {\n\t/**\n\t * Creates a new LRU cache instance.\n\t * Note: Constructor does not validate parameters. Use lru() factory function for parameter validation.\n\t *\n\t * @constructor\n\t * @param {number} [max=0] - Maximum number of items to store. 0 means unlimited.\n\t * @param {number} [ttl=0] - Time to live in milliseconds. 0 means no expiration.\n\t * @param {boolean} [resetTtl=false] - Whether to reset TTL when accessing existing items via get().\n\t * @example\n\t * const cache = new LRU(1000, 60000, true); // 1000 items, 1 minute TTL, reset on access\n\t * @see {@link lru} For parameter validation\n\t * @since 1.0.0\n\t */\n\tconstructor (max = 0, ttl = 0, resetTtl = false) {\n\t\tthis.first = null;\n\t\tthis.items = Object.create(null);\n\t\tthis.last = null;\n\t\tthis.max = max;\n\t\tthis.resetTtl = resetTtl;\n\t\tthis.size = 0;\n\t\tthis.ttl = ttl;\n\t}\n\n\t/**\n\t * Removes all items from the cache.\n\t *\n\t * @method clear\n\t * @memberof LRU\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.clear();\n\t * console.log(cache.size); // 0\n\t * @since 1.0.0\n\t */\n\tclear () {\n\t\tthis.first = null;\n\t\tthis.items = Object.create(null);\n\t\tthis.last = null;\n\t\tthis.size = 0;\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes an item from the cache by key.\n\t *\n\t * @method delete\n\t * @memberof LRU\n\t * @param {string} key - The key of the item to delete.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * cache.delete('key1');\n\t * console.log(cache.has('key1')); // false\n\t * @see {@link LRU#has}\n\t * @see {@link LRU#clear}\n\t * @since 1.0.0\n\t */\n\tdelete (key) {\n\t\tif (this.has(key)) {\n\t\t\tconst item = this.items[key];\n\n\t\t\tdelete this.items[key];\n\t\t\tthis.size--;\n\n\t\t\tif (item.prev !== null) {\n\t\t\t\titem.prev.next = item.next;\n\t\t\t}\n\n\t\t\tif (item.next !== null) {\n\t\t\t\titem.next.prev = item.prev;\n\t\t\t}\n\n\t\t\tif (this.first === item) {\n\t\t\t\tthis.first = item.next;\n\t\t\t}\n\n\t\t\tif (this.last === item) {\n\t\t\t\tthis.last = item.prev;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an array of [key, value] pairs for the specified keys.\n\t * Order follows LRU order (least to most recently used).\n\t *\n\t * @method entries\n\t * @memberof LRU\n\t * @param {string[]} [keys=this.keys()] - Array of keys to get entries for. Defaults to all keys.\n\t * @returns {Array<Array<*>>} Array of [key, value] pairs in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * console.log(cache.entries()); // [['a', 1], ['b', 2]]\n\t * console.log(cache.entries(['a'])); // [['a', 1]]\n\t * @see {@link LRU#keys}\n\t * @see {@link LRU#values}\n\t * @since 11.1.0\n\t */\n\tentries (keys = this.keys()) {\n\t\treturn keys.map(key => [key, this.get(key)]);\n\t}\n\n\t/**\n\t * Removes the least recently used item from the cache.\n\t *\n\t * @method evict\n\t * @memberof LRU\n\t * @param {boolean} [bypass=false] - Whether to force eviction even when cache is empty.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('old', 'value').set('new', 'value');\n\t * cache.evict(); // Removes 'old' item\n\t * @see {@link LRU#setWithEvicted}\n\t * @since 1.0.0\n\t */\n\tevict (bypass = false) {\n\t\tif (bypass || this.size > 0) {\n\t\t\tconst item = this.first;\n\n\t\t\tdelete this.items[item.key];\n\n\t\t\tif (--this.size === 0) {\n\t\t\t\tthis.first = null;\n\t\t\t\tthis.last = null;\n\t\t\t} else {\n\t\t\t\tthis.first = item.next;\n\t\t\t\tthis.first.prev = null;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns the expiration timestamp for a given key.\n\t *\n\t * @method expiresAt\n\t * @memberof LRU\n\t * @param {string} key - The key to check expiration for.\n\t * @returns {number|undefined} The expiration timestamp in milliseconds, or undefined if key doesn't exist.\n\t * @example\n\t * const cache = new LRU(100, 5000); // 5 second TTL\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.expiresAt('key1')); // timestamp 5 seconds from now\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#has}\n\t * @since 1.0.0\n\t */\n\texpiresAt (key) {\n\t\tlet result;\n\n\t\tif (this.has(key)) {\n\t\t\tresult = this.items[key].expiry;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Retrieves a value from the cache by key. Updates the item's position to most recently used.\n\t *\n\t * @method get\n\t * @memberof LRU\n\t * @param {string} key - The key to retrieve.\n\t * @returns {*} The value associated with the key, or undefined if not found or expired.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.get('key1')); // 'value1'\n\t * console.log(cache.get('nonexistent')); // undefined\n\t * @see {@link LRU#set}\n\t * @see {@link LRU#has}\n\t * @since 1.0.0\n\t */\n\tget (key) {\n\t\tconst item = this.items[key];\n\n\t\tif (item !== undefined) {\n\t\t\t// Check TTL only if enabled to avoid unnecessary Date.now() calls\n\t\t\tif (this.ttl > 0) {\n\t\t\t\tif (item.expiry <= Date.now()) {\n\t\t\t\t\tthis.delete(key);\n\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fast LRU update without full set() overhead\n\t\t\tthis.moveToEnd(item);\n\n\t\t\treturn item.value;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Checks if a key exists in the cache.\n\t *\n\t * @method has\n\t * @memberof LRU\n\t * @param {string} key - The key to check for.\n\t * @returns {boolean} True if the key exists, false otherwise.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.has('key1')); // true\n\t * console.log(cache.has('nonexistent')); // false\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#delete}\n\t * @since 9.0.0\n\t */\n\thas (key) {\n\t\treturn key in this.items;\n\t}\n\n\t/**\n\t * Efficiently moves an item to the end of the LRU list (most recently used position).\n\t * This is an internal optimization method that avoids the overhead of the full set() operation\n\t * when only LRU position needs to be updated.\n\t *\n\t * @method moveToEnd\n\t * @memberof LRU\n\t * @param {Object} item - The cache item with prev/next pointers to reposition.\n\t * @private\n\t * @since 11.3.5\n\t */\n\tmoveToEnd (item) {\n\t\t// If already at the end, nothing to do\n\t\tif (this.last === item) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove item from current position in the list\n\t\tif (item.prev !== null) {\n\t\t\titem.prev.next = item.next;\n\t\t}\n\n\t\tif (item.next !== null) {\n\t\t\titem.next.prev = item.prev;\n\t\t}\n\n\t\t// Update first pointer if this was the first item\n\t\tif (this.first === item) {\n\t\t\tthis.first = item.next;\n\t\t}\n\n\t\t// Add item to the end\n\t\titem.prev = this.last;\n\t\titem.next = null;\n\n\t\tif (this.last !== null) {\n\t\t\tthis.last.next = item;\n\t\t}\n\n\t\tthis.last = item;\n\n\t\t// Handle edge case: if this was the only item, it's also first\n\t\tif (this.first === null) {\n\t\t\tthis.first = item;\n\t\t}\n\t}\n\n\t/**\n\t * Returns an array of all keys in the cache, ordered from least to most recently used.\n\t *\n\t * @method keys\n\t * @memberof LRU\n\t * @returns {string[]} Array of keys in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * cache.get('a'); // Move 'a' to most recent\n\t * console.log(cache.keys()); // ['b', 'a']\n\t * @see {@link LRU#values}\n\t * @see {@link LRU#entries}\n\t * @since 9.0.0\n\t */\n\tkeys () {\n\t\tconst result = [];\n\t\tlet x = this.first;\n\n\t\twhile (x !== null) {\n\t\t\tresult.push(x.key);\n\t\t\tx = x.next;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Sets a value in the cache and returns any evicted item.\n\t *\n\t * @method setWithEvicted\n\t * @memberof LRU\n\t * @param {string} key - The key to set.\n\t * @param {*} value - The value to store.\n\t * @param {boolean} [resetTtl=this.resetTtl] - Whether to reset the TTL for this operation.\n\t * @returns {Object|null} The evicted item (if any) with shape {key, value, expiry, prev, next}, or null.\n\t * @example\n\t * const cache = new LRU(2);\n\t * cache.set('a', 1).set('b', 2);\n\t * const evicted = cache.setWithEvicted('c', 3); // evicted = {key: 'a', value: 1, ...}\n\t * @see {@link LRU#set}\n\t * @see {@link LRU#evict}\n\t * @since 11.3.0\n\t */\n\tsetWithEvicted (key, value, resetTtl = this.resetTtl) {\n\t\tlet evicted = null;\n\n\t\tif (this.has(key)) {\n\t\t\tthis.set(key, value, true, resetTtl);\n\t\t} else {\n\t\t\tif (this.max > 0 && this.size === this.max) {\n\t\t\t\tevicted = {...this.first};\n\t\t\t\tthis.evict(true);\n\t\t\t}\n\n\t\t\tlet item = this.items[key] = {\n\t\t\t\texpiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n\t\t\t\tkey: key,\n\t\t\t\tprev: this.last,\n\t\t\t\tnext: null,\n\t\t\t\tvalue\n\t\t\t};\n\n\t\t\tif (++this.size === 1) {\n\t\t\t\tthis.first = item;\n\t\t\t} else {\n\t\t\t\tthis.last.next = item;\n\t\t\t}\n\n\t\t\tthis.last = item;\n\t\t}\n\n\t\treturn evicted;\n\t}\n\n\t/**\n\t * Sets a value in the cache. Updates the item's position to most recently used.\n\t *\n\t * @method set\n\t * @memberof LRU\n\t * @param {string} key - The key to set.\n\t * @param {*} value - The value to store.\n\t * @param {boolean} [bypass=false] - Internal parameter for setWithEvicted method.\n\t * @param {boolean} [resetTtl=this.resetTtl] - Whether to reset the TTL for this operation.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('key1', 'value1')\n\t *      .set('key2', 'value2')\n\t *      .set('key3', 'value3');\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#setWithEvicted}\n\t * @since 1.0.0\n\t */\n\tset (key, value, bypass = false, resetTtl = this.resetTtl) {\n\t\tlet item = this.items[key];\n\n\t\tif (bypass || item !== undefined) {\n\t\t\t// Existing item: update value and position\n\t\t\titem.value = value;\n\n\t\t\tif (bypass === false && resetTtl) {\n\t\t\t\titem.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl;\n\t\t\t}\n\n\t\t\t// Always move to end, but the bypass parameter affects TTL reset behavior\n\t\t\tthis.moveToEnd(item);\n\t\t} else {\n\t\t\t// New item: check for eviction and create\n\t\t\tif (this.max > 0 && this.size === this.max) {\n\t\t\t\tthis.evict(true);\n\t\t\t}\n\n\t\t\titem = this.items[key] = {\n\t\t\t\texpiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n\t\t\t\tkey: key,\n\t\t\t\tprev: this.last,\n\t\t\t\tnext: null,\n\t\t\t\tvalue\n\t\t\t};\n\n\t\t\tif (++this.size === 1) {\n\t\t\t\tthis.first = item;\n\t\t\t} else {\n\t\t\t\tthis.last.next = item;\n\t\t\t}\n\n\t\t\tthis.last = item;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an array of all values in the cache for the specified keys.\n\t * Order follows LRU order (least to most recently used).\n\t *\n\t * @method values\n\t * @memberof LRU\n\t * @param {string[]} [keys=this.keys()] - Array of keys to get values for. Defaults to all keys.\n\t * @returns {Array<*>} Array of values corresponding to the keys in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * console.log(cache.values()); // [1, 2]\n\t * console.log(cache.values(['a'])); // [1]\n\t * @see {@link LRU#keys}\n\t * @see {@link LRU#entries}\n\t * @since 11.1.0\n\t */\n\tvalues (keys = this.keys()) {\n\t\treturn keys.map(key => this.get(key));\n\t}\n}\n\n/**\n * Factory function to create a new LRU cache instance with parameter validation.\n *\n * @function lru\n * @param {number} [max=1000] - Maximum number of items to store. Must be >= 0. Use 0 for unlimited size.\n * @param {number} [ttl=0] - Time to live in milliseconds. Must be >= 0. Use 0 for no expiration.\n * @param {boolean} [resetTtl=false] - Whether to reset TTL when accessing existing items via get().\n * @returns {LRU} A new LRU cache instance.\n * @throws {TypeError} When parameters are invalid (negative numbers or wrong types).\n * @example\n * // Create cache with factory function\n * const cache = lru(100, 5000, true);\n * cache.set('key', 'value');\n *\n * @example\n * // Error handling\n * try {\n *   const cache = lru(-1); // Invalid max\n * } catch (error) {\n *   console.error(error.message); // \"Invalid max value\"\n * }\n * @see {@link LRU}\n * @since 1.0.0\n */\nfunction lru (max = 1000, ttl = 0, resetTtl = false) {\n\tif (isNaN(max) || max < 0) {\n\t\tthrow new TypeError(\"Invalid max value\");\n\t}\n\n\tif (isNaN(ttl) || ttl < 0) {\n\t\tthrow new TypeError(\"Invalid ttl value\");\n\t}\n\n\tif (typeof resetTtl !== \"boolean\") {\n\t\tthrow new TypeError(\"Invalid resetTtl value\");\n\t}\n\n\treturn new LRU(max, ttl, resetTtl);\n}export{LRU,lru};","\"use strict\";\nconst genericFontFamilies = [\n  \"serif\",\n  \"sans-serif\",\n  \"monospace\",\n  \"cursive\",\n  \"fantasy\",\n  \"system-ui\"\n];\nfunction fontStringFromTextStyle(style) {\n  const fontSizeString = typeof style.fontSize === \"number\" ? `${style.fontSize}px` : style.fontSize;\n  let fontFamilies = style.fontFamily;\n  if (!Array.isArray(style.fontFamily)) {\n    fontFamilies = style.fontFamily.split(\",\");\n  }\n  for (let i = fontFamilies.length - 1; i >= 0; i--) {\n    let fontFamily = fontFamilies[i].trim();\n    if (!/([\\\"\\'])[^\\'\\\"]+\\1/.test(fontFamily) && !genericFontFamilies.includes(fontFamily)) {\n      fontFamily = `\"${fontFamily}\"`;\n    }\n    fontFamilies[i] = fontFamily;\n  }\n  return `${style.fontStyle} ${style.fontVariant} ${style.fontWeight} ${fontSizeString} ${fontFamilies.join(\",\")}`;\n}\n\nexport { fontStringFromTextStyle };\n//# sourceMappingURL=fontStringFromTextStyle.mjs.map\n","import { lru } from 'tiny-lru';\nimport { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { fontStringFromTextStyle } from './utils/fontStringFromTextStyle.mjs';\n\n\"use strict\";\nconst contextSettings = {\n  // TextMetrics requires getImageData readback for measuring fonts.\n  willReadFrequently: true\n};\nconst _CanvasTextMetrics = class _CanvasTextMetrics {\n  /**\n   * Checking that we can use modern canvas 2D API.\n   *\n   * Note: This is an unstable API, Chrome < 94 use `textLetterSpacing`, later versions use `letterSpacing`.\n   * @see TextMetrics.experimentalLetterSpacing\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/ICanvasRenderingContext2D/letterSpacing\n   * @see https://developer.chrome.com/origintrials/#/view_trial/3585991203293757441\n   */\n  static get experimentalLetterSpacingSupported() {\n    let result = _CanvasTextMetrics._experimentalLetterSpacingSupported;\n    if (result === void 0) {\n      const proto = DOMAdapter.get().getCanvasRenderingContext2D().prototype;\n      result = _CanvasTextMetrics._experimentalLetterSpacingSupported = \"letterSpacing\" in proto || \"textLetterSpacing\" in proto;\n    }\n    return result;\n  }\n  /**\n   * @param text - the text that was measured\n   * @param style - the style that was measured\n   * @param width - the measured width of the text\n   * @param height - the measured height of the text\n   * @param lines - an array of the lines of text broken by new lines and wrapping if specified in style\n   * @param lineWidths - an array of the line widths for each line matched to `lines`\n   * @param lineHeight - the measured line height for this style\n   * @param maxLineWidth - the maximum line width for all measured lines\n   * @param {FontMetrics} fontProperties - the font properties object from TextMetrics.measureFont\n   */\n  constructor(text, style, width, height, lines, lineWidths, lineHeight, maxLineWidth, fontProperties) {\n    this.text = text;\n    this.style = style;\n    this.width = width;\n    this.height = height;\n    this.lines = lines;\n    this.lineWidths = lineWidths;\n    this.lineHeight = lineHeight;\n    this.maxLineWidth = maxLineWidth;\n    this.fontProperties = fontProperties;\n  }\n  /**\n   * Measures the supplied string of text and returns a Rectangle.\n   * @param text - The text to measure.\n   * @param style - The text style to use for measuring\n   * @param canvas - optional specification of the canvas to use for measuring.\n   * @param wordWrap\n   * @returns Measured width and height of the text.\n   */\n  static measureText(text = \" \", style, canvas = _CanvasTextMetrics._canvas, wordWrap = style.wordWrap) {\n    const textKey = `${text}-${style.styleKey}-wordWrap-${wordWrap}`;\n    if (_CanvasTextMetrics._measurementCache.has(textKey)) {\n      return _CanvasTextMetrics._measurementCache.get(textKey);\n    }\n    const font = fontStringFromTextStyle(style);\n    const fontProperties = _CanvasTextMetrics.measureFont(font);\n    if (fontProperties.fontSize === 0) {\n      fontProperties.fontSize = style.fontSize;\n      fontProperties.ascent = style.fontSize;\n    }\n    const context = _CanvasTextMetrics.__context;\n    context.font = font;\n    const outputText = wordWrap ? _CanvasTextMetrics._wordWrap(text, style, canvas) : text;\n    const lines = outputText.split(/(?:\\r\\n|\\r|\\n)/);\n    const lineWidths = new Array(lines.length);\n    let maxLineWidth = 0;\n    for (let i = 0; i < lines.length; i++) {\n      const lineWidth = _CanvasTextMetrics._measureText(lines[i], style.letterSpacing, context);\n      lineWidths[i] = lineWidth;\n      maxLineWidth = Math.max(maxLineWidth, lineWidth);\n    }\n    const strokeWidth = style._stroke?.width || 0;\n    let width = maxLineWidth + strokeWidth;\n    if (style.dropShadow) {\n      width += style.dropShadow.distance;\n    }\n    const lineHeight = style.lineHeight || fontProperties.fontSize;\n    let height = Math.max(lineHeight, fontProperties.fontSize + strokeWidth) + (lines.length - 1) * (lineHeight + style.leading);\n    if (style.dropShadow) {\n      height += style.dropShadow.distance;\n    }\n    const measurements = new _CanvasTextMetrics(\n      text,\n      style,\n      width,\n      height,\n      lines,\n      lineWidths,\n      lineHeight + style.leading,\n      maxLineWidth,\n      fontProperties\n    );\n    _CanvasTextMetrics._measurementCache.set(textKey, measurements);\n    return measurements;\n  }\n  static _measureText(text, letterSpacing, context) {\n    let useExperimentalLetterSpacing = false;\n    if (_CanvasTextMetrics.experimentalLetterSpacingSupported) {\n      if (_CanvasTextMetrics.experimentalLetterSpacing) {\n        context.letterSpacing = `${letterSpacing}px`;\n        context.textLetterSpacing = `${letterSpacing}px`;\n        useExperimentalLetterSpacing = true;\n      } else {\n        context.letterSpacing = \"0px\";\n        context.textLetterSpacing = \"0px\";\n      }\n    }\n    const metrics = context.measureText(text);\n    let metricWidth = metrics.width;\n    const actualBoundingBoxLeft = -metrics.actualBoundingBoxLeft;\n    const actualBoundingBoxRight = metrics.actualBoundingBoxRight;\n    let boundsWidth = actualBoundingBoxRight - actualBoundingBoxLeft;\n    if (metricWidth > 0) {\n      if (useExperimentalLetterSpacing) {\n        metricWidth -= letterSpacing;\n        boundsWidth -= letterSpacing;\n      } else {\n        const val = (_CanvasTextMetrics.graphemeSegmenter(text).length - 1) * letterSpacing;\n        metricWidth += val;\n        boundsWidth += val;\n      }\n    }\n    return Math.max(metricWidth, boundsWidth);\n  }\n  /**\n   * Applies newlines to a string to have it optimally fit into the horizontal\n   * bounds set by the Text object's wordWrapWidth property.\n   * @param text - String to apply word wrapping to\n   * @param style - the style to use when wrapping\n   * @param canvas - optional specification of the canvas to use for measuring.\n   * @returns New string with new lines applied where required\n   */\n  static _wordWrap(text, style, canvas = _CanvasTextMetrics._canvas) {\n    const context = canvas.getContext(\"2d\", contextSettings);\n    let width = 0;\n    let line = \"\";\n    let lines = \"\";\n    const cache = /* @__PURE__ */ Object.create(null);\n    const { letterSpacing, whiteSpace } = style;\n    const collapseSpaces = _CanvasTextMetrics._collapseSpaces(whiteSpace);\n    const collapseNewlines = _CanvasTextMetrics._collapseNewlines(whiteSpace);\n    let canPrependSpaces = !collapseSpaces;\n    const wordWrapWidth = style.wordWrapWidth + letterSpacing;\n    const tokens = _CanvasTextMetrics._tokenize(text);\n    for (let i = 0; i < tokens.length; i++) {\n      let token = tokens[i];\n      if (_CanvasTextMetrics._isNewline(token)) {\n        if (!collapseNewlines) {\n          lines += _CanvasTextMetrics._addLine(line);\n          canPrependSpaces = !collapseSpaces;\n          line = \"\";\n          width = 0;\n          continue;\n        }\n        token = \" \";\n      }\n      if (collapseSpaces) {\n        const currIsBreakingSpace = _CanvasTextMetrics.isBreakingSpace(token);\n        const lastIsBreakingSpace = _CanvasTextMetrics.isBreakingSpace(line[line.length - 1]);\n        if (currIsBreakingSpace && lastIsBreakingSpace) {\n          continue;\n        }\n      }\n      const tokenWidth = _CanvasTextMetrics._getFromCache(token, letterSpacing, cache, context);\n      if (tokenWidth > wordWrapWidth) {\n        if (line !== \"\") {\n          lines += _CanvasTextMetrics._addLine(line);\n          line = \"\";\n          width = 0;\n        }\n        if (_CanvasTextMetrics.canBreakWords(token, style.breakWords)) {\n          const characters = _CanvasTextMetrics.wordWrapSplit(token);\n          for (let j = 0; j < characters.length; j++) {\n            let char = characters[j];\n            let lastChar = char;\n            let k = 1;\n            while (characters[j + k]) {\n              const nextChar = characters[j + k];\n              if (!_CanvasTextMetrics.canBreakChars(lastChar, nextChar, token, j, style.breakWords)) {\n                char += nextChar;\n              } else {\n                break;\n              }\n              lastChar = nextChar;\n              k++;\n            }\n            j += k - 1;\n            const characterWidth = _CanvasTextMetrics._getFromCache(char, letterSpacing, cache, context);\n            if (characterWidth + width > wordWrapWidth) {\n              lines += _CanvasTextMetrics._addLine(line);\n              canPrependSpaces = false;\n              line = \"\";\n              width = 0;\n            }\n            line += char;\n            width += characterWidth;\n          }\n        } else {\n          if (line.length > 0) {\n            lines += _CanvasTextMetrics._addLine(line);\n            line = \"\";\n            width = 0;\n          }\n          const isLastToken = i === tokens.length - 1;\n          lines += _CanvasTextMetrics._addLine(token, !isLastToken);\n          canPrependSpaces = false;\n          line = \"\";\n          width = 0;\n        }\n      } else {\n        if (tokenWidth + width > wordWrapWidth) {\n          canPrependSpaces = false;\n          lines += _CanvasTextMetrics._addLine(line);\n          line = \"\";\n          width = 0;\n        }\n        if (line.length > 0 || !_CanvasTextMetrics.isBreakingSpace(token) || canPrependSpaces) {\n          line += token;\n          width += tokenWidth;\n        }\n      }\n    }\n    lines += _CanvasTextMetrics._addLine(line, false);\n    return lines;\n  }\n  /**\n   * Convenience function for logging each line added during the wordWrap method.\n   * @param line    - The line of text to add\n   * @param newLine - Add new line character to end\n   * @returns A formatted line\n   */\n  static _addLine(line, newLine = true) {\n    line = _CanvasTextMetrics._trimRight(line);\n    line = newLine ? `${line}\n` : line;\n    return line;\n  }\n  /**\n   * Gets & sets the widths of calculated characters in a cache object\n   * @param key            - The key\n   * @param letterSpacing  - The letter spacing\n   * @param cache          - The cache\n   * @param context        - The canvas context\n   * @returns The from cache.\n   */\n  static _getFromCache(key, letterSpacing, cache, context) {\n    let width = cache[key];\n    if (typeof width !== \"number\") {\n      width = _CanvasTextMetrics._measureText(key, letterSpacing, context) + letterSpacing;\n      cache[key] = width;\n    }\n    return width;\n  }\n  /**\n   * Determines whether we should collapse breaking spaces.\n   * @param whiteSpace - The TextStyle property whiteSpace\n   * @returns Should collapse\n   */\n  static _collapseSpaces(whiteSpace) {\n    return whiteSpace === \"normal\" || whiteSpace === \"pre-line\";\n  }\n  /**\n   * Determines whether we should collapse newLine chars.\n   * @param whiteSpace - The white space\n   * @returns should collapse\n   */\n  static _collapseNewlines(whiteSpace) {\n    return whiteSpace === \"normal\";\n  }\n  /**\n   * Trims breaking whitespaces from string.\n   * @param text - The text\n   * @returns Trimmed string\n   */\n  static _trimRight(text) {\n    if (typeof text !== \"string\") {\n      return \"\";\n    }\n    for (let i = text.length - 1; i >= 0; i--) {\n      const char = text[i];\n      if (!_CanvasTextMetrics.isBreakingSpace(char)) {\n        break;\n      }\n      text = text.slice(0, -1);\n    }\n    return text;\n  }\n  /**\n   * Determines if char is a newline.\n   * @param char - The character\n   * @returns True if newline, False otherwise.\n   */\n  static _isNewline(char) {\n    if (typeof char !== \"string\") {\n      return false;\n    }\n    return _CanvasTextMetrics._newlines.includes(char.charCodeAt(0));\n  }\n  /**\n   * Determines if char is a breaking whitespace.\n   *\n   * It allows one to determine whether char should be a breaking whitespace\n   * For example certain characters in CJK langs or numbers.\n   * It must return a boolean.\n   * @param char - The character\n   * @param [_nextChar] - The next character\n   * @returns True if whitespace, False otherwise.\n   */\n  static isBreakingSpace(char, _nextChar) {\n    if (typeof char !== \"string\") {\n      return false;\n    }\n    return _CanvasTextMetrics._breakingSpaces.includes(char.charCodeAt(0));\n  }\n  /**\n   * Splits a string into words, breaking-spaces and newLine characters\n   * @param text - The text\n   * @returns A tokenized array\n   */\n  static _tokenize(text) {\n    const tokens = [];\n    let token = \"\";\n    if (typeof text !== \"string\") {\n      return tokens;\n    }\n    for (let i = 0; i < text.length; i++) {\n      const char = text[i];\n      const nextChar = text[i + 1];\n      if (_CanvasTextMetrics.isBreakingSpace(char, nextChar) || _CanvasTextMetrics._isNewline(char)) {\n        if (token !== \"\") {\n          tokens.push(token);\n          token = \"\";\n        }\n        if (char === \"\\r\" && nextChar === \"\\n\") {\n          tokens.push(\"\\r\\n\");\n          i++;\n        } else {\n          tokens.push(char);\n        }\n        continue;\n      }\n      token += char;\n    }\n    if (token !== \"\") {\n      tokens.push(token);\n    }\n    return tokens;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It allows one to customise which words should break\n   * Examples are if the token is CJK or numbers.\n   * It must return a boolean.\n   * @param _token - The token\n   * @param breakWords - The style attr break words\n   * @returns Whether to break word or not\n   */\n  static canBreakWords(_token, breakWords) {\n    return breakWords;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It allows one to determine whether a pair of characters\n   * should be broken by newlines\n   * For example certain characters in CJK langs or numbers.\n   * It must return a boolean.\n   * @param _char - The character\n   * @param _nextChar - The next character\n   * @param _token - The token/word the characters are from\n   * @param _index - The index in the token of the char\n   * @param _breakWords - The style attr break words\n   * @returns whether to break word or not\n   */\n  static canBreakChars(_char, _nextChar, _token, _index, _breakWords) {\n    return true;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It is called when a token (usually a word) has to be split into separate pieces\n   * in order to determine the point to break a word.\n   * It must return an array of characters.\n   * @param token - The token to split\n   * @returns The characters of the token\n   * @see CanvasTextMetrics.graphemeSegmenter\n   */\n  static wordWrapSplit(token) {\n    return _CanvasTextMetrics.graphemeSegmenter(token);\n  }\n  /**\n   * Calculates the ascent, descent and fontSize of a given font-style\n   * @param font - String representing the style of the font\n   * @returns Font properties object\n   */\n  static measureFont(font) {\n    if (_CanvasTextMetrics._fonts[font]) {\n      return _CanvasTextMetrics._fonts[font];\n    }\n    const context = _CanvasTextMetrics._context;\n    context.font = font;\n    const metrics = context.measureText(_CanvasTextMetrics.METRICS_STRING + _CanvasTextMetrics.BASELINE_SYMBOL);\n    const properties = {\n      ascent: metrics.actualBoundingBoxAscent,\n      descent: metrics.actualBoundingBoxDescent,\n      fontSize: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent\n    };\n    _CanvasTextMetrics._fonts[font] = properties;\n    return properties;\n  }\n  /**\n   * Clear font metrics in metrics cache.\n   * @param {string} [font] - font name. If font name not set then clear cache for all fonts.\n   */\n  static clearMetrics(font = \"\") {\n    if (font) {\n      delete _CanvasTextMetrics._fonts[font];\n    } else {\n      _CanvasTextMetrics._fonts = {};\n    }\n  }\n  /**\n   * Cached canvas element for measuring text\n   * TODO: this should be private, but isn't because of backward compat, will fix later.\n   * @ignore\n   */\n  static get _canvas() {\n    if (!_CanvasTextMetrics.__canvas) {\n      let canvas;\n      try {\n        const c = new OffscreenCanvas(0, 0);\n        const context = c.getContext(\"2d\", contextSettings);\n        if (context?.measureText) {\n          _CanvasTextMetrics.__canvas = c;\n          return c;\n        }\n        canvas = DOMAdapter.get().createCanvas();\n      } catch (_cx) {\n        canvas = DOMAdapter.get().createCanvas();\n      }\n      canvas.width = canvas.height = 10;\n      _CanvasTextMetrics.__canvas = canvas;\n    }\n    return _CanvasTextMetrics.__canvas;\n  }\n  /**\n   * TODO: this should be private, but isn't because of backward compat, will fix later.\n   * @ignore\n   */\n  static get _context() {\n    if (!_CanvasTextMetrics.__context) {\n      _CanvasTextMetrics.__context = _CanvasTextMetrics._canvas.getContext(\"2d\", contextSettings);\n    }\n    return _CanvasTextMetrics.__context;\n  }\n};\n/**\n * String used for calculate font metrics.\n * These characters are all tall to help calculate the height required for text.\n */\n_CanvasTextMetrics.METRICS_STRING = \"|\\xC9q\\xC5\";\n/** Baseline symbol for calculate font metrics. */\n_CanvasTextMetrics.BASELINE_SYMBOL = \"M\";\n/** Baseline multiplier for calculate font metrics. */\n_CanvasTextMetrics.BASELINE_MULTIPLIER = 1.4;\n/** Height multiplier for setting height of canvas to calculate font metrics. */\n_CanvasTextMetrics.HEIGHT_MULTIPLIER = 2;\n/**\n * A Unicode \"character\", or \"grapheme cluster\", can be composed of multiple Unicode code points,\n * such as letters with diacritical marks (e.g. `'\\u0065\\u0301'`, letter e with acute)\n * or emojis with modifiers (e.g. `'\\uD83E\\uDDD1\\u200D\\uD83D\\uDCBB'`, technologist).\n * The new `Intl.Segmenter` API in ES2022 can split the string into grapheme clusters correctly. If it is not available,\n * PixiJS will fallback to use the iterator of String, which can only spilt the string into code points.\n * If you want to get full functionality in environments that don't support `Intl.Segmenter` (such as Firefox),\n * you can use other libraries such as [grapheme-splitter]{@link https://www.npmjs.com/package/grapheme-splitter}\n * or [graphemer]{@link https://www.npmjs.com/package/graphemer} to create a polyfill. Since these libraries can be\n * relatively large in size to handle various Unicode grapheme clusters properly, PixiJS won't use them directly.\n */\n_CanvasTextMetrics.graphemeSegmenter = (() => {\n  if (typeof Intl?.Segmenter === \"function\") {\n    const segmenter = new Intl.Segmenter();\n    return (s) => {\n      const segments = segmenter.segment(s);\n      const result = [];\n      let i = 0;\n      for (const segment of segments) {\n        result[i++] = segment.segment;\n      }\n      return result;\n    };\n  }\n  return (s) => [...s];\n})();\n/**\n * New rendering behavior for letter-spacing which uses Chrome's new native API. This will\n * lead to more accurate letter-spacing results because it does not try to manually draw\n * each character. However, this Chrome API is experimental and may not serve all cases yet.\n * @see TextMetrics.experimentalLetterSpacingSupported\n */\n_CanvasTextMetrics.experimentalLetterSpacing = false;\n/** Cache of {@link TextMetrics.FontMetrics} objects. */\n_CanvasTextMetrics._fonts = {};\n/** Cache of new line chars. */\n_CanvasTextMetrics._newlines = [\n  10,\n  // line feed\n  13\n  // carriage return\n];\n/** Cache of breaking spaces. */\n_CanvasTextMetrics._breakingSpaces = [\n  9,\n  // character tabulation\n  32,\n  // space\n  8192,\n  // en quad\n  8193,\n  // em quad\n  8194,\n  // en space\n  8195,\n  // em space\n  8196,\n  // three-per-em space\n  8197,\n  // four-per-em space\n  8198,\n  // six-per-em space\n  8200,\n  // punctuation space\n  8201,\n  // thin space\n  8202,\n  // hair space\n  8287,\n  // medium mathematical space\n  12288\n  // ideographic space\n];\n/** Cache for measured text metrics */\n_CanvasTextMetrics._measurementCache = lru(1e3);\nlet CanvasTextMetrics = _CanvasTextMetrics;\n\nexport { CanvasTextMetrics };\n//# sourceMappingURL=CanvasTextMetrics.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { Color } from '../../color/Color.mjs';\nimport { uid } from '../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { FillGradient } from '../graphics/shared/fill/FillGradient.mjs';\nimport { FillPattern } from '../graphics/shared/fill/FillPattern.mjs';\nimport { GraphicsContext } from '../graphics/shared/GraphicsContext.mjs';\nimport { toFillStyle, toStrokeStyle } from '../graphics/shared/utils/convertFillInputToFillStyle.mjs';\n\n\"use strict\";\nconst _TextStyle = class _TextStyle extends EventEmitter {\n  constructor(style = {}) {\n    super();\n    /**\n     * Unique identifier for the TextStyle class.\n     * This is used to track instances and ensure uniqueness.\n     * @internal\n     */\n    this.uid = uid(\"textStyle\");\n    /**\n     * Internal tick counter used to track updates and changes.\n     * This is incremented whenever the style is modified, allowing for efficient change detection.\n     * @internal\n     */\n    this._tick = 0;\n    convertV7Tov8Style(style);\n    const fullStyle = { ..._TextStyle.defaultTextStyle, ...style };\n    for (const key in fullStyle) {\n      const thisKey = key;\n      this[thisKey] = fullStyle[key];\n    }\n    this.update();\n    this._tick = 0;\n  }\n  /**\n   * Alignment for multiline text, does not affect single line text.\n   * @type {'left'|'center'|'right'|'justify'}\n   */\n  get align() {\n    return this._align;\n  }\n  set align(value) {\n    if (this._align === value)\n      return;\n    this._align = value;\n    this.update();\n  }\n  /** Indicates if lines can be wrapped within words, it needs wordWrap to be set to true. */\n  get breakWords() {\n    return this._breakWords;\n  }\n  set breakWords(value) {\n    if (this._breakWords === value)\n      return;\n    this._breakWords = value;\n    this.update();\n  }\n  /** Set a drop shadow for the text. */\n  get dropShadow() {\n    return this._dropShadow;\n  }\n  set dropShadow(value) {\n    if (this._dropShadow === value)\n      return;\n    if (value !== null && typeof value === \"object\") {\n      this._dropShadow = this._createProxy({ ..._TextStyle.defaultDropShadow, ...value });\n    } else {\n      this._dropShadow = value ? this._createProxy({ ..._TextStyle.defaultDropShadow }) : null;\n    }\n    this.update();\n  }\n  /** The font family, can be a single font name, or a list of names where the first is the preferred font. */\n  get fontFamily() {\n    return this._fontFamily;\n  }\n  set fontFamily(value) {\n    if (this._fontFamily === value)\n      return;\n    this._fontFamily = value;\n    this.update();\n  }\n  /** The font size (as a number it converts to px, but as a string, equivalents are '26px','20pt','160%' or '1.6em') */\n  get fontSize() {\n    return this._fontSize;\n  }\n  set fontSize(value) {\n    if (this._fontSize === value)\n      return;\n    if (typeof value === \"string\") {\n      this._fontSize = parseInt(value, 10);\n    } else {\n      this._fontSize = value;\n    }\n    this.update();\n  }\n  /**\n   * The font style.\n   * @type {'normal'|'italic'|'oblique'}\n   */\n  get fontStyle() {\n    return this._fontStyle;\n  }\n  set fontStyle(value) {\n    if (this._fontStyle === value)\n      return;\n    this._fontStyle = value.toLowerCase();\n    this.update();\n  }\n  /**\n   * The font variant.\n   * @type {'normal'|'small-caps'}\n   */\n  get fontVariant() {\n    return this._fontVariant;\n  }\n  set fontVariant(value) {\n    if (this._fontVariant === value)\n      return;\n    this._fontVariant = value;\n    this.update();\n  }\n  /**\n   * The font weight.\n   * @type {'normal'|'bold'|'bolder'|'lighter'|'100'|'200'|'300'|'400'|'500'|'600'|'700'|'800'|'900'}\n   */\n  get fontWeight() {\n    return this._fontWeight;\n  }\n  set fontWeight(value) {\n    if (this._fontWeight === value)\n      return;\n    this._fontWeight = value;\n    this.update();\n  }\n  /** The space between lines. */\n  get leading() {\n    return this._leading;\n  }\n  set leading(value) {\n    if (this._leading === value)\n      return;\n    this._leading = value;\n    this.update();\n  }\n  /** The amount of spacing between letters, default is 0. */\n  get letterSpacing() {\n    return this._letterSpacing;\n  }\n  set letterSpacing(value) {\n    if (this._letterSpacing === value)\n      return;\n    this._letterSpacing = value;\n    this.update();\n  }\n  /** The line height, a number that represents the vertical space that a letter uses. */\n  get lineHeight() {\n    return this._lineHeight;\n  }\n  set lineHeight(value) {\n    if (this._lineHeight === value)\n      return;\n    this._lineHeight = value;\n    this.update();\n  }\n  /**\n   * Occasionally some fonts are cropped. Adding some padding will prevent this from happening\n   * by adding padding to all sides of the text.\n   * > [!NOTE] This will NOT affect the positioning or bounds of the text.\n   */\n  get padding() {\n    return this._padding;\n  }\n  set padding(value) {\n    if (this._padding === value)\n      return;\n    this._padding = value;\n    this.update();\n  }\n  /**\n   * An optional filter or array of filters to apply to the text, allowing for advanced visual effects.\n   * These filters will be applied to the text as it is created, resulting in faster rendering for static text\n   * compared to applying the filter directly to the text object (which would be applied at run time).\n   * @default null\n   */\n  get filters() {\n    return this._filters;\n  }\n  set filters(value) {\n    if (this._filters === value)\n      return;\n    this._filters = Object.freeze(value);\n    this.update();\n  }\n  /**\n   * Trim transparent borders from the text texture.\n   * > [!IMPORTANT] PERFORMANCE WARNING:\n   * > This is a costly operation as it requires scanning pixel alpha values.\n   * > Avoid using `trim: true` for dynamic text, as it could significantly impact performance.\n   */\n  get trim() {\n    return this._trim;\n  }\n  set trim(value) {\n    if (this._trim === value)\n      return;\n    this._trim = value;\n    this.update();\n  }\n  /**\n   * The baseline of the text that is rendered.\n   * @type {'alphabetic'|'top'|'hanging'|'middle'|'ideographic'|'bottom'}\n   */\n  get textBaseline() {\n    return this._textBaseline;\n  }\n  set textBaseline(value) {\n    if (this._textBaseline === value)\n      return;\n    this._textBaseline = value;\n    this.update();\n  }\n  /**\n   * How newlines and spaces should be handled.\n   * Default is 'pre' (preserve, preserve).\n   *\n   *  value       | New lines     |   Spaces\n   *  ---         | ---           |   ---\n   * 'normal'     | Collapse      |   Collapse\n   * 'pre'        | Preserve      |   Preserve\n   * 'pre-line'   | Preserve      |   Collapse\n   * @type {'normal'|'pre'|'pre-line'}\n   */\n  get whiteSpace() {\n    return this._whiteSpace;\n  }\n  set whiteSpace(value) {\n    if (this._whiteSpace === value)\n      return;\n    this._whiteSpace = value;\n    this.update();\n  }\n  /** Indicates if word wrap should be used. */\n  get wordWrap() {\n    return this._wordWrap;\n  }\n  set wordWrap(value) {\n    if (this._wordWrap === value)\n      return;\n    this._wordWrap = value;\n    this.update();\n  }\n  /** The width at which text will wrap, it needs wordWrap to be set to true. */\n  get wordWrapWidth() {\n    return this._wordWrapWidth;\n  }\n  set wordWrapWidth(value) {\n    if (this._wordWrapWidth === value)\n      return;\n    this._wordWrapWidth = value;\n    this.update();\n  }\n  /**\n   * The fill style that will be used to color the text.\n   * This can be:\n   * - A color string like 'red', '#00FF00', or 'rgba(255,0,0,0.5)'\n   * - A hex number like 0xff0000 for red\n   * - A FillStyle object with properties like { color: 0xff0000, alpha: 0.5 }\n   * - A FillGradient for gradient fills\n   * - A FillPattern for pattern/texture fills\n   *\n   * When using a FillGradient, vertical gradients (angle of 90 degrees) are applied per line of text,\n   * while gradients at any other angle are spread across the entire text body as a whole.\n   * @example\n   * // Vertical gradient applied per line\n   * const verticalGradient = new FillGradient(0, 0, 0, 1)\n   *     .addColorStop(0, 0xff0000)\n   *     .addColorStop(1, 0x0000ff);\n   *\n   * const text = new Text({\n   *     text: 'Line 1\\nLine 2',\n   *     style: { fill: verticalGradient }\n   * });\n   *\n   * To manage the gradient in a global scope, set the textureSpace property of the FillGradient to 'global'.\n   * @type {string|number|FillStyle|FillGradient|FillPattern}\n   */\n  get fill() {\n    return this._originalFill;\n  }\n  set fill(value) {\n    if (value === this._originalFill)\n      return;\n    this._originalFill = value;\n    if (this._isFillStyle(value)) {\n      this._originalFill = this._createProxy({ ...GraphicsContext.defaultFillStyle, ...value }, () => {\n        this._fill = toFillStyle(\n          { ...this._originalFill },\n          GraphicsContext.defaultFillStyle\n        );\n      });\n    }\n    this._fill = toFillStyle(\n      value === 0 ? \"black\" : value,\n      GraphicsContext.defaultFillStyle\n    );\n    this.update();\n  }\n  /** A fillstyle that will be used on the text stroke, e.g., 'blue', '#FCFF00'. */\n  get stroke() {\n    return this._originalStroke;\n  }\n  set stroke(value) {\n    if (value === this._originalStroke)\n      return;\n    this._originalStroke = value;\n    if (this._isFillStyle(value)) {\n      this._originalStroke = this._createProxy({ ...GraphicsContext.defaultStrokeStyle, ...value }, () => {\n        this._stroke = toStrokeStyle(\n          { ...this._originalStroke },\n          GraphicsContext.defaultStrokeStyle\n        );\n      });\n    }\n    this._stroke = toStrokeStyle(value, GraphicsContext.defaultStrokeStyle);\n    this.update();\n  }\n  update() {\n    this._tick++;\n    this.emit(\"update\", this);\n  }\n  /** Resets all properties to the default values */\n  reset() {\n    const defaultStyle = _TextStyle.defaultTextStyle;\n    for (const key in defaultStyle) {\n      this[key] = defaultStyle[key];\n    }\n  }\n  /**\n   * Returns a unique key for this instance.\n   * This key is used for caching.\n   * @returns {string} Unique key for the instance\n   */\n  get styleKey() {\n    return `${this.uid}-${this._tick}`;\n  }\n  /**\n   * Creates a new TextStyle object with the same values as this one.\n   * @returns New cloned TextStyle object\n   */\n  clone() {\n    return new _TextStyle({\n      align: this.align,\n      breakWords: this.breakWords,\n      dropShadow: this._dropShadow ? { ...this._dropShadow } : null,\n      fill: this._fill,\n      fontFamily: this.fontFamily,\n      fontSize: this.fontSize,\n      fontStyle: this.fontStyle,\n      fontVariant: this.fontVariant,\n      fontWeight: this.fontWeight,\n      leading: this.leading,\n      letterSpacing: this.letterSpacing,\n      lineHeight: this.lineHeight,\n      padding: this.padding,\n      stroke: this._stroke,\n      textBaseline: this.textBaseline,\n      whiteSpace: this.whiteSpace,\n      wordWrap: this.wordWrap,\n      wordWrapWidth: this.wordWrapWidth,\n      filters: this._filters ? [...this._filters] : void 0\n    });\n  }\n  /**\n   * Returns the final padding for the text style, taking into account any filters applied.\n   * Used internally for correct measurements\n   * @internal\n   * @returns {number} The final padding for the text style.\n   */\n  _getFinalPadding() {\n    let filterPadding = 0;\n    if (this._filters) {\n      for (let i = 0; i < this._filters.length; i++) {\n        filterPadding += this._filters[i].padding;\n      }\n    }\n    return Math.max(this._padding, filterPadding);\n  }\n  /**\n   * Destroys this text style.\n   * @param options - Options parameter. A boolean will act as if all options\n   *  have been set to that value\n   * @example\n   * // Destroy the text style and its textures\n   * textStyle.destroy({ texture: true, textureSource: true });\n   * textStyle.destroy(true);\n   */\n  destroy(options = false) {\n    this.removeAllListeners();\n    const destroyTexture = typeof options === \"boolean\" ? options : options?.texture;\n    if (destroyTexture) {\n      const destroyTextureSource = typeof options === \"boolean\" ? options : options?.textureSource;\n      if (this._fill?.texture) {\n        this._fill.texture.destroy(destroyTextureSource);\n      }\n      if (this._originalFill?.texture) {\n        this._originalFill.texture.destroy(destroyTextureSource);\n      }\n      if (this._stroke?.texture) {\n        this._stroke.texture.destroy(destroyTextureSource);\n      }\n      if (this._originalStroke?.texture) {\n        this._originalStroke.texture.destroy(destroyTextureSource);\n      }\n    }\n    this._fill = null;\n    this._stroke = null;\n    this.dropShadow = null;\n    this._originalStroke = null;\n    this._originalFill = null;\n  }\n  _createProxy(value, cb) {\n    return new Proxy(value, {\n      set: (target, property, newValue) => {\n        if (target[property] === newValue)\n          return true;\n        target[property] = newValue;\n        cb?.(property, newValue);\n        this.update();\n        return true;\n      }\n    });\n  }\n  _isFillStyle(value) {\n    return (value ?? null) !== null && !(Color.isColorLike(value) || value instanceof FillGradient || value instanceof FillPattern);\n  }\n};\n/**\n * Default drop shadow settings used when enabling drop shadows on text.\n * These values are used as the base configuration when drop shadows are enabled without specific settings.\n * @example\n * ```ts\n * // Customize default settings globally\n * TextStyle.defaultDropShadow.alpha = 0.5;    // 50% opacity for all shadows\n * TextStyle.defaultDropShadow.blur = 2;       // 2px blur for all shadows\n * TextStyle.defaultDropShadow.color = 'blue'; // Blue shadows by default\n * ```\n */\n_TextStyle.defaultDropShadow = {\n  alpha: 1,\n  angle: Math.PI / 6,\n  blur: 0,\n  color: \"black\",\n  distance: 5\n};\n/**\n * Default text style settings used when creating new text objects.\n * These values serve as the base configuration and can be customized globally.\n * @example\n * ```ts\n * // Customize default text style globally\n * TextStyle.defaultTextStyle.fontSize = 16;\n * TextStyle.defaultTextStyle.fill = 0x333333;\n * TextStyle.defaultTextStyle.fontFamily = ['Arial', 'Helvetica', 'sans-serif'];\n * ```\n */\n_TextStyle.defaultTextStyle = {\n  align: \"left\",\n  breakWords: false,\n  dropShadow: null,\n  fill: \"black\",\n  fontFamily: \"Arial\",\n  fontSize: 26,\n  fontStyle: \"normal\",\n  fontVariant: \"normal\",\n  fontWeight: \"normal\",\n  leading: 0,\n  letterSpacing: 0,\n  lineHeight: 0,\n  padding: 0,\n  stroke: null,\n  textBaseline: \"alphabetic\",\n  trim: false,\n  whiteSpace: \"pre\",\n  wordWrap: false,\n  wordWrapWidth: 100\n};\nlet TextStyle = _TextStyle;\nfunction convertV7Tov8Style(style) {\n  const oldStyle = style;\n  if (typeof oldStyle.dropShadow === \"boolean\" && oldStyle.dropShadow) {\n    const defaults = TextStyle.defaultDropShadow;\n    style.dropShadow = {\n      alpha: oldStyle.dropShadowAlpha ?? defaults.alpha,\n      angle: oldStyle.dropShadowAngle ?? defaults.angle,\n      blur: oldStyle.dropShadowBlur ?? defaults.blur,\n      color: oldStyle.dropShadowColor ?? defaults.color,\n      distance: oldStyle.dropShadowDistance ?? defaults.distance\n    };\n  }\n  if (oldStyle.strokeThickness !== void 0) {\n    deprecation(v8_0_0, \"strokeThickness is now a part of stroke\");\n    const color = oldStyle.stroke;\n    let obj = {};\n    if (Color.isColorLike(color)) {\n      obj.color = color;\n    } else if (color instanceof FillGradient || color instanceof FillPattern) {\n      obj.fill = color;\n    } else if (Object.hasOwnProperty.call(color, \"color\") || Object.hasOwnProperty.call(color, \"fill\")) {\n      obj = color;\n    } else {\n      throw new Error(\"Invalid stroke value.\");\n    }\n    style.stroke = {\n      ...obj,\n      width: oldStyle.strokeThickness\n    };\n  }\n  if (Array.isArray(oldStyle.fillGradientStops)) {\n    deprecation(v8_0_0, \"gradient fill is now a fill pattern: `new FillGradient(...)`\");\n    if (!Array.isArray(oldStyle.fill) || oldStyle.fill.length === 0) {\n      throw new Error(\"Invalid fill value. Expected an array of colors for gradient fill.\");\n    }\n    if (oldStyle.fill.length !== oldStyle.fillGradientStops.length) {\n      warn(\"The number of fill colors must match the number of fill gradient stops.\");\n    }\n    const gradientFill = new FillGradient({\n      start: { x: 0, y: 0 },\n      end: { x: 0, y: 1 },\n      textureSpace: \"local\"\n    });\n    const fillGradientStops = oldStyle.fillGradientStops.slice();\n    const fills = oldStyle.fill.map((color) => Color.shared.setValue(color).toNumber());\n    fillGradientStops.forEach((stop, index) => {\n      gradientFill.addColorStop(stop, fills[index]);\n    });\n    style.fill = {\n      fill: gradientFill\n    };\n  }\n}\n\nexport { TextStyle };\n//# sourceMappingURL=TextStyle.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { warn } from '../../../../utils/logging/warn.mjs';\nimport { FillGradient } from '../../../graphics/shared/fill/FillGradient.mjs';\nimport { FillPattern } from '../../../graphics/shared/fill/FillPattern.mjs';\n\n\"use strict\";\nconst PRECISION = 1e5;\nfunction getCanvasFillStyle(fillStyle, context, textMetrics, padding = 0) {\n  if (fillStyle.texture === Texture.WHITE && !fillStyle.fill) {\n    return Color.shared.setValue(fillStyle.color).setAlpha(fillStyle.alpha ?? 1).toHexa();\n  } else if (!fillStyle.fill) {\n    const pattern = context.createPattern(fillStyle.texture.source.resource, \"repeat\");\n    const tempMatrix = fillStyle.matrix.copyTo(Matrix.shared);\n    tempMatrix.scale(fillStyle.texture.frame.width, fillStyle.texture.frame.height);\n    pattern.setTransform(tempMatrix);\n    return pattern;\n  } else if (fillStyle.fill instanceof FillPattern) {\n    const fillPattern = fillStyle.fill;\n    const pattern = context.createPattern(fillPattern.texture.source.resource, \"repeat\");\n    const tempMatrix = fillPattern.transform.copyTo(Matrix.shared);\n    tempMatrix.scale(\n      fillPattern.texture.frame.width,\n      fillPattern.texture.frame.height\n    );\n    pattern.setTransform(tempMatrix);\n    return pattern;\n  } else if (fillStyle.fill instanceof FillGradient) {\n    const fillGradient = fillStyle.fill;\n    const isLinear = fillGradient.type === \"linear\";\n    const isLocal = fillGradient.textureSpace === \"local\";\n    let width = 1;\n    let height = 1;\n    if (isLocal && textMetrics) {\n      width = textMetrics.width + padding;\n      height = textMetrics.height + padding;\n    }\n    let gradient;\n    let isNearlyVertical = false;\n    if (isLinear) {\n      const { start, end } = fillGradient;\n      gradient = context.createLinearGradient(\n        start.x * width,\n        start.y * height,\n        end.x * width,\n        end.y * height\n      );\n      isNearlyVertical = Math.abs(end.x - start.x) < Math.abs((end.y - start.y) * 0.1);\n    } else {\n      const { center, innerRadius, outerCenter, outerRadius } = fillGradient;\n      gradient = context.createRadialGradient(\n        center.x * width,\n        center.y * height,\n        innerRadius * width,\n        outerCenter.x * width,\n        outerCenter.y * height,\n        outerRadius * width\n      );\n    }\n    if (isNearlyVertical && isLocal && textMetrics) {\n      const ratio = textMetrics.lineHeight / height;\n      for (let i = 0; i < textMetrics.lines.length; i++) {\n        const start = (i * textMetrics.lineHeight + padding / 2) / height;\n        fillGradient.colorStops.forEach((stop) => {\n          const globalStop = start + stop.offset * ratio;\n          gradient.addColorStop(\n            // fix to 5 decimal places to avoid floating point precision issues\n            Math.floor(globalStop * PRECISION) / PRECISION,\n            Color.shared.setValue(stop.color).toHex()\n          );\n        });\n      }\n    } else {\n      fillGradient.colorStops.forEach((stop) => {\n        gradient.addColorStop(stop.offset, Color.shared.setValue(stop.color).toHex());\n      });\n    }\n    return gradient;\n  }\n  warn(\"FillStyle not recognised\", fillStyle);\n  return \"red\";\n}\n\nexport { getCanvasFillStyle };\n//# sourceMappingURL=getCanvasFillStyle.mjs.map\n","import { Color } from '../../color/Color.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\nimport { CanvasPool } from '../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { ImageSource } from '../../rendering/renderers/shared/texture/sources/ImageSource.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { TextureStyle } from '../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { fontStringFromTextStyle } from '../text/canvas/utils/fontStringFromTextStyle.mjs';\nimport { getCanvasFillStyle } from '../text/canvas/utils/getCanvasFillStyle.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { AbstractBitmapFont } from './AbstractBitmapFont.mjs';\n\n\"use strict\";\nconst _DynamicBitmapFont = class _DynamicBitmapFont extends AbstractBitmapFont {\n  /**\n   * @param options - The options for the dynamic bitmap font.\n   */\n  constructor(options) {\n    super();\n    /**\n     * this is a resolution modifier for the font size..\n     * texture resolution will also be used to scale texture according to its font size also\n     */\n    this.resolution = 1;\n    /** The pages of the font. */\n    this.pages = [];\n    this._padding = 0;\n    this._measureCache = /* @__PURE__ */ Object.create(null);\n    this._currentChars = [];\n    this._currentX = 0;\n    this._currentY = 0;\n    this._currentMaxCharHeight = 0;\n    this._currentPageIndex = -1;\n    this._skipKerning = false;\n    const dynamicOptions = { ..._DynamicBitmapFont.defaultOptions, ...options };\n    this._textureSize = dynamicOptions.textureSize;\n    this._mipmap = dynamicOptions.mipmap;\n    const style = dynamicOptions.style.clone();\n    if (dynamicOptions.overrideFill) {\n      style._fill.color = 16777215;\n      style._fill.alpha = 1;\n      style._fill.texture = Texture.WHITE;\n      style._fill.fill = null;\n    }\n    this.applyFillAsTint = dynamicOptions.overrideFill;\n    const requestedFontSize = style.fontSize;\n    style.fontSize = this.baseMeasurementFontSize;\n    const font = fontStringFromTextStyle(style);\n    if (dynamicOptions.overrideSize) {\n      if (style._stroke) {\n        style._stroke.width *= this.baseRenderedFontSize / requestedFontSize;\n      }\n    } else {\n      style.fontSize = this.baseRenderedFontSize = requestedFontSize;\n    }\n    this._style = style;\n    this._skipKerning = dynamicOptions.skipKerning ?? false;\n    this.resolution = dynamicOptions.resolution ?? 1;\n    this._padding = dynamicOptions.padding ?? 4;\n    if (dynamicOptions.textureStyle) {\n      this._textureStyle = dynamicOptions.textureStyle instanceof TextureStyle ? dynamicOptions.textureStyle : new TextureStyle(dynamicOptions.textureStyle);\n    }\n    this.fontMetrics = CanvasTextMetrics.measureFont(font);\n    this.lineHeight = style.lineHeight || this.fontMetrics.fontSize || style.fontSize;\n  }\n  ensureCharacters(chars) {\n    const charList = CanvasTextMetrics.graphemeSegmenter(chars).filter((char) => !this._currentChars.includes(char)).filter((char, index, self) => self.indexOf(char) === index);\n    if (!charList.length)\n      return;\n    this._currentChars = [...this._currentChars, ...charList];\n    let pageData;\n    if (this._currentPageIndex === -1) {\n      pageData = this._nextPage();\n    } else {\n      pageData = this.pages[this._currentPageIndex];\n    }\n    let { canvas, context } = pageData.canvasAndContext;\n    let textureSource = pageData.texture.source;\n    const style = this._style;\n    let currentX = this._currentX;\n    let currentY = this._currentY;\n    let currentMaxCharHeight = this._currentMaxCharHeight;\n    const fontScale = this.baseRenderedFontSize / this.baseMeasurementFontSize;\n    const padding = this._padding * fontScale;\n    let skipTexture = false;\n    const maxTextureWidth = canvas.width / this.resolution;\n    const maxTextureHeight = canvas.height / this.resolution;\n    for (let i = 0; i < charList.length; i++) {\n      const char = charList[i];\n      const metrics = CanvasTextMetrics.measureText(char, style, canvas, false);\n      metrics.lineHeight = metrics.height;\n      const width = metrics.width * fontScale;\n      const textureGlyphWidth = Math.ceil((style.fontStyle === \"italic\" ? 2 : 1) * width);\n      const height = metrics.height * fontScale;\n      const paddedWidth = textureGlyphWidth + padding * 2;\n      const paddedHeight = height + padding * 2;\n      skipTexture = false;\n      if (char !== \"\\n\" && char !== \"\\r\" && char !== \"\t\" && char !== \" \") {\n        skipTexture = true;\n        currentMaxCharHeight = Math.ceil(Math.max(paddedHeight, currentMaxCharHeight));\n      }\n      if (currentX + paddedWidth > maxTextureWidth) {\n        currentY += currentMaxCharHeight;\n        currentMaxCharHeight = paddedHeight;\n        currentX = 0;\n        if (currentY + currentMaxCharHeight > maxTextureHeight) {\n          textureSource.update();\n          const pageData2 = this._nextPage();\n          canvas = pageData2.canvasAndContext.canvas;\n          context = pageData2.canvasAndContext.context;\n          textureSource = pageData2.texture.source;\n          currentX = 0;\n          currentY = 0;\n          currentMaxCharHeight = 0;\n        }\n      }\n      const xAdvance = width / fontScale - (style.dropShadow?.distance ?? 0) - (style._stroke?.width ?? 0);\n      this.chars[char] = {\n        id: char.codePointAt(0),\n        xOffset: -this._padding,\n        yOffset: -this._padding,\n        xAdvance,\n        kerning: {}\n      };\n      if (skipTexture) {\n        this._drawGlyph(\n          context,\n          metrics,\n          currentX + padding,\n          currentY + padding,\n          fontScale,\n          style\n        );\n        const px = textureSource.width * fontScale;\n        const py = textureSource.height * fontScale;\n        const frame = new Rectangle(\n          currentX / px * textureSource.width,\n          currentY / py * textureSource.height,\n          paddedWidth / px * textureSource.width,\n          paddedHeight / py * textureSource.height\n        );\n        this.chars[char].texture = new Texture({\n          source: textureSource,\n          frame\n        });\n        currentX += Math.ceil(paddedWidth);\n      }\n    }\n    textureSource.update();\n    this._currentX = currentX;\n    this._currentY = currentY;\n    this._currentMaxCharHeight = currentMaxCharHeight;\n    this._skipKerning && this._applyKerning(charList, context);\n  }\n  /**\n   * @deprecated since 8.0.0\n   * The map of base page textures (i.e., sheets of glyphs).\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  _applyKerning(newChars, context) {\n    const measureCache = this._measureCache;\n    for (let i = 0; i < newChars.length; i++) {\n      const first = newChars[i];\n      for (let j = 0; j < this._currentChars.length; j++) {\n        const second = this._currentChars[j];\n        let c1 = measureCache[first];\n        if (!c1)\n          c1 = measureCache[first] = context.measureText(first).width;\n        let c2 = measureCache[second];\n        if (!c2)\n          c2 = measureCache[second] = context.measureText(second).width;\n        let total = context.measureText(first + second).width;\n        let amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[first].kerning[second] = amount;\n        }\n        total = context.measureText(first + second).width;\n        amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[second].kerning[first] = amount;\n        }\n      }\n    }\n  }\n  _nextPage() {\n    this._currentPageIndex++;\n    const textureResolution = this.resolution;\n    const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(\n      this._textureSize,\n      this._textureSize,\n      textureResolution\n    );\n    this._setupContext(canvasAndContext.context, this._style, textureResolution);\n    const resolution = textureResolution * (this.baseRenderedFontSize / this.baseMeasurementFontSize);\n    const texture = new Texture({\n      source: new ImageSource({\n        resource: canvasAndContext.canvas,\n        resolution,\n        alphaMode: \"premultiply-alpha-on-upload\",\n        autoGenerateMipmaps: this._mipmap\n      })\n    });\n    if (this._textureStyle) {\n      texture.source.style = this._textureStyle;\n    }\n    const pageData = {\n      canvasAndContext,\n      texture\n    };\n    this.pages[this._currentPageIndex] = pageData;\n    return pageData;\n  }\n  // canvas style!\n  _setupContext(context, style, resolution) {\n    style.fontSize = this.baseRenderedFontSize;\n    context.scale(resolution, resolution);\n    context.font = fontStringFromTextStyle(style);\n    style.fontSize = this.baseMeasurementFontSize;\n    context.textBaseline = style.textBaseline;\n    const stroke = style._stroke;\n    const strokeThickness = stroke?.width ?? 0;\n    if (stroke) {\n      context.lineWidth = strokeThickness;\n      context.lineJoin = stroke.join;\n      context.miterLimit = stroke.miterLimit;\n      context.strokeStyle = getCanvasFillStyle(stroke, context);\n    }\n    if (style._fill) {\n      context.fillStyle = getCanvasFillStyle(style._fill, context);\n    }\n    if (style.dropShadow) {\n      const shadowOptions = style.dropShadow;\n      const rgb = Color.shared.setValue(shadowOptions.color).toArray();\n      const dropShadowBlur = shadowOptions.blur * resolution;\n      const dropShadowDistance = shadowOptions.distance * resolution;\n      context.shadowColor = `rgba(${rgb[0] * 255},${rgb[1] * 255},${rgb[2] * 255},${shadowOptions.alpha})`;\n      context.shadowBlur = dropShadowBlur;\n      context.shadowOffsetX = Math.cos(shadowOptions.angle) * dropShadowDistance;\n      context.shadowOffsetY = Math.sin(shadowOptions.angle) * dropShadowDistance;\n    } else {\n      context.shadowColor = \"black\";\n      context.shadowBlur = 0;\n      context.shadowOffsetX = 0;\n      context.shadowOffsetY = 0;\n    }\n  }\n  _drawGlyph(context, metrics, x, y, fontScale, style) {\n    const char = metrics.text;\n    const fontProperties = metrics.fontProperties;\n    const stroke = style._stroke;\n    const strokeThickness = (stroke?.width ?? 0) * fontScale;\n    const tx = x + strokeThickness / 2;\n    const ty = y - strokeThickness / 2;\n    const descent = fontProperties.descent * fontScale;\n    const lineHeight = metrics.lineHeight * fontScale;\n    let removeShadow = false;\n    if (style.stroke && strokeThickness) {\n      removeShadow = true;\n      context.strokeText(char, tx, ty + lineHeight - descent);\n    }\n    const { shadowBlur, shadowOffsetX, shadowOffsetY } = context;\n    if (style._fill) {\n      if (removeShadow) {\n        context.shadowBlur = 0;\n        context.shadowOffsetX = 0;\n        context.shadowOffsetY = 0;\n      }\n      context.fillText(char, tx, ty + lineHeight - descent);\n    }\n    if (removeShadow) {\n      context.shadowBlur = shadowBlur;\n      context.shadowOffsetX = shadowOffsetX;\n      context.shadowOffsetY = shadowOffsetY;\n    }\n  }\n  destroy() {\n    super.destroy();\n    for (let i = 0; i < this.pages.length; i++) {\n      const { canvasAndContext, texture } = this.pages[i];\n      CanvasPool.returnCanvasAndContext(canvasAndContext);\n      texture.destroy(true);\n    }\n    this.pages = null;\n  }\n};\n_DynamicBitmapFont.defaultOptions = {\n  textureSize: 512,\n  style: new TextStyle(),\n  mipmap: true\n};\nlet DynamicBitmapFont = _DynamicBitmapFont;\n\nexport { DynamicBitmapFont };\n//# sourceMappingURL=DynamicBitmapFont.mjs.map\n","\"use strict\";\nfunction getBitmapTextLayout(chars, style, font, trimEnd) {\n  const layoutData = {\n    width: 0,\n    height: 0,\n    offsetY: 0,\n    scale: style.fontSize / font.baseMeasurementFontSize,\n    lines: [{\n      width: 0,\n      charPositions: [],\n      spaceWidth: 0,\n      spacesIndex: [],\n      chars: []\n    }]\n  };\n  layoutData.offsetY = font.baseLineOffset;\n  let currentLine = layoutData.lines[0];\n  let previousChar = null;\n  let firstWord = true;\n  const currentWord = {\n    spaceWord: false,\n    width: 0,\n    start: 0,\n    index: 0,\n    // use index to not modify the array as we use it a lot!\n    positions: [],\n    chars: []\n  };\n  const scale = font.baseMeasurementFontSize / style.fontSize;\n  const adjustedLetterSpacing = style.letterSpacing * scale;\n  const adjustedWordWrapWidth = style.wordWrapWidth * scale;\n  const adjustedLineHeight = style.lineHeight ? style.lineHeight * scale : font.lineHeight;\n  const breakWords = style.wordWrap && style.breakWords;\n  const nextWord = (word) => {\n    const start = currentLine.width;\n    for (let j = 0; j < currentWord.index; j++) {\n      const position = word.positions[j];\n      currentLine.chars.push(word.chars[j]);\n      currentLine.charPositions.push(position + start);\n    }\n    currentLine.width += word.width;\n    firstWord = false;\n    currentWord.width = 0;\n    currentWord.index = 0;\n    currentWord.chars.length = 0;\n  };\n  const nextLine = () => {\n    let index = currentLine.chars.length - 1;\n    if (trimEnd) {\n      let lastChar = currentLine.chars[index];\n      while (lastChar === \" \") {\n        currentLine.width -= font.chars[lastChar].xAdvance;\n        lastChar = currentLine.chars[--index];\n      }\n    }\n    layoutData.width = Math.max(layoutData.width, currentLine.width);\n    currentLine = {\n      width: 0,\n      charPositions: [],\n      chars: [],\n      spaceWidth: 0,\n      spacesIndex: []\n    };\n    firstWord = true;\n    layoutData.lines.push(currentLine);\n    layoutData.height += adjustedLineHeight;\n  };\n  const checkIsOverflow = (lineWidth) => lineWidth - adjustedLetterSpacing > adjustedWordWrapWidth;\n  for (let i = 0; i < chars.length + 1; i++) {\n    let char;\n    const isEnd = i === chars.length;\n    if (!isEnd) {\n      char = chars[i];\n    }\n    const charData = font.chars[char] || font.chars[\" \"];\n    const isSpace = /(?:\\s)/.test(char);\n    const isWordBreak = isSpace || char === \"\\r\" || char === \"\\n\" || isEnd;\n    if (isWordBreak) {\n      const addWordToNextLine = !firstWord && style.wordWrap && checkIsOverflow(currentLine.width + currentWord.width);\n      if (addWordToNextLine) {\n        nextLine();\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      } else {\n        currentWord.start = currentLine.width;\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      }\n      if (char === \"\\r\" || char === \"\\n\") {\n        nextLine();\n      } else if (!isEnd) {\n        const spaceWidth = charData.xAdvance + (charData.kerning[previousChar] || 0) + adjustedLetterSpacing;\n        currentLine.width += spaceWidth;\n        currentLine.spaceWidth = spaceWidth;\n        currentLine.spacesIndex.push(currentLine.charPositions.length);\n        currentLine.chars.push(char);\n      }\n    } else {\n      const kerning = charData.kerning[previousChar] || 0;\n      const nextCharWidth = charData.xAdvance + kerning + adjustedLetterSpacing;\n      const addWordToNextLine = breakWords && checkIsOverflow(currentLine.width + currentWord.width + nextCharWidth);\n      if (addWordToNextLine) {\n        nextWord(currentWord);\n        nextLine();\n      }\n      currentWord.positions[currentWord.index++] = currentWord.width + kerning;\n      currentWord.chars.push(char);\n      currentWord.width += nextCharWidth;\n    }\n    previousChar = char;\n  }\n  nextLine();\n  if (style.align === \"center\") {\n    alignCenter(layoutData);\n  } else if (style.align === \"right\") {\n    alignRight(layoutData);\n  } else if (style.align === \"justify\") {\n    alignJustify(layoutData);\n  }\n  return layoutData;\n}\nfunction alignCenter(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width / 2 - line.width / 2;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignRight(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width - line.width;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignJustify(measurementData) {\n  const width = measurementData.width;\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    let indy = 0;\n    let spaceIndex = line.spacesIndex[indy++];\n    let offset = 0;\n    const totalSpaces = line.spacesIndex.length;\n    const newSpaceWidth = (width - line.width) / totalSpaces;\n    const spaceWidth = newSpaceWidth;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      if (j === spaceIndex) {\n        spaceIndex = line.spacesIndex[indy++];\n        offset += spaceWidth;\n      }\n      line.charPositions[j] += offset;\n    }\n  }\n}\n\nexport { getBitmapTextLayout };\n//# sourceMappingURL=getBitmapTextLayout.mjs.map\n","\"use strict\";\nfunction resolveCharacters(chars) {\n  if (chars === \"\") {\n    return [];\n  }\n  if (typeof chars === \"string\") {\n    chars = [chars];\n  }\n  const result = [];\n  for (let i = 0, j = chars.length; i < j; i++) {\n    const item = chars[i];\n    if (Array.isArray(item)) {\n      if (item.length !== 2) {\n        throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${item.length}.`);\n      }\n      if (item[0].length === 0 || item[1].length === 0) {\n        throw new Error(\"[BitmapFont]: Invalid character delimiter.\");\n      }\n      const startCode = item[0].charCodeAt(0);\n      const endCode = item[1].charCodeAt(0);\n      if (endCode < startCode) {\n        throw new Error(\"[BitmapFont]: Invalid character range.\");\n      }\n      for (let i2 = startCode, j2 = endCode; i2 <= j2; i2++) {\n        result.push(String.fromCharCode(i2));\n      }\n    } else {\n      result.push(...Array.from(item));\n    }\n  }\n  if (result.length === 0) {\n    throw new Error(\"[BitmapFont]: Empty set when resolving characters.\");\n  }\n  return result;\n}\n\nexport { resolveCharacters };\n//# sourceMappingURL=resolveCharacters.mjs.map\n","import { lru } from 'tiny-lru';\nimport { Cache } from '../../assets/cache/Cache.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { DynamicBitmapFont } from './DynamicBitmapFont.mjs';\nimport { getBitmapTextLayout } from './utils/getBitmapTextLayout.mjs';\nimport { resolveCharacters } from './utils/resolveCharacters.mjs';\n\n\"use strict\";\nlet fontCount = 0;\nclass BitmapFontManagerClass {\n  constructor() {\n    /**\n     * This character set includes all the letters in the alphabet (both lower- and upper- case).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.ALPHA })\n     */\n    this.ALPHA = [[\"a\", \"z\"], [\"A\", \"Z\"], \" \"];\n    /**\n     * This character set includes all decimal digits (from 0 to 9).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.NUMERIC })\n     */\n    this.NUMERIC = [[\"0\", \"9\"]];\n    /**\n     * This character set is the union of `BitmapFont.ALPHA` and `BitmapFont.NUMERIC`.\n     * @type {string[][]}\n     */\n    this.ALPHANUMERIC = [[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"], \" \"];\n    /**\n     * This character set consists of all the ASCII table.\n     * @type {string[][]}\n     * @see http://www.asciitable.com/\n     */\n    this.ASCII = [[\" \", \"~\"]];\n    /** Default options for installing a new BitmapFont. */\n    this.defaultOptions = {\n      chars: this.ALPHANUMERIC,\n      resolution: 1,\n      padding: 4,\n      skipKerning: false,\n      textureStyle: null\n    };\n    /** Cache for measured text layouts to avoid recalculating them multiple times. */\n    this.measureCache = lru(1e3);\n  }\n  /**\n   * Get a font for the specified text and style.\n   * @param text - The text to get the font for\n   * @param style - The style to use\n   */\n  getFont(text, style) {\n    let fontFamilyKey = `${style.fontFamily}-bitmap`;\n    let overrideFill = true;\n    if (style._fill.fill && !style._stroke) {\n      fontFamilyKey += style._fill.fill.styleKey;\n      overrideFill = false;\n    } else if (style._stroke || style.dropShadow) {\n      fontFamilyKey = `${style.styleKey}-bitmap`;\n      overrideFill = false;\n    }\n    if (!Cache.has(fontFamilyKey)) {\n      const styleCopy = Object.create(style);\n      styleCopy.lineHeight = 0;\n      const fnt = new DynamicBitmapFont({\n        style: styleCopy,\n        overrideFill,\n        overrideSize: true,\n        ...this.defaultOptions\n      });\n      fontCount++;\n      if (fontCount > 50) {\n        warn(\"BitmapText\", `You have dynamically created ${fontCount} bitmap fonts, this can be inefficient. Try pre installing your font styles using \\`BitmapFont.install({name:\"style1\", style})\\``);\n      }\n      fnt.once(\"destroy\", () => {\n        fontCount--;\n        Cache.remove(fontFamilyKey);\n      });\n      Cache.set(\n        fontFamilyKey,\n        fnt\n      );\n    }\n    const dynamicFont = Cache.get(fontFamilyKey);\n    dynamicFont.ensureCharacters?.(text);\n    return dynamicFont;\n  }\n  /**\n   * Get the layout of a text for the specified style.\n   * @param text - The text to get the layout for\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  getLayout(text, style, trimEnd = true) {\n    const bitmapFont = this.getFont(text, style);\n    const id = `${text}-${style.styleKey}-${trimEnd}`;\n    if (this.measureCache.has(id)) {\n      return this.measureCache.get(id);\n    }\n    const segments = CanvasTextMetrics.graphemeSegmenter(text);\n    const layoutData = getBitmapTextLayout(segments, style, bitmapFont, trimEnd);\n    this.measureCache.set(id, layoutData);\n    return layoutData;\n  }\n  /**\n   * Measure the text using the specified style.\n   * @param text - The text to measure\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  measureText(text, style, trimEnd = true) {\n    return this.getLayout(text, style, trimEnd);\n  }\n  // eslint-disable-next-line max-len\n  install(...args) {\n    let options = args[0];\n    if (typeof options === \"string\") {\n      options = {\n        name: options,\n        style: args[1],\n        chars: args[2]?.chars,\n        resolution: args[2]?.resolution,\n        padding: args[2]?.padding,\n        skipKerning: args[2]?.skipKerning\n      };\n      deprecation(v8_0_0, \"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})\");\n    }\n    const name = options?.name;\n    if (!name) {\n      throw new Error(\"[BitmapFontManager] Property `name` is required.\");\n    }\n    options = { ...this.defaultOptions, ...options };\n    const textStyle = options.style;\n    const style = textStyle instanceof TextStyle ? textStyle : new TextStyle(textStyle);\n    const overrideFill = options.dynamicFill ?? this._canUseTintForStyle(style);\n    const font = new DynamicBitmapFont({\n      style,\n      overrideFill,\n      skipKerning: options.skipKerning,\n      padding: options.padding,\n      resolution: options.resolution,\n      overrideSize: false,\n      textureStyle: options.textureStyle\n    });\n    const flatChars = resolveCharacters(options.chars);\n    font.ensureCharacters(flatChars.join(\"\"));\n    Cache.set(`${name}-bitmap`, font);\n    font.once(\"destroy\", () => Cache.remove(`${name}-bitmap`));\n    return font;\n  }\n  /**\n   * Uninstalls a bitmap font from the cache.\n   * @param {string} name - The name of the bitmap font to uninstall.\n   */\n  uninstall(name) {\n    const cacheKey = `${name}-bitmap`;\n    const font = Cache.get(cacheKey);\n    if (font) {\n      font.destroy();\n    }\n  }\n  /**\n   * Determines if a style can use tinting instead of baking colors into the bitmap.\n   * Tinting is more efficient as it allows reusing the same bitmap with different colors.\n   * @param style - The text style to evaluate\n   * @returns true if the style can use tinting, false if colors must be baked in\n   * @private\n   */\n  _canUseTintForStyle(style) {\n    return !style._stroke && (!style.dropShadow || style.dropShadow.color === 0) && !style._fill.fill && style._fill.color === 16777215;\n  }\n}\nconst BitmapFontManager = new BitmapFontManagerClass();\n\nexport { BitmapFontManager };\n//# sourceMappingURL=BitmapFontManager.mjs.map\n","var vertex = \"in vec2 aPosition;\\nout vec2 vTextureCoord;\\n\\nuniform vec4 uInputSize;\\nuniform vec4 uOutputFrame;\\nuniform vec4 uOutputTexture;\\n\\nvec4 filterVertexPosition( void )\\n{\\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\\n    \\n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\\n\\n    return vec4(position, 0.0, 1.0);\\n}\\n\\nvec2 filterTextureCoord( void )\\n{\\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\\n}\\n\\nvoid main(void)\\n{\\n    gl_Position = filterVertexPosition();\\n    vTextureCoord = filterTextureCoord();\\n}\\n\";\n\nexport { vertex as default };\n//# sourceMappingURL=defaultFilter.vert.mjs.map\n","var fragment = \"in vec2 vTextureCoord;\\nout vec4 finalColor;\\nuniform sampler2D uTexture;\\nvoid main() {\\n    finalColor = texture(uTexture, vTextureCoord);\\n}\\n\";\n\nexport { fragment as default };\n//# sourceMappingURL=passthrough.frag.mjs.map\n","var source = \"struct GlobalFilterUniforms {\\n  uInputSize: vec4<f32>,\\n  uInputPixel: vec4<f32>,\\n  uInputClamp: vec4<f32>,\\n  uOutputFrame: vec4<f32>,\\n  uGlobalFrame: vec4<f32>,\\n  uOutputTexture: vec4<f32>,\\n};\\n\\n@group(0) @binding(0) var <uniform> gfu: GlobalFilterUniforms;\\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\\n@group(0) @binding(2) var uSampler: sampler;\\n\\nstruct VSOutput {\\n  @builtin(position) position: vec4<f32>,\\n  @location(0) uv: vec2<f32>\\n};\\n\\nfn filterVertexPosition(aPosition: vec2<f32>) -> vec4<f32>\\n{\\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\\n\\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\\n    position.y = position.y * (2.0 * gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\\n\\n    return vec4(position, 0.0, 1.0);\\n}\\n\\nfn filterTextureCoord(aPosition: vec2<f32>) -> vec2<f32>\\n{\\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\\n}\\n\\n@vertex\\nfn mainVertex(\\n  @location(0) aPosition: vec2<f32>,\\n) -> VSOutput {\\n  return VSOutput(\\n   filterVertexPosition(aPosition),\\n   filterTextureCoord(aPosition)\\n  );\\n}\\n\\n@fragment\\nfn mainFragment(\\n  @location(0) uv: vec2<f32>,\\n) -> @location(0) vec4<f32> {\\n    return textureSample(uTexture, uSampler, uv);\\n}\\n\";\n\nexport { source as default };\n//# sourceMappingURL=passthrough.wgsl.mjs.map\n","import { GlProgram } from '../../../rendering/renderers/gl/shader/GlProgram.mjs';\nimport { GpuProgram } from '../../../rendering/renderers/gpu/shader/GpuProgram.mjs';\nimport { Filter } from '../../Filter.mjs';\nimport vertex from '../defaultFilter.vert.mjs';\nimport fragment from './passthrough.frag.mjs';\nimport source from './passthrough.wgsl.mjs';\n\n\"use strict\";\nclass PassthroughFilter extends Filter {\n  constructor() {\n    const gpuProgram = GpuProgram.from({\n      vertex: { source, entryPoint: \"mainVertex\" },\n      fragment: { source, entryPoint: \"mainFragment\" },\n      name: \"passthrough-filter\"\n    });\n    const glProgram = GlProgram.from({\n      vertex,\n      fragment,\n      name: \"passthrough-filter\"\n    });\n    super({\n      gpuProgram,\n      glProgram\n    });\n  }\n}\n\nexport { PassthroughFilter };\n//# sourceMappingURL=PassthroughFilter.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\n\n\"use strict\";\nclass FilterPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  push(filterEffect, container, instructionSet) {\n    const renderPipes = this._renderer.renderPipes;\n    renderPipes.batch.break(instructionSet);\n    instructionSet.add({\n      renderPipeId: \"filter\",\n      canBundle: false,\n      action: \"pushFilter\",\n      container,\n      filterEffect\n    });\n  }\n  pop(_filterEffect, _container, instructionSet) {\n    this._renderer.renderPipes.batch.break(instructionSet);\n    instructionSet.add({\n      renderPipeId: \"filter\",\n      action: \"popFilter\",\n      canBundle: false\n    });\n  }\n  execute(instruction) {\n    if (instruction.action === \"pushFilter\") {\n      this._renderer.filter.push(instruction);\n    } else if (instruction.action === \"popFilter\") {\n      this._renderer.filter.pop();\n    }\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\nFilterPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"filter\"\n};\n\nexport { FilterPipe };\n//# sourceMappingURL=FilterPipe.mjs.map\n","import '../../../maths/index.mjs';\nimport { Matrix } from '../../../maths/matrix/Matrix.mjs';\n\n\"use strict\";\nconst tempProjectionMatrix = new Matrix();\nfunction getGlobalRenderableBounds(renderables, bounds) {\n  bounds.clear();\n  const actualMatrix = bounds.matrix;\n  for (let i = 0; i < renderables.length; i++) {\n    const renderable = renderables[i];\n    if (renderable.globalDisplayStatus < 7) {\n      continue;\n    }\n    const renderGroup = renderable.renderGroup ?? renderable.parentRenderGroup;\n    if (renderGroup?.isCachedAsTexture) {\n      bounds.matrix = tempProjectionMatrix.copyFrom(renderGroup.textureOffsetInverseTransform).append(renderable.worldTransform);\n    } else if (renderGroup?._parentCacheAsTextureRenderGroup) {\n      bounds.matrix = tempProjectionMatrix.copyFrom(renderGroup._parentCacheAsTextureRenderGroup.inverseWorldTransform).append(renderable.groupTransform);\n    } else {\n      bounds.matrix = renderable.worldTransform;\n    }\n    bounds.addBounds(renderable.bounds);\n  }\n  bounds.matrix = actualMatrix;\n  return bounds;\n}\n\nexport { getGlobalRenderableBounds };\n//# sourceMappingURL=getRenderableBounds.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\nimport { PassthroughFilter } from './defaults/passthrough/PassthroughFilter.mjs';\nimport { Matrix } from '../maths/matrix/Matrix.mjs';\nimport { BindGroup } from '../rendering/renderers/gpu/shader/BindGroup.mjs';\nimport { Geometry } from '../rendering/renderers/shared/geometry/Geometry.mjs';\nimport { UniformGroup } from '../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { Texture } from '../rendering/renderers/shared/texture/Texture.mjs';\nimport { TexturePool } from '../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { RendererType } from '../rendering/renderers/types.mjs';\nimport { Bounds } from '../scene/container/bounds/Bounds.mjs';\nimport { getGlobalRenderableBounds } from '../scene/container/bounds/getRenderableBounds.mjs';\nimport { warn } from '../utils/logging/warn.mjs';\n\n\"use strict\";\nconst quadGeometry = new Geometry({\n  attributes: {\n    aPosition: {\n      buffer: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\n      format: \"float32x2\",\n      stride: 2 * 4,\n      offset: 0\n    }\n  },\n  indexBuffer: new Uint32Array([0, 1, 2, 0, 2, 3])\n});\nclass FilterData {\n  constructor() {\n    /**\n     * Indicates whether the filter should be skipped.\n     * @type {boolean}\n     */\n    this.skip = false;\n    /**\n     * The texture to which the filter is applied.\n     * @type {Texture}\n     */\n    this.inputTexture = null;\n    /**\n     * The back texture used for blending, if required.\n     * @type {Texture | null}\n     */\n    this.backTexture = null;\n    /**\n     * The list of filters to be applied.\n     * @type {Filter[]}\n     */\n    this.filters = null;\n    /**\n     * The bounds of the filter area.\n     * @type {Bounds}\n     */\n    this.bounds = new Bounds();\n    /**\n     * The container to which the filter is applied.\n     * @type {Container}\n     */\n    this.container = null;\n    /**\n     * Indicates whether blending is required for the filter.\n     * @type {boolean}\n     */\n    this.blendRequired = false;\n    /**\n     * The render surface where the output of the filter is rendered.\n     * @type {RenderSurface}\n     */\n    this.outputRenderSurface = null;\n    /**\n     * The global frame of the filter area.\n     * @type {{ x: number, y: number, width: number, height: number }}\n     */\n    this.globalFrame = { x: 0, y: 0, width: 0, height: 0 };\n    /** The first enabled filter index in the current filter list. */\n    this.firstEnabledIndex = -1;\n    /** The last enabled filter index in the current filter list. */\n    this.lastEnabledIndex = -1;\n  }\n}\nclass FilterSystem {\n  constructor(renderer) {\n    this._filterStackIndex = 0;\n    this._filterStack = [];\n    this._filterGlobalUniforms = new UniformGroup({\n      uInputSize: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uInputPixel: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uInputClamp: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uOutputFrame: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uGlobalFrame: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uOutputTexture: { value: new Float32Array(4), type: \"vec4<f32>\" }\n    });\n    this._globalFilterBindGroup = new BindGroup({});\n    this.renderer = renderer;\n  }\n  /**\n   * The back texture of the currently active filter. Requires the filter to have `blendRequired` set to true.\n   * @readonly\n   */\n  get activeBackTexture() {\n    return this._activeFilterData?.backTexture;\n  }\n  /**\n   * Pushes a filter instruction onto the filter stack.\n   * @param instruction - The instruction containing the filter effect and container.\n   * @internal\n   */\n  push(instruction) {\n    const renderer = this.renderer;\n    const filters = instruction.filterEffect.filters;\n    const filterData = this._pushFilterData();\n    filterData.skip = false;\n    filterData.filters = filters;\n    filterData.container = instruction.container;\n    filterData.outputRenderSurface = renderer.renderTarget.renderSurface;\n    const colorTextureSource = renderer.renderTarget.renderTarget.colorTexture.source;\n    const rootResolution = colorTextureSource.resolution;\n    const rootAntialias = colorTextureSource.antialias;\n    if (filters.every((filter) => !filter.enabled)) {\n      filterData.skip = true;\n      return;\n    }\n    const bounds = filterData.bounds;\n    this._calculateFilterArea(instruction, bounds);\n    this._calculateFilterBounds(filterData, renderer.renderTarget.rootViewPort, rootAntialias, rootResolution, 1);\n    if (filterData.skip) {\n      return;\n    }\n    const previousFilterData = this._getPreviousFilterData();\n    const globalResolution = this._findFilterResolution(rootResolution);\n    let offsetX = 0;\n    let offsetY = 0;\n    if (previousFilterData) {\n      offsetX = previousFilterData.bounds.minX;\n      offsetY = previousFilterData.bounds.minY;\n    }\n    this._calculateGlobalFrame(\n      filterData,\n      offsetX,\n      offsetY,\n      globalResolution,\n      colorTextureSource.width,\n      colorTextureSource.height\n    );\n    this._setupFilterTextures(filterData, bounds, renderer, previousFilterData);\n  }\n  /**\n   * Applies filters to a texture.\n   *\n   * This method takes a texture and a list of filters, applies the filters to the texture,\n   * and returns the resulting texture.\n   * @param {object} params - The parameters for applying filters.\n   * @param {Texture} params.texture - The texture to apply filters to.\n   * @param {Filter[]} params.filters - The filters to apply.\n   * @returns {Texture} The resulting texture after all filters have been applied.\n   * @example\n   *\n   * ```ts\n   * // Create a texture and a list of filters\n   * const texture = new Texture(...);\n   * const filters = [new BlurFilter(), new ColorMatrixFilter()];\n   *\n   * // Apply the filters to the texture\n   * const resultTexture = filterSystem.applyToTexture({ texture, filters });\n   *\n   * // Use the resulting texture\n   * sprite.texture = resultTexture;\n   * ```\n   *\n   * Key Points:\n   * 1. padding is not currently supported here - so clipping may occur with filters that use padding.\n   * 2. If all filters are disabled or skipped, the original texture is returned.\n   */\n  generateFilteredTexture({ texture, filters }) {\n    const filterData = this._pushFilterData();\n    this._activeFilterData = filterData;\n    filterData.skip = false;\n    filterData.filters = filters;\n    const colorTextureSource = texture.source;\n    const rootResolution = colorTextureSource.resolution;\n    const rootAntialias = colorTextureSource.antialias;\n    if (filters.every((filter) => !filter.enabled)) {\n      filterData.skip = true;\n      return texture;\n    }\n    const bounds = filterData.bounds;\n    bounds.addRect(texture.frame);\n    this._calculateFilterBounds(filterData, bounds.rectangle, rootAntialias, rootResolution, 0);\n    if (filterData.skip) {\n      return texture;\n    }\n    const globalResolution = rootResolution;\n    const offsetX = 0;\n    const offsetY = 0;\n    this._calculateGlobalFrame(\n      filterData,\n      offsetX,\n      offsetY,\n      globalResolution,\n      colorTextureSource.width,\n      colorTextureSource.height\n    );\n    filterData.outputRenderSurface = TexturePool.getOptimalTexture(\n      bounds.width,\n      bounds.height,\n      filterData.resolution,\n      filterData.antialias\n    );\n    filterData.backTexture = Texture.EMPTY;\n    filterData.inputTexture = texture;\n    const renderer = this.renderer;\n    renderer.renderTarget.finishRenderPass();\n    this._applyFiltersToTexture(filterData, true);\n    const outputTexture = filterData.outputRenderSurface;\n    outputTexture.source.alphaMode = \"premultiplied-alpha\";\n    return outputTexture;\n  }\n  /** @internal */\n  pop() {\n    const renderer = this.renderer;\n    const filterData = this._popFilterData();\n    if (filterData.skip) {\n      return;\n    }\n    renderer.globalUniforms.pop();\n    renderer.renderTarget.finishRenderPass();\n    this._activeFilterData = filterData;\n    this._applyFiltersToTexture(filterData, false);\n    if (filterData.blendRequired) {\n      TexturePool.returnTexture(filterData.backTexture);\n    }\n    TexturePool.returnTexture(filterData.inputTexture);\n  }\n  /**\n   * Copies the last render surface to a texture.\n   * @param lastRenderSurface - The last render surface to copy from.\n   * @param bounds - The bounds of the area to copy.\n   * @param previousBounds - The previous bounds to use for offsetting the copy.\n   */\n  getBackTexture(lastRenderSurface, bounds, previousBounds) {\n    const backgroundResolution = lastRenderSurface.colorTexture.source._resolution;\n    const backTexture = TexturePool.getOptimalTexture(\n      bounds.width,\n      bounds.height,\n      backgroundResolution,\n      false\n    );\n    let x = bounds.minX;\n    let y = bounds.minY;\n    if (previousBounds) {\n      x -= previousBounds.minX;\n      y -= previousBounds.minY;\n    }\n    x = Math.floor(x * backgroundResolution);\n    y = Math.floor(y * backgroundResolution);\n    const width = Math.ceil(bounds.width * backgroundResolution);\n    const height = Math.ceil(bounds.height * backgroundResolution);\n    this.renderer.renderTarget.copyToTexture(\n      lastRenderSurface,\n      backTexture,\n      { x, y },\n      { width, height },\n      { x: 0, y: 0 }\n    );\n    return backTexture;\n  }\n  /**\n   * Applies a filter to a texture.\n   * @param filter - The filter to apply.\n   * @param input - The input texture.\n   * @param output - The output render surface.\n   * @param clear - Whether to clear the output surface before applying the filter.\n   */\n  applyFilter(filter, input, output, clear) {\n    const renderer = this.renderer;\n    const filterData = this._activeFilterData;\n    const outputRenderSurface = filterData.outputRenderSurface;\n    const isFinalTarget = outputRenderSurface === output;\n    const rootResolution = renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution;\n    const resolution = this._findFilterResolution(rootResolution);\n    let offsetX = 0;\n    let offsetY = 0;\n    if (isFinalTarget) {\n      const offset = this._findPreviousFilterOffset();\n      offsetX = offset.x;\n      offsetY = offset.y;\n    }\n    this._updateFilterUniforms(input, output, filterData, offsetX, offsetY, resolution, isFinalTarget, clear);\n    const filterToApply = filter.enabled ? filter : this._getPassthroughFilter();\n    this._setupBindGroupsAndRender(filterToApply, input, renderer);\n  }\n  /**\n   * Multiply _input normalized coordinates_ to this matrix to get _sprite texture normalized coordinates_.\n   *\n   * Use `outputMatrix * vTextureCoord` in the shader.\n   * @param outputMatrix - The matrix to output to.\n   * @param {Sprite} sprite - The sprite to map to.\n   * @returns The mapped matrix.\n   */\n  calculateSpriteMatrix(outputMatrix, sprite) {\n    const data = this._activeFilterData;\n    const mappedMatrix = outputMatrix.set(\n      data.inputTexture._source.width,\n      0,\n      0,\n      data.inputTexture._source.height,\n      data.bounds.minX,\n      data.bounds.minY\n    );\n    const worldTransform = sprite.worldTransform.copyTo(Matrix.shared);\n    const renderGroup = sprite.renderGroup || sprite.parentRenderGroup;\n    if (renderGroup && renderGroup.cacheToLocalTransform) {\n      worldTransform.prepend(renderGroup.cacheToLocalTransform);\n    }\n    worldTransform.invert();\n    mappedMatrix.prepend(worldTransform);\n    mappedMatrix.scale(\n      1 / sprite.texture.orig.width,\n      1 / sprite.texture.orig.height\n    );\n    mappedMatrix.translate(sprite.anchor.x, sprite.anchor.y);\n    return mappedMatrix;\n  }\n  destroy() {\n    this._passthroughFilter?.destroy(true);\n    this._passthroughFilter = null;\n  }\n  _getPassthroughFilter() {\n    this._passthroughFilter ?? (this._passthroughFilter = new PassthroughFilter());\n    return this._passthroughFilter;\n  }\n  /**\n   * Sets up the bind groups and renders the filter.\n   * @param filter - The filter to apply\n   * @param input - The input texture\n   * @param renderer - The renderer instance\n   */\n  _setupBindGroupsAndRender(filter, input, renderer) {\n    if (renderer.renderPipes.uniformBatch) {\n      const batchUniforms = renderer.renderPipes.uniformBatch.getUboResource(this._filterGlobalUniforms);\n      this._globalFilterBindGroup.setResource(batchUniforms, 0);\n    } else {\n      this._globalFilterBindGroup.setResource(this._filterGlobalUniforms, 0);\n    }\n    this._globalFilterBindGroup.setResource(input.source, 1);\n    this._globalFilterBindGroup.setResource(input.source.style, 2);\n    filter.groups[0] = this._globalFilterBindGroup;\n    renderer.encoder.draw({\n      geometry: quadGeometry,\n      shader: filter,\n      state: filter._state,\n      topology: \"triangle-list\"\n    });\n    if (renderer.type === RendererType.WEBGL) {\n      renderer.renderTarget.finishRenderPass();\n    }\n  }\n  /**\n   * Sets up the filter textures including input texture and back texture if needed.\n   * @param filterData - The filter data to update\n   * @param bounds - The bounds for the texture\n   * @param renderer - The renderer instance\n   * @param previousFilterData - The previous filter data for back texture calculation\n   */\n  _setupFilterTextures(filterData, bounds, renderer, previousFilterData) {\n    filterData.backTexture = Texture.EMPTY;\n    filterData.inputTexture = TexturePool.getOptimalTexture(\n      bounds.width,\n      bounds.height,\n      filterData.resolution,\n      filterData.antialias\n    );\n    if (filterData.blendRequired) {\n      renderer.renderTarget.finishRenderPass();\n      const renderTarget = renderer.renderTarget.getRenderTarget(filterData.outputRenderSurface);\n      filterData.backTexture = this.getBackTexture(renderTarget, bounds, previousFilterData?.bounds);\n    }\n    renderer.renderTarget.bind(filterData.inputTexture, true);\n    renderer.globalUniforms.push({\n      offset: bounds\n    });\n  }\n  /**\n   * Calculates and sets the global frame for the filter.\n   * @param filterData - The filter data to update\n   * @param offsetX - The X offset\n   * @param offsetY - The Y offset\n   * @param globalResolution - The global resolution\n   * @param sourceWidth - The source texture width\n   * @param sourceHeight - The source texture height\n   */\n  _calculateGlobalFrame(filterData, offsetX, offsetY, globalResolution, sourceWidth, sourceHeight) {\n    const globalFrame = filterData.globalFrame;\n    globalFrame.x = offsetX * globalResolution;\n    globalFrame.y = offsetY * globalResolution;\n    globalFrame.width = sourceWidth * globalResolution;\n    globalFrame.height = sourceHeight * globalResolution;\n  }\n  /**\n   * Updates the filter uniforms with the current filter state.\n   * @param input - The input texture\n   * @param output - The output render surface\n   * @param filterData - The current filter data\n   * @param offsetX - The X offset for positioning\n   * @param offsetY - The Y offset for positioning\n   * @param resolution - The current resolution\n   * @param isFinalTarget - Whether this is the final render target\n   * @param clear - Whether to clear the output surface\n   */\n  _updateFilterUniforms(input, output, filterData, offsetX, offsetY, resolution, isFinalTarget, clear) {\n    const uniforms = this._filterGlobalUniforms.uniforms;\n    const outputFrame = uniforms.uOutputFrame;\n    const inputSize = uniforms.uInputSize;\n    const inputPixel = uniforms.uInputPixel;\n    const inputClamp = uniforms.uInputClamp;\n    const globalFrame = uniforms.uGlobalFrame;\n    const outputTexture = uniforms.uOutputTexture;\n    if (isFinalTarget) {\n      outputFrame[0] = filterData.bounds.minX - offsetX;\n      outputFrame[1] = filterData.bounds.minY - offsetY;\n    } else {\n      outputFrame[0] = 0;\n      outputFrame[1] = 0;\n    }\n    outputFrame[2] = input.frame.width;\n    outputFrame[3] = input.frame.height;\n    inputSize[0] = input.source.width;\n    inputSize[1] = input.source.height;\n    inputSize[2] = 1 / inputSize[0];\n    inputSize[3] = 1 / inputSize[1];\n    inputPixel[0] = input.source.pixelWidth;\n    inputPixel[1] = input.source.pixelHeight;\n    inputPixel[2] = 1 / inputPixel[0];\n    inputPixel[3] = 1 / inputPixel[1];\n    inputClamp[0] = 0.5 * inputPixel[2];\n    inputClamp[1] = 0.5 * inputPixel[3];\n    inputClamp[2] = input.frame.width * inputSize[2] - 0.5 * inputPixel[2];\n    inputClamp[3] = input.frame.height * inputSize[3] - 0.5 * inputPixel[3];\n    const rootTexture = this.renderer.renderTarget.rootRenderTarget.colorTexture;\n    globalFrame[0] = offsetX * resolution;\n    globalFrame[1] = offsetY * resolution;\n    globalFrame[2] = rootTexture.source.width * resolution;\n    globalFrame[3] = rootTexture.source.height * resolution;\n    if (output instanceof Texture)\n      output.source.resource = null;\n    const renderTarget = this.renderer.renderTarget.getRenderTarget(output);\n    this.renderer.renderTarget.bind(output, !!clear);\n    if (output instanceof Texture) {\n      outputTexture[0] = output.frame.width;\n      outputTexture[1] = output.frame.height;\n    } else {\n      outputTexture[0] = renderTarget.width;\n      outputTexture[1] = renderTarget.height;\n    }\n    outputTexture[2] = renderTarget.isRoot ? -1 : 1;\n    this._filterGlobalUniforms.update();\n  }\n  /**\n   * Finds the correct resolution by looking back through the filter stack.\n   * @param rootResolution - The fallback root resolution to use\n   * @returns The resolution from the previous filter or root resolution\n   */\n  _findFilterResolution(rootResolution) {\n    let currentIndex = this._filterStackIndex - 1;\n    while (currentIndex > 0 && this._filterStack[currentIndex].skip) {\n      --currentIndex;\n    }\n    return currentIndex > 0 && this._filterStack[currentIndex].inputTexture ? this._filterStack[currentIndex].inputTexture.source._resolution : rootResolution;\n  }\n  /**\n   * Finds the offset from the previous non-skipped filter in the stack.\n   * @returns The offset coordinates from the previous filter\n   */\n  _findPreviousFilterOffset() {\n    let offsetX = 0;\n    let offsetY = 0;\n    let lastIndex = this._filterStackIndex;\n    while (lastIndex > 0) {\n      lastIndex--;\n      const prevFilterData = this._filterStack[lastIndex];\n      if (!prevFilterData.skip) {\n        offsetX = prevFilterData.bounds.minX;\n        offsetY = prevFilterData.bounds.minY;\n        break;\n      }\n    }\n    return { x: offsetX, y: offsetY };\n  }\n  /**\n   * Calculates the filter area bounds based on the instruction type.\n   * @param instruction - The filter instruction\n   * @param bounds - The bounds object to populate\n   */\n  _calculateFilterArea(instruction, bounds) {\n    if (instruction.renderables) {\n      getGlobalRenderableBounds(instruction.renderables, bounds);\n    } else if (instruction.filterEffect.filterArea) {\n      bounds.clear();\n      bounds.addRect(instruction.filterEffect.filterArea);\n      bounds.applyMatrix(instruction.container.worldTransform);\n    } else {\n      instruction.container.getFastGlobalBounds(true, bounds);\n    }\n    if (instruction.container) {\n      const renderGroup = instruction.container.renderGroup || instruction.container.parentRenderGroup;\n      const filterFrameTransform = renderGroup.cacheToLocalTransform;\n      if (filterFrameTransform) {\n        bounds.applyMatrix(filterFrameTransform);\n      }\n    }\n  }\n  _applyFiltersToTexture(filterData, clear) {\n    const inputTexture = filterData.inputTexture;\n    const bounds = filterData.bounds;\n    const filters = filterData.filters;\n    const firstEnabled = filterData.firstEnabledIndex;\n    const lastEnabled = filterData.lastEnabledIndex;\n    this._globalFilterBindGroup.setResource(inputTexture.source.style, 2);\n    this._globalFilterBindGroup.setResource(filterData.backTexture.source, 3);\n    if (firstEnabled === lastEnabled) {\n      filters[firstEnabled].apply(this, inputTexture, filterData.outputRenderSurface, clear);\n    } else {\n      let flip = filterData.inputTexture;\n      const tempTexture = TexturePool.getOptimalTexture(\n        bounds.width,\n        bounds.height,\n        flip.source._resolution,\n        false\n      );\n      let flop = tempTexture;\n      for (let i = firstEnabled; i < lastEnabled; i++) {\n        const filter = filters[i];\n        if (!filter.enabled)\n          continue;\n        filter.apply(this, flip, flop, true);\n        const t = flip;\n        flip = flop;\n        flop = t;\n      }\n      filters[lastEnabled].apply(this, flip, filterData.outputRenderSurface, clear);\n      TexturePool.returnTexture(tempTexture);\n    }\n  }\n  _calculateFilterBounds(filterData, viewPort, rootAntialias, rootResolution, paddingMultiplier) {\n    const renderer = this.renderer;\n    const bounds = filterData.bounds;\n    const filters = filterData.filters;\n    let resolution = Infinity;\n    let padding = 0;\n    let antialias = true;\n    let blendRequired = false;\n    let enabled = false;\n    let clipToViewport = true;\n    let firstEnabledIndex = -1;\n    let lastEnabledIndex = -1;\n    for (let i = 0; i < filters.length; i++) {\n      const filter = filters[i];\n      if (!filter.enabled)\n        continue;\n      if (firstEnabledIndex === -1)\n        firstEnabledIndex = i;\n      lastEnabledIndex = i;\n      resolution = Math.min(resolution, filter.resolution === \"inherit\" ? rootResolution : filter.resolution);\n      padding += filter.padding;\n      if (filter.antialias === \"off\") {\n        antialias = false;\n      } else if (filter.antialias === \"inherit\") {\n        antialias && (antialias = rootAntialias);\n      }\n      if (!filter.clipToViewport) {\n        clipToViewport = false;\n      }\n      const isCompatible = !!(filter.compatibleRenderers & renderer.type);\n      if (!isCompatible) {\n        enabled = false;\n        break;\n      }\n      if (filter.blendRequired && !(renderer.backBuffer?.useBackBuffer ?? true)) {\n        warn(\"Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options.\");\n        enabled = false;\n        break;\n      }\n      enabled = true;\n      blendRequired || (blendRequired = filter.blendRequired);\n    }\n    if (!enabled) {\n      filterData.skip = true;\n      return;\n    }\n    if (clipToViewport) {\n      bounds.fitBounds(0, viewPort.width / rootResolution, 0, viewPort.height / rootResolution);\n    }\n    bounds.scale(resolution).ceil().scale(1 / resolution).pad((padding | 0) * paddingMultiplier);\n    if (!bounds.isPositive) {\n      filterData.skip = true;\n      return;\n    }\n    filterData.antialias = antialias;\n    filterData.resolution = resolution;\n    filterData.blendRequired = blendRequired;\n    filterData.firstEnabledIndex = firstEnabledIndex;\n    filterData.lastEnabledIndex = lastEnabledIndex;\n  }\n  _popFilterData() {\n    this._filterStackIndex--;\n    return this._filterStack[this._filterStackIndex];\n  }\n  _getPreviousFilterData() {\n    let previousFilterData;\n    let index = this._filterStackIndex - 1;\n    while (index > 0) {\n      index--;\n      previousFilterData = this._filterStack[index];\n      if (!previousFilterData.skip) {\n        break;\n      }\n    }\n    return previousFilterData;\n  }\n  _pushFilterData() {\n    let filterData = this._filterStack[this._filterStackIndex];\n    if (!filterData) {\n      filterData = this._filterStack[this._filterStackIndex] = new FilterData();\n    }\n    this._filterStackIndex++;\n    return filterData;\n  }\n}\n/** @ignore */\nFilterSystem.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem\n  ],\n  name: \"filter\"\n};\n\nexport { FilterSystem };\n//# sourceMappingURL=FilterSystem.mjs.map\n","import { Buffer } from '../../../rendering/renderers/shared/buffer/Buffer.mjs';\nimport { BufferUsage } from '../../../rendering/renderers/shared/buffer/const.mjs';\nimport { Geometry } from '../../../rendering/renderers/shared/geometry/Geometry.mjs';\nimport { deprecation, v8_0_0 } from '../../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nconst _MeshGeometry = class _MeshGeometry extends Geometry {\n  constructor(...args) {\n    let options = args[0] ?? {};\n    if (options instanceof Float32Array) {\n      deprecation(v8_0_0, \"use new MeshGeometry({ positions, uvs, indices }) instead\");\n      options = {\n        positions: options,\n        uvs: args[1],\n        indices: args[2]\n      };\n    }\n    options = { ..._MeshGeometry.defaultOptions, ...options };\n    const positions = options.positions || new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\n    let uvs = options.uvs;\n    if (!uvs) {\n      if (options.positions) {\n        uvs = new Float32Array(positions.length);\n      } else {\n        uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\n      }\n    }\n    const indices = options.indices || new Uint32Array([0, 1, 2, 0, 2, 3]);\n    const shrinkToFit = options.shrinkBuffersToFit;\n    const positionBuffer = new Buffer({\n      data: positions,\n      label: \"attribute-mesh-positions\",\n      shrinkToFit,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    const uvBuffer = new Buffer({\n      data: uvs,\n      label: \"attribute-mesh-uvs\",\n      shrinkToFit,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    const indexBuffer = new Buffer({\n      data: indices,\n      label: \"index-mesh-buffer\",\n      shrinkToFit,\n      usage: BufferUsage.INDEX | BufferUsage.COPY_DST\n    });\n    super({\n      attributes: {\n        aPosition: {\n          buffer: positionBuffer,\n          format: \"float32x2\",\n          stride: 2 * 4,\n          offset: 0\n        },\n        aUV: {\n          buffer: uvBuffer,\n          format: \"float32x2\",\n          stride: 2 * 4,\n          offset: 0\n        }\n      },\n      indexBuffer,\n      topology: options.topology\n    });\n    this.batchMode = \"auto\";\n  }\n  /** The positions of the mesh. */\n  get positions() {\n    return this.attributes.aPosition.buffer.data;\n  }\n  /**\n   * Set the positions of the mesh.\n   * When setting the positions, its important that the uvs array is at least as long as the positions array.\n   * otherwise the geometry will not be valid.\n   * @param {Float32Array} value - The positions of the mesh.\n   */\n  set positions(value) {\n    this.attributes.aPosition.buffer.data = value;\n  }\n  /** The UVs of the mesh. */\n  get uvs() {\n    return this.attributes.aUV.buffer.data;\n  }\n  /**\n   * Set the UVs of the mesh.\n   * Its important that the uvs array you set is at least as long as the positions array.\n   * otherwise the geometry will not be valid.\n   * @param {Float32Array} value - The UVs of the mesh.\n   */\n  set uvs(value) {\n    this.attributes.aUV.buffer.data = value;\n  }\n  /** The indices of the mesh. */\n  get indices() {\n    return this.indexBuffer.data;\n  }\n  set indices(value) {\n    this.indexBuffer.data = value;\n  }\n};\n_MeshGeometry.defaultOptions = {\n  topology: \"triangle-list\",\n  shrinkBuffersToFit: false\n};\nlet MeshGeometry = _MeshGeometry;\n\nexport { MeshGeometry };\n//# sourceMappingURL=MeshGeometry.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\nimport { nextPow2 } from '../../maths/misc/pow2.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\n\n\"use strict\";\nlet _internalCanvas = null;\nlet _internalContext = null;\nfunction ensureInternalCanvas(width, height) {\n  if (!_internalCanvas) {\n    _internalCanvas = DOMAdapter.get().createCanvas(256, 128);\n    _internalContext = _internalCanvas.getContext(\"2d\", { willReadFrequently: true });\n    _internalContext.globalCompositeOperation = \"copy\";\n    _internalContext.globalAlpha = 1;\n  }\n  if (_internalCanvas.width < width || _internalCanvas.height < height) {\n    _internalCanvas.width = nextPow2(width);\n    _internalCanvas.height = nextPow2(height);\n  }\n}\nfunction checkRow(data, width, y) {\n  for (let x = 0, index = 4 * y * width; x < width; ++x, index += 4) {\n    if (data[index + 3] !== 0)\n      return false;\n  }\n  return true;\n}\nfunction checkColumn(data, width, x, top, bottom) {\n  const stride = 4 * width;\n  for (let y = top, index = top * stride + 4 * x; y <= bottom; ++y, index += stride) {\n    if (data[index + 3] !== 0)\n      return false;\n  }\n  return true;\n}\nfunction getCanvasBoundingBox(...args) {\n  let options = args[0];\n  if (!options.canvas) {\n    options = { canvas: args[0], resolution: args[1] };\n  }\n  const { canvas } = options;\n  const resolution = Math.min(options.resolution ?? 1, 1);\n  const width = options.width ?? canvas.width;\n  const height = options.height ?? canvas.height;\n  let output = options.output;\n  ensureInternalCanvas(width, height);\n  if (!_internalContext) {\n    throw new TypeError(\"Failed to get canvas 2D context\");\n  }\n  _internalContext.drawImage(\n    canvas,\n    0,\n    0,\n    width,\n    height,\n    0,\n    0,\n    width * resolution,\n    height * resolution\n  );\n  const imageData = _internalContext.getImageData(0, 0, width, height);\n  const data = imageData.data;\n  let left = 0;\n  let top = 0;\n  let right = width - 1;\n  let bottom = height - 1;\n  while (top < height && checkRow(data, width, top))\n    ++top;\n  if (top === height)\n    return Rectangle.EMPTY;\n  while (checkRow(data, width, bottom))\n    --bottom;\n  while (checkColumn(data, width, left, top, bottom))\n    ++left;\n  while (checkColumn(data, width, right, top, bottom))\n    --right;\n  ++right;\n  ++bottom;\n  _internalContext.globalCompositeOperation = \"source-over\";\n  _internalContext.strokeRect(left, top, right - left, bottom - top);\n  _internalContext.globalCompositeOperation = \"copy\";\n  output ?? (output = new Rectangle());\n  output.set(left / resolution, top / resolution, (right - left) / resolution, (bottom - top) / resolution);\n  return output;\n}\n\nexport { getCanvasBoundingBox };\n//# sourceMappingURL=getCanvasBoundingBox.mjs.map\n","import { Color } from '../../../color/Color.mjs';\nimport { Rectangle } from '../../../maths/shapes/Rectangle.mjs';\nimport { CanvasPool } from '../../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { getCanvasBoundingBox } from '../../../utils/canvas/getCanvasBoundingBox.mjs';\nimport { CanvasTextMetrics } from './CanvasTextMetrics.mjs';\nimport { fontStringFromTextStyle } from './utils/fontStringFromTextStyle.mjs';\nimport { getCanvasFillStyle } from './utils/getCanvasFillStyle.mjs';\n\n\"use strict\";\nconst tempRect = new Rectangle();\nclass CanvasTextGeneratorClass {\n  /**\n   * Creates a canvas with the specified text rendered to it.\n   *\n   * Generates a canvas of appropriate size, renders the text with the provided style,\n   * and returns both the canvas/context and a Rectangle representing the text bounds.\n   *\n   * When trim is enabled in the style, the frame will represent the bounds of the\n   * non-transparent pixels, which can be smaller than the full canvas.\n   * @param options - The options for generating the text canvas\n   * @param options.text - The text to render\n   * @param options.style - The style to apply to the text\n   * @param options.resolution - The resolution of the canvas (defaults to 1)\n   * @param options.padding\n   * @returns An object containing the canvas/context and the frame (bounds) of the text\n   */\n  getCanvasAndContext(options) {\n    const { text, style, resolution = 1 } = options;\n    const padding = style._getFinalPadding();\n    const measured = CanvasTextMetrics.measureText(text || \" \", style);\n    const width = Math.ceil(Math.ceil(Math.max(1, measured.width) + padding * 2) * resolution);\n    const height = Math.ceil(Math.ceil(Math.max(1, measured.height) + padding * 2) * resolution);\n    const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(width, height);\n    this._renderTextToCanvas(text, style, padding, resolution, canvasAndContext);\n    const frame = style.trim ? getCanvasBoundingBox({ canvas: canvasAndContext.canvas, width, height, resolution: 1, output: tempRect }) : tempRect.set(0, 0, width, height);\n    return {\n      canvasAndContext,\n      frame\n    };\n  }\n  /**\n   * Returns a canvas and context to the pool.\n   *\n   * This should be called when you're done with the canvas to allow reuse\n   * and prevent memory leaks.\n   * @param canvasAndContext - The canvas and context to return to the pool\n   */\n  returnCanvasAndContext(canvasAndContext) {\n    CanvasPool.returnCanvasAndContext(canvasAndContext);\n  }\n  /**\n   * Renders text to its canvas, and updates its texture.\n   * @param text - The text to render\n   * @param style - The style of the text\n   * @param padding - The padding of the text\n   * @param resolution - The resolution of the text\n   * @param canvasAndContext - The canvas and context to render the text to\n   */\n  _renderTextToCanvas(text, style, padding, resolution, canvasAndContext) {\n    const { canvas, context } = canvasAndContext;\n    const font = fontStringFromTextStyle(style);\n    const measured = CanvasTextMetrics.measureText(text || \" \", style);\n    const lines = measured.lines;\n    const lineHeight = measured.lineHeight;\n    const lineWidths = measured.lineWidths;\n    const maxLineWidth = measured.maxLineWidth;\n    const fontProperties = measured.fontProperties;\n    const height = canvas.height;\n    context.resetTransform();\n    context.scale(resolution, resolution);\n    context.textBaseline = style.textBaseline;\n    if (style._stroke?.width) {\n      const strokeStyle = style._stroke;\n      context.lineWidth = strokeStyle.width;\n      context.miterLimit = strokeStyle.miterLimit;\n      context.lineJoin = strokeStyle.join;\n      context.lineCap = strokeStyle.cap;\n    }\n    context.font = font;\n    let linePositionX;\n    let linePositionY;\n    const passesCount = style.dropShadow ? 2 : 1;\n    for (let i = 0; i < passesCount; ++i) {\n      const isShadowPass = style.dropShadow && i === 0;\n      const dsOffsetText = isShadowPass ? Math.ceil(Math.max(1, height) + padding * 2) : 0;\n      const dsOffsetShadow = dsOffsetText * resolution;\n      if (isShadowPass) {\n        context.fillStyle = \"black\";\n        context.strokeStyle = \"black\";\n        const shadowOptions = style.dropShadow;\n        const dropShadowColor = shadowOptions.color;\n        const dropShadowAlpha = shadowOptions.alpha;\n        context.shadowColor = Color.shared.setValue(dropShadowColor).setAlpha(dropShadowAlpha).toRgbaString();\n        const dropShadowBlur = shadowOptions.blur * resolution;\n        const dropShadowDistance = shadowOptions.distance * resolution;\n        context.shadowBlur = dropShadowBlur;\n        context.shadowOffsetX = Math.cos(shadowOptions.angle) * dropShadowDistance;\n        context.shadowOffsetY = Math.sin(shadowOptions.angle) * dropShadowDistance + dsOffsetShadow;\n      } else {\n        context.fillStyle = style._fill ? getCanvasFillStyle(style._fill, context, measured, padding * 2) : null;\n        if (style._stroke?.width) {\n          const strokePadding = style._stroke.width * 0.5 + padding * 2;\n          context.strokeStyle = getCanvasFillStyle(style._stroke, context, measured, strokePadding);\n        }\n        context.shadowColor = \"black\";\n      }\n      let linePositionYShift = (lineHeight - fontProperties.fontSize) / 2;\n      if (lineHeight - fontProperties.fontSize < 0) {\n        linePositionYShift = 0;\n      }\n      const strokeWidth = style._stroke?.width ?? 0;\n      for (let i2 = 0; i2 < lines.length; i2++) {\n        linePositionX = strokeWidth / 2;\n        linePositionY = strokeWidth / 2 + i2 * lineHeight + fontProperties.ascent + linePositionYShift;\n        if (style.align === \"right\") {\n          linePositionX += maxLineWidth - lineWidths[i2];\n        } else if (style.align === \"center\") {\n          linePositionX += (maxLineWidth - lineWidths[i2]) / 2;\n        }\n        if (style._stroke?.width) {\n          this._drawLetterSpacing(\n            lines[i2],\n            style,\n            canvasAndContext,\n            linePositionX + padding,\n            linePositionY + padding - dsOffsetText,\n            true\n          );\n        }\n        if (style._fill !== void 0) {\n          this._drawLetterSpacing(\n            lines[i2],\n            style,\n            canvasAndContext,\n            linePositionX + padding,\n            linePositionY + padding - dsOffsetText\n          );\n        }\n      }\n    }\n  }\n  /**\n   * Render the text with letter-spacing.\n   *\n   * This method handles rendering text with the correct letter spacing, using either:\n   * 1. Native letter spacing if supported by the browser\n   * 2. Manual letter spacing calculation if not natively supported\n   *\n   * For manual letter spacing, it calculates the position of each character\n   * based on its width and the desired spacing.\n   * @param text - The text to draw\n   * @param style - The text style to apply\n   * @param canvasAndContext - The canvas and context to draw to\n   * @param x - Horizontal position to draw the text\n   * @param y - Vertical position to draw the text\n   * @param isStroke - Whether to render the stroke (true) or fill (false)\n   * @private\n   */\n  _drawLetterSpacing(text, style, canvasAndContext, x, y, isStroke = false) {\n    const { context } = canvasAndContext;\n    const letterSpacing = style.letterSpacing;\n    let useExperimentalLetterSpacing = false;\n    if (CanvasTextMetrics.experimentalLetterSpacingSupported) {\n      if (CanvasTextMetrics.experimentalLetterSpacing) {\n        context.letterSpacing = `${letterSpacing}px`;\n        context.textLetterSpacing = `${letterSpacing}px`;\n        useExperimentalLetterSpacing = true;\n      } else {\n        context.letterSpacing = \"0px\";\n        context.textLetterSpacing = \"0px\";\n      }\n    }\n    if (letterSpacing === 0 || useExperimentalLetterSpacing) {\n      if (isStroke) {\n        context.strokeText(text, x, y);\n      } else {\n        context.fillText(text, x, y);\n      }\n      return;\n    }\n    let currentPosition = x;\n    const stringArray = CanvasTextMetrics.graphemeSegmenter(text);\n    let previousWidth = context.measureText(text).width;\n    let currentWidth = 0;\n    for (let i = 0; i < stringArray.length; ++i) {\n      const currentChar = stringArray[i];\n      if (isStroke) {\n        context.strokeText(currentChar, currentPosition, y);\n      } else {\n        context.fillText(currentChar, currentPosition, y);\n      }\n      let textStr = \"\";\n      for (let j = i + 1; j < stringArray.length; ++j) {\n        textStr += stringArray[j];\n      }\n      currentWidth = context.measureText(textStr).width;\n      currentPosition += previousWidth - currentWidth + letterSpacing;\n      previousWidth = currentWidth;\n    }\n  }\n}\nconst CanvasTextGenerator = new CanvasTextGeneratorClass();\n\nexport { CanvasTextGenerator };\n//# sourceMappingURL=CanvasTextGenerator.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\n\n\"use strict\";\nconst nssvg = \"http://www.w3.org/2000/svg\";\nconst nsxhtml = \"http://www.w3.org/1999/xhtml\";\nclass HTMLTextRenderData {\n  constructor() {\n    this.svgRoot = document.createElementNS(nssvg, \"svg\");\n    this.foreignObject = document.createElementNS(nssvg, \"foreignObject\");\n    this.domElement = document.createElementNS(nsxhtml, \"div\");\n    this.styleElement = document.createElementNS(nsxhtml, \"style\");\n    const { foreignObject, svgRoot, styleElement, domElement } = this;\n    foreignObject.setAttribute(\"width\", \"10000\");\n    foreignObject.setAttribute(\"height\", \"10000\");\n    foreignObject.style.overflow = \"hidden\";\n    svgRoot.appendChild(foreignObject);\n    foreignObject.appendChild(styleElement);\n    foreignObject.appendChild(domElement);\n    this.image = DOMAdapter.get().createImage();\n  }\n  destroy() {\n    this.svgRoot.remove();\n    this.foreignObject.remove();\n    this.styleElement.remove();\n    this.domElement.remove();\n    this.image.src = \"\";\n    this.image.remove();\n    this.svgRoot = null;\n    this.foreignObject = null;\n    this.styleElement = null;\n    this.domElement = null;\n    this.image = null;\n    this.canvasAndContext = null;\n  }\n}\n\nexport { HTMLTextRenderData };\n//# sourceMappingURL=HTMLTextRenderData.mjs.map\n","import { HTMLTextRenderData } from '../HTMLTextRenderData.mjs';\n\n\"use strict\";\nlet tempHTMLTextRenderData;\nfunction measureHtmlText(text, style, fontStyleCSS, htmlTextRenderData) {\n  htmlTextRenderData || (htmlTextRenderData = tempHTMLTextRenderData || (tempHTMLTextRenderData = new HTMLTextRenderData()));\n  const { domElement, styleElement, svgRoot } = htmlTextRenderData;\n  domElement.innerHTML = `<style>${style.cssStyle};</style><div style='padding:0'>${text}</div>`;\n  domElement.setAttribute(\"style\", \"transform-origin: top left; display: inline-block\");\n  if (fontStyleCSS) {\n    styleElement.textContent = fontStyleCSS;\n  }\n  document.body.appendChild(svgRoot);\n  const contentBounds = domElement.getBoundingClientRect();\n  svgRoot.remove();\n  const doublePadding = style.padding * 2;\n  return {\n    width: contentBounds.width - doublePadding,\n    height: contentBounds.height - doublePadding\n  };\n}\n\nexport { measureHtmlText };\n//# sourceMappingURL=measureHtmlText.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { State } from '../../../rendering/renderers/shared/state/State.mjs';\nimport { BigPool } from '../../../utils/pool/PoolGroup.mjs';\nimport { color32BitToUniform } from '../gpu/colorToUniform.mjs';\nimport { BatchableGraphics } from './BatchableGraphics.mjs';\n\n\"use strict\";\nclass GraphicsGpuData {\n  constructor() {\n    this.batches = [];\n    this.batched = false;\n  }\n  destroy() {\n    this.batches.forEach((batch) => {\n      BigPool.return(batch);\n    });\n    this.batches.length = 0;\n  }\n}\nclass GraphicsPipe {\n  constructor(renderer, adaptor) {\n    this.state = State.for2d();\n    this.renderer = renderer;\n    this._adaptor = adaptor;\n    this.renderer.runners.contextChange.add(this);\n  }\n  contextChange() {\n    this._adaptor.contextChange(this.renderer);\n  }\n  validateRenderable(graphics) {\n    const context = graphics.context;\n    const wasBatched = !!graphics._gpuData;\n    const gpuContext = this.renderer.graphicsContext.updateGpuContext(context);\n    if (gpuContext.isBatchable || wasBatched !== gpuContext.isBatchable) {\n      return true;\n    }\n    return false;\n  }\n  addRenderable(graphics, instructionSet) {\n    const gpuContext = this.renderer.graphicsContext.updateGpuContext(graphics.context);\n    if (graphics.didViewUpdate) {\n      this._rebuild(graphics);\n    }\n    if (gpuContext.isBatchable) {\n      this._addToBatcher(graphics, instructionSet);\n    } else {\n      this.renderer.renderPipes.batch.break(instructionSet);\n      instructionSet.add(graphics);\n    }\n  }\n  updateRenderable(graphics) {\n    const gpuData = this._getGpuDataForRenderable(graphics);\n    const batches = gpuData.batches;\n    for (let i = 0; i < batches.length; i++) {\n      const batch = batches[i];\n      batch._batcher.updateElement(batch);\n    }\n  }\n  execute(graphics) {\n    if (!graphics.isRenderable)\n      return;\n    const renderer = this.renderer;\n    const context = graphics.context;\n    const contextSystem = renderer.graphicsContext;\n    if (!contextSystem.getGpuContext(context).batches.length) {\n      return;\n    }\n    const shader = context.customShader || this._adaptor.shader;\n    this.state.blendMode = graphics.groupBlendMode;\n    const localUniforms = shader.resources.localUniforms.uniforms;\n    localUniforms.uTransformMatrix = graphics.groupTransform;\n    localUniforms.uRound = renderer._roundPixels | graphics._roundPixels;\n    color32BitToUniform(\n      graphics.groupColorAlpha,\n      localUniforms.uColor,\n      0\n    );\n    this._adaptor.execute(this, graphics);\n  }\n  _rebuild(graphics) {\n    const gpuData = this._getGpuDataForRenderable(graphics);\n    const gpuContext = this.renderer.graphicsContext.updateGpuContext(graphics.context);\n    gpuData.destroy();\n    if (gpuContext.isBatchable) {\n      this._updateBatchesForRenderable(graphics, gpuData);\n    }\n  }\n  _addToBatcher(graphics, instructionSet) {\n    const batchPipe = this.renderer.renderPipes.batch;\n    const batches = this._getGpuDataForRenderable(graphics).batches;\n    for (let i = 0; i < batches.length; i++) {\n      const batch = batches[i];\n      batchPipe.addToBatch(batch, instructionSet);\n    }\n  }\n  _getGpuDataForRenderable(graphics) {\n    return graphics._gpuData[this.renderer.uid] || this._initGpuDataForRenderable(graphics);\n  }\n  _initGpuDataForRenderable(graphics) {\n    const gpuData = new GraphicsGpuData();\n    graphics._gpuData[this.renderer.uid] = gpuData;\n    return gpuData;\n  }\n  _updateBatchesForRenderable(graphics, gpuData) {\n    const context = graphics.context;\n    const gpuContext = this.renderer.graphicsContext.getGpuContext(context);\n    const roundPixels = this.renderer._roundPixels | graphics._roundPixels;\n    gpuData.batches = gpuContext.batches.map((batch) => {\n      const batchClone = BigPool.get(BatchableGraphics);\n      batch.copyTo(batchClone);\n      batchClone.renderable = graphics;\n      batchClone.roundPixels = roundPixels;\n      return batchClone;\n    });\n  }\n  destroy() {\n    this.renderer = null;\n    this._adaptor.destroy();\n    this._adaptor = null;\n    this.state = null;\n  }\n}\n/** @ignore */\nGraphicsPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"graphics\"\n};\n\nexport { GraphicsGpuData, GraphicsPipe };\n//# sourceMappingURL=GraphicsPipe.mjs.map\n","import { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { MeshGeometry } from '../mesh/shared/MeshGeometry.mjs';\n\n\"use strict\";\nconst _PlaneGeometry = class _PlaneGeometry extends MeshGeometry {\n  constructor(...args) {\n    super({});\n    let options = args[0] ?? {};\n    if (typeof options === \"number\") {\n      deprecation(v8_0_0, \"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead\");\n      options = {\n        width: options,\n        height: args[1],\n        verticesX: args[2],\n        verticesY: args[3]\n      };\n    }\n    this.build(options);\n  }\n  /**\n   * Refreshes plane coordinates\n   * @param options - Options to be applied to plane geometry\n   */\n  build(options) {\n    options = { ..._PlaneGeometry.defaultOptions, ...options };\n    this.verticesX = this.verticesX ?? options.verticesX;\n    this.verticesY = this.verticesY ?? options.verticesY;\n    this.width = this.width ?? options.width;\n    this.height = this.height ?? options.height;\n    const total = this.verticesX * this.verticesY;\n    const verts = [];\n    const uvs = [];\n    const indices = [];\n    const verticesX = this.verticesX - 1;\n    const verticesY = this.verticesY - 1;\n    const sizeX = this.width / verticesX;\n    const sizeY = this.height / verticesY;\n    for (let i = 0; i < total; i++) {\n      const x = i % this.verticesX;\n      const y = i / this.verticesX | 0;\n      verts.push(x * sizeX, y * sizeY);\n      uvs.push(x / verticesX, y / verticesY);\n    }\n    const totalSub = verticesX * verticesY;\n    for (let i = 0; i < totalSub; i++) {\n      const xpos = i % verticesX;\n      const ypos = i / verticesX | 0;\n      const value = ypos * this.verticesX + xpos;\n      const value2 = ypos * this.verticesX + xpos + 1;\n      const value3 = (ypos + 1) * this.verticesX + xpos;\n      const value4 = (ypos + 1) * this.verticesX + xpos + 1;\n      indices.push(\n        value,\n        value2,\n        value3,\n        value2,\n        value4,\n        value3\n      );\n    }\n    this.buffers[0].data = new Float32Array(verts);\n    this.buffers[1].data = new Float32Array(uvs);\n    this.indexBuffer.data = new Uint32Array(indices);\n    this.buffers[0].update();\n    this.buffers[1].update();\n    this.indexBuffer.update();\n  }\n};\n_PlaneGeometry.defaultOptions = {\n  width: 100,\n  height: 100,\n  verticesX: 10,\n  verticesY: 10\n};\nlet PlaneGeometry = _PlaneGeometry;\n\nexport { PlaneGeometry };\n//# sourceMappingURL=PlaneGeometry.mjs.map\n","\"use strict\";\nclass BatchableMesh {\n  constructor() {\n    this.batcherName = \"default\";\n    this.packAsQuad = false;\n    this.indexOffset = 0;\n    this.attributeOffset = 0;\n    this.roundPixels = 0;\n    this._batcher = null;\n    this._batch = null;\n    this._textureMatrixUpdateId = -1;\n    this._uvUpdateId = -1;\n  }\n  get blendMode() {\n    return this.renderable.groupBlendMode;\n  }\n  get topology() {\n    return this._topology || this.geometry.topology;\n  }\n  set topology(value) {\n    this._topology = value;\n  }\n  reset() {\n    this.renderable = null;\n    this.texture = null;\n    this._batcher = null;\n    this._batch = null;\n    this.geometry = null;\n    this._uvUpdateId = -1;\n    this._textureMatrixUpdateId = -1;\n  }\n  /**\n   * Sets the texture for the batchable mesh.\n   * As it does so, it resets the texture matrix update ID.\n   * this is to ensure that the texture matrix is recalculated when the uvs are referenced\n   * @param value - The texture to set.\n   */\n  setTexture(value) {\n    if (this.texture === value)\n      return;\n    this.texture = value;\n    this._textureMatrixUpdateId = -1;\n  }\n  get uvs() {\n    const geometry = this.geometry;\n    const uvBuffer = geometry.getBuffer(\"aUV\");\n    const uvs = uvBuffer.data;\n    let transformedUvs = uvs;\n    const textureMatrix = this.texture.textureMatrix;\n    if (!textureMatrix.isSimple) {\n      transformedUvs = this._transformedUvs;\n      if (this._textureMatrixUpdateId !== textureMatrix._updateID || this._uvUpdateId !== uvBuffer._updateID) {\n        if (!transformedUvs || transformedUvs.length < uvs.length) {\n          transformedUvs = this._transformedUvs = new Float32Array(uvs.length);\n        }\n        this._textureMatrixUpdateId = textureMatrix._updateID;\n        this._uvUpdateId = uvBuffer._updateID;\n        textureMatrix.multiplyUvs(uvs, transformedUvs);\n      }\n    }\n    return transformedUvs;\n  }\n  get positions() {\n    return this.geometry.positions;\n  }\n  get indices() {\n    return this.geometry.indices;\n  }\n  get color() {\n    return this.renderable.groupColorAlpha;\n  }\n  get groupTransform() {\n    return this.renderable.groupTransform;\n  }\n  get attributeSize() {\n    return this.geometry.positions.length / 2;\n  }\n  get indexSize() {\n    return this.geometry.indices.length;\n  }\n}\n\nexport { BatchableMesh };\n//# sourceMappingURL=BatchableMesh.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { BindGroup } from '../../../rendering/renderers/gpu/shader/BindGroup.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { getAdjustedBlendModeBlend } from '../../../rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nimport { color32BitToUniform } from '../../graphics/gpu/colorToUniform.mjs';\nimport { BatchableMesh } from './BatchableMesh.mjs';\n\n\"use strict\";\nclass MeshGpuData {\n  destroy() {\n  }\n}\nclass MeshPipe {\n  constructor(renderer, adaptor) {\n    this.localUniforms = new UniformGroup({\n      uTransformMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uColor: { value: new Float32Array([1, 1, 1, 1]), type: \"vec4<f32>\" },\n      uRound: { value: 0, type: \"f32\" }\n    });\n    this.localUniformsBindGroup = new BindGroup({\n      0: this.localUniforms\n    });\n    this.renderer = renderer;\n    this._adaptor = adaptor;\n    this._adaptor.init();\n  }\n  validateRenderable(mesh) {\n    const meshData = this._getMeshData(mesh);\n    const wasBatched = meshData.batched;\n    const isBatched = mesh.batched;\n    meshData.batched = isBatched;\n    if (wasBatched !== isBatched) {\n      return true;\n    } else if (isBatched) {\n      const geometry = mesh._geometry;\n      if (geometry.indices.length !== meshData.indexSize || geometry.positions.length !== meshData.vertexSize) {\n        meshData.indexSize = geometry.indices.length;\n        meshData.vertexSize = geometry.positions.length;\n        return true;\n      }\n      const batchableMesh = this._getBatchableMesh(mesh);\n      if (batchableMesh.texture.uid !== mesh._texture.uid) {\n        batchableMesh._textureMatrixUpdateId = -1;\n      }\n      return !batchableMesh._batcher.checkAndUpdateTexture(\n        batchableMesh,\n        mesh._texture\n      );\n    }\n    return false;\n  }\n  addRenderable(mesh, instructionSet) {\n    const batcher = this.renderer.renderPipes.batch;\n    const meshData = this._getMeshData(mesh);\n    if (mesh.didViewUpdate) {\n      meshData.indexSize = mesh._geometry.indices?.length;\n      meshData.vertexSize = mesh._geometry.positions?.length;\n    }\n    if (meshData.batched) {\n      const gpuBatchableMesh = this._getBatchableMesh(mesh);\n      gpuBatchableMesh.setTexture(mesh._texture);\n      gpuBatchableMesh.geometry = mesh._geometry;\n      batcher.addToBatch(gpuBatchableMesh, instructionSet);\n    } else {\n      batcher.break(instructionSet);\n      instructionSet.add(mesh);\n    }\n  }\n  updateRenderable(mesh) {\n    if (mesh.batched) {\n      const gpuBatchableMesh = this._getBatchableMesh(mesh);\n      gpuBatchableMesh.setTexture(mesh._texture);\n      gpuBatchableMesh.geometry = mesh._geometry;\n      gpuBatchableMesh._batcher.updateElement(gpuBatchableMesh);\n    }\n  }\n  execute(mesh) {\n    if (!mesh.isRenderable)\n      return;\n    mesh.state.blendMode = getAdjustedBlendModeBlend(mesh.groupBlendMode, mesh.texture._source);\n    const localUniforms = this.localUniforms;\n    localUniforms.uniforms.uTransformMatrix = mesh.groupTransform;\n    localUniforms.uniforms.uRound = this.renderer._roundPixels | mesh._roundPixels;\n    localUniforms.update();\n    color32BitToUniform(\n      mesh.groupColorAlpha,\n      localUniforms.uniforms.uColor,\n      0\n    );\n    this._adaptor.execute(this, mesh);\n  }\n  _getMeshData(mesh) {\n    var _a, _b;\n    (_a = mesh._gpuData)[_b = this.renderer.uid] || (_a[_b] = new MeshGpuData());\n    return mesh._gpuData[this.renderer.uid].meshData || this._initMeshData(mesh);\n  }\n  _initMeshData(mesh) {\n    mesh._gpuData[this.renderer.uid].meshData = {\n      batched: mesh.batched,\n      indexSize: 0,\n      vertexSize: 0\n    };\n    return mesh._gpuData[this.renderer.uid].meshData;\n  }\n  _getBatchableMesh(mesh) {\n    var _a, _b;\n    (_a = mesh._gpuData)[_b = this.renderer.uid] || (_a[_b] = new MeshGpuData());\n    return mesh._gpuData[this.renderer.uid].batchableMesh || this._initBatchableMesh(mesh);\n  }\n  _initBatchableMesh(mesh) {\n    const gpuMesh = new BatchableMesh();\n    gpuMesh.renderable = mesh;\n    gpuMesh.setTexture(mesh._texture);\n    gpuMesh.transform = mesh.groupTransform;\n    gpuMesh.roundPixels = this.renderer._roundPixels | mesh._roundPixels;\n    mesh._gpuData[this.renderer.uid].batchableMesh = gpuMesh;\n    return gpuMesh;\n  }\n  destroy() {\n    this.localUniforms = null;\n    this.localUniformsBindGroup = null;\n    this._adaptor.destroy();\n    this._adaptor = null;\n    this.renderer = null;\n  }\n}\n/** @ignore */\nMeshPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"mesh\"\n};\n\nexport { MeshGpuData, MeshPipe };\n//# sourceMappingURL=MeshPipe.mjs.map\n","\"use strict\";\nclass GlParticleContainerAdaptor {\n  execute(particleContainerPipe, container) {\n    const state = particleContainerPipe.state;\n    const renderer = particleContainerPipe.renderer;\n    const shader = container.shader || particleContainerPipe.defaultShader;\n    shader.resources.uTexture = container.texture._source;\n    shader.resources.uniforms = particleContainerPipe.localUniforms;\n    const gl = renderer.gl;\n    const buffer = particleContainerPipe.getBuffers(container);\n    renderer.shader.bind(shader);\n    renderer.state.set(state);\n    renderer.geometry.bind(buffer.geometry, shader.glProgram);\n    const byteSize = buffer.geometry.indexBuffer.data.BYTES_PER_ELEMENT;\n    const glType = byteSize === 2 ? gl.UNSIGNED_SHORT : gl.UNSIGNED_INT;\n    gl.drawElements(gl.TRIANGLES, container.particleChildren.length * 6, glType, 0);\n  }\n}\n\nexport { GlParticleContainerAdaptor };\n//# sourceMappingURL=GlParticleContainerAdaptor.mjs.map\n","\"use strict\";\nclass GpuParticleContainerAdaptor {\n  execute(particleContainerPipe, container) {\n    const renderer = particleContainerPipe.renderer;\n    const shader = container.shader || particleContainerPipe.defaultShader;\n    shader.groups[0] = renderer.renderPipes.uniformBatch.getUniformBindGroup(particleContainerPipe.localUniforms, true);\n    shader.groups[1] = renderer.texture.getTextureBindGroup(container.texture);\n    const state = particleContainerPipe.state;\n    const buffer = particleContainerPipe.getBuffers(container);\n    renderer.encoder.draw({\n      geometry: buffer.geometry,\n      shader: container.shader || particleContainerPipe.defaultShader,\n      state,\n      size: container.particleChildren.length * 6\n    });\n  }\n}\n\nexport { GpuParticleContainerAdaptor };\n//# sourceMappingURL=GpuParticleContainerAdaptor.mjs.map\n","\"use strict\";\nfunction createIndicesForQuads(size, outBuffer = null) {\n  const totalIndices = size * 6;\n  if (totalIndices > 65535) {\n    outBuffer || (outBuffer = new Uint32Array(totalIndices));\n  } else {\n    outBuffer || (outBuffer = new Uint16Array(totalIndices));\n  }\n  if (outBuffer.length !== totalIndices) {\n    throw new Error(`Out buffer length is incorrect, got ${outBuffer.length} and expected ${totalIndices}`);\n  }\n  for (let i = 0, j = 0; i < totalIndices; i += 6, j += 4) {\n    outBuffer[i + 0] = j + 0;\n    outBuffer[i + 1] = j + 1;\n    outBuffer[i + 2] = j + 2;\n    outBuffer[i + 3] = j + 0;\n    outBuffer[i + 4] = j + 2;\n    outBuffer[i + 5] = j + 3;\n  }\n  return outBuffer;\n}\n\nexport { createIndicesForQuads };\n//# sourceMappingURL=createIndicesForQuads.mjs.map\n","import { getAttributeInfoFromFormat } from '../../../../rendering/renderers/shared/geometry/utils/getAttributeInfoFromFormat.mjs';\n\n\"use strict\";\nfunction generateParticleUpdateFunction(properties) {\n  return {\n    dynamicUpdate: generateUpdateFunction(properties, true),\n    staticUpdate: generateUpdateFunction(properties, false)\n  };\n}\nfunction generateUpdateFunction(properties, dynamic) {\n  const funcFragments = [];\n  funcFragments.push(`\n\n        var index = 0;\n\n        for (let i = 0; i < ps.length; ++i)\n        {\n            const p = ps[i];\n\n            `);\n  let offset = 0;\n  for (const i in properties) {\n    const property = properties[i];\n    if (dynamic !== property.dynamic)\n      continue;\n    funcFragments.push(`offset = index + ${offset}`);\n    funcFragments.push(property.code);\n    const attributeInfo = getAttributeInfoFromFormat(property.format);\n    offset += attributeInfo.stride / 4;\n  }\n  funcFragments.push(`\n            index += stride * 4;\n        }\n    `);\n  funcFragments.unshift(`\n        var stride = ${offset};\n    `);\n  const functionSource = funcFragments.join(\"\\n\");\n  return new Function(\"ps\", \"f32v\", \"u32v\", functionSource);\n}\n\nexport { generateParticleUpdateFunction };\n//# sourceMappingURL=generateParticleUpdateFunction.mjs.map\n","import { Buffer } from '../../../rendering/renderers/shared/buffer/Buffer.mjs';\nimport { BufferUsage } from '../../../rendering/renderers/shared/buffer/const.mjs';\nimport { Geometry } from '../../../rendering/renderers/shared/geometry/Geometry.mjs';\nimport { getAttributeInfoFromFormat } from '../../../rendering/renderers/shared/geometry/utils/getAttributeInfoFromFormat.mjs';\nimport { ViewableBuffer } from '../../../utils/data/ViewableBuffer.mjs';\nimport { createIndicesForQuads } from './utils/createIndicesForQuads.mjs';\nimport { generateParticleUpdateFunction } from './utils/generateParticleUpdateFunction.mjs';\n\n\"use strict\";\nclass ParticleBuffer {\n  constructor(options) {\n    this._size = 0;\n    this._generateParticleUpdateCache = {};\n    const size = this._size = options.size ?? 1e3;\n    const properties = options.properties;\n    let staticVertexSize = 0;\n    let dynamicVertexSize = 0;\n    for (const i in properties) {\n      const property = properties[i];\n      const attributeInfo = getAttributeInfoFromFormat(property.format);\n      if (property.dynamic) {\n        dynamicVertexSize += attributeInfo.stride;\n      } else {\n        staticVertexSize += attributeInfo.stride;\n      }\n    }\n    this._dynamicStride = dynamicVertexSize / 4;\n    this._staticStride = staticVertexSize / 4;\n    this.staticAttributeBuffer = new ViewableBuffer(size * 4 * staticVertexSize);\n    this.dynamicAttributeBuffer = new ViewableBuffer(size * 4 * dynamicVertexSize);\n    this.indexBuffer = createIndicesForQuads(size);\n    const geometry = new Geometry();\n    let dynamicOffset = 0;\n    let staticOffset = 0;\n    this._staticBuffer = new Buffer({\n      data: new Float32Array(1),\n      label: \"static-particle-buffer\",\n      shrinkToFit: false,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    this._dynamicBuffer = new Buffer({\n      data: new Float32Array(1),\n      label: \"dynamic-particle-buffer\",\n      shrinkToFit: false,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    for (const i in properties) {\n      const property = properties[i];\n      const attributeInfo = getAttributeInfoFromFormat(property.format);\n      if (property.dynamic) {\n        geometry.addAttribute(property.attributeName, {\n          buffer: this._dynamicBuffer,\n          stride: this._dynamicStride * 4,\n          offset: dynamicOffset * 4,\n          format: property.format\n        });\n        dynamicOffset += attributeInfo.size;\n      } else {\n        geometry.addAttribute(property.attributeName, {\n          buffer: this._staticBuffer,\n          stride: this._staticStride * 4,\n          offset: staticOffset * 4,\n          format: property.format\n        });\n        staticOffset += attributeInfo.size;\n      }\n    }\n    geometry.addIndex(this.indexBuffer);\n    const uploadFunction = this.getParticleUpdate(properties);\n    this._dynamicUpload = uploadFunction.dynamicUpdate;\n    this._staticUpload = uploadFunction.staticUpdate;\n    this.geometry = geometry;\n  }\n  getParticleUpdate(properties) {\n    const key = getParticleSyncKey(properties);\n    if (this._generateParticleUpdateCache[key]) {\n      return this._generateParticleUpdateCache[key];\n    }\n    this._generateParticleUpdateCache[key] = this.generateParticleUpdate(properties);\n    return this._generateParticleUpdateCache[key];\n  }\n  generateParticleUpdate(properties) {\n    return generateParticleUpdateFunction(properties);\n  }\n  update(particles, uploadStatic) {\n    if (particles.length > this._size) {\n      uploadStatic = true;\n      this._size = Math.max(particles.length, this._size * 1.5 | 0);\n      this.staticAttributeBuffer = new ViewableBuffer(this._size * this._staticStride * 4 * 4);\n      this.dynamicAttributeBuffer = new ViewableBuffer(this._size * this._dynamicStride * 4 * 4);\n      this.indexBuffer = createIndicesForQuads(this._size);\n      this.geometry.indexBuffer.setDataWithSize(\n        this.indexBuffer,\n        this.indexBuffer.byteLength,\n        true\n      );\n    }\n    const dynamicAttributeBuffer = this.dynamicAttributeBuffer;\n    this._dynamicUpload(particles, dynamicAttributeBuffer.float32View, dynamicAttributeBuffer.uint32View);\n    this._dynamicBuffer.setDataWithSize(\n      this.dynamicAttributeBuffer.float32View,\n      particles.length * this._dynamicStride * 4,\n      true\n    );\n    if (uploadStatic) {\n      const staticAttributeBuffer = this.staticAttributeBuffer;\n      this._staticUpload(particles, staticAttributeBuffer.float32View, staticAttributeBuffer.uint32View);\n      this._staticBuffer.setDataWithSize(\n        staticAttributeBuffer.float32View,\n        particles.length * this._staticStride * 4,\n        true\n      );\n    }\n  }\n  destroy() {\n    this._staticBuffer.destroy();\n    this._dynamicBuffer.destroy();\n    this.geometry.destroy();\n  }\n}\nfunction getParticleSyncKey(properties) {\n  const keyGen = [];\n  for (const key in properties) {\n    const property = properties[key];\n    keyGen.push(key, property.code, property.dynamic ? \"d\" : \"s\");\n  }\n  return keyGen.join(\"_\");\n}\n\nexport { ParticleBuffer };\n//# sourceMappingURL=ParticleBuffer.mjs.map\n","var fragment = \"varying vec2 vUV;\\nvarying vec4 vColor;\\n\\nuniform sampler2D uTexture;\\n\\nvoid main(void){\\n    vec4 color = texture2D(uTexture, vUV) * vColor;\\n    gl_FragColor = color;\\n}\";\n\nexport { fragment as default };\n//# sourceMappingURL=particles.frag.mjs.map\n","var vertex = \"attribute vec2 aVertex;\\nattribute vec2 aUV;\\nattribute vec4 aColor;\\n\\nattribute vec2 aPosition;\\nattribute float aRotation;\\n\\nuniform mat3 uTranslationMatrix;\\nuniform float uRound;\\nuniform vec2 uResolution;\\nuniform vec4 uColor;\\n\\nvarying vec2 vUV;\\nvarying vec4 vColor;\\n\\nvec2 roundPixels(vec2 position, vec2 targetSize)\\n{       \\n    return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\\n}\\n\\nvoid main(void){\\n    float cosRotation = cos(aRotation);\\n    float sinRotation = sin(aRotation);\\n    float x = aVertex.x * cosRotation - aVertex.y * sinRotation;\\n    float y = aVertex.x * sinRotation + aVertex.y * cosRotation;\\n\\n    vec2 v = vec2(x, y);\\n    v = v + aPosition;\\n\\n    gl_Position = vec4((uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\\n\\n    if(uRound == 1.0)\\n    {\\n        gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\\n    }\\n\\n    vUV = aUV;\\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uColor;\\n}\\n\";\n\nexport { vertex as default };\n//# sourceMappingURL=particles.vert.mjs.map\n","var wgsl = \"\\nstruct ParticleUniforms {\\n  uTranslationMatrix:mat3x3<f32>,\\n  uColor:vec4<f32>,\\n  uRound:f32,\\n  uResolution:vec2<f32>,\\n};\\n\\nfn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\\n{\\n  return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\\n}\\n\\n@group(0) @binding(0) var<uniform> uniforms: ParticleUniforms;\\n\\n@group(1) @binding(0) var uTexture: texture_2d<f32>;\\n@group(1) @binding(1) var uSampler : sampler;\\n\\nstruct VSOutput {\\n    @builtin(position) position: vec4<f32>,\\n    @location(0) uv : vec2<f32>,\\n    @location(1) color : vec4<f32>,\\n  };\\n@vertex\\nfn mainVertex(\\n  @location(0) aVertex: vec2<f32>,\\n  @location(1) aPosition: vec2<f32>,\\n  @location(2) aUV: vec2<f32>,\\n  @location(3) aColor: vec4<f32>,\\n  @location(4) aRotation: f32,\\n) -> VSOutput {\\n  \\n   let v = vec2(\\n       aVertex.x * cos(aRotation) - aVertex.y * sin(aRotation),\\n       aVertex.x * sin(aRotation) + aVertex.y * cos(aRotation)\\n   ) + aPosition;\\n\\n   var position = vec4((uniforms.uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\\n\\n   if(uniforms.uRound == 1.0) {\\n       position = vec4(roundPixels(position.xy, uniforms.uResolution), position.zw);\\n   }\\n\\n    let vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uniforms.uColor;\\n\\n  return VSOutput(\\n   position,\\n   aUV,\\n   vColor,\\n  );\\n}\\n\\n@fragment\\nfn mainFragment(\\n  @location(0) uv: vec2<f32>,\\n  @location(1) color: vec4<f32>,\\n  @builtin(position) position: vec4<f32>,\\n) -> @location(0) vec4<f32> {\\n\\n    var sample = textureSample(uTexture, uSampler, uv) * color;\\n   \\n    return sample;\\n}\";\n\nexport { wgsl as default };\n//# sourceMappingURL=particles.wgsl.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { GlProgram } from '../../../../rendering/renderers/gl/shader/GlProgram.mjs';\nimport { GpuProgram } from '../../../../rendering/renderers/gpu/shader/GpuProgram.mjs';\nimport { Shader } from '../../../../rendering/renderers/shared/shader/Shader.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { TextureStyle } from '../../../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport fragment from './particles.frag.mjs';\nimport vertex from './particles.vert.mjs';\nimport wgsl from './particles.wgsl.mjs';\n\n\"use strict\";\nclass ParticleShader extends Shader {\n  constructor() {\n    const glProgram = GlProgram.from({\n      vertex,\n      fragment\n    });\n    const gpuProgram = GpuProgram.from({\n      fragment: {\n        source: wgsl,\n        entryPoint: \"mainFragment\"\n      },\n      vertex: {\n        source: wgsl,\n        entryPoint: \"mainVertex\"\n      }\n    });\n    super({\n      glProgram,\n      gpuProgram,\n      resources: {\n        // this will be replaced with the texture from the particle container\n        uTexture: Texture.WHITE.source,\n        // this will be replaced with the texture style from the particle container\n        uSampler: new TextureStyle({}),\n        // this will be replaced with the local uniforms from the particle container\n        uniforms: {\n          uTranslationMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n          uColor: { value: new Color(16777215), type: \"vec4<f32>\" },\n          uRound: { value: 1, type: \"f32\" },\n          uResolution: { value: [0, 0], type: \"vec2<f32>\" }\n        }\n      }\n    });\n  }\n}\n\nexport { ParticleShader };\n//# sourceMappingURL=ParticleShader.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { getAdjustedBlendModeBlend } from '../../../rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nimport { State } from '../../../rendering/renderers/shared/state/State.mjs';\nimport { color32BitToUniform } from '../../graphics/gpu/colorToUniform.mjs';\nimport { ParticleBuffer } from './ParticleBuffer.mjs';\nimport { ParticleShader } from './shader/ParticleShader.mjs';\n\n\"use strict\";\nclass ParticleContainerPipe {\n  /**\n   * @param renderer - The renderer this sprite batch works for.\n   * @param adaptor\n   */\n  constructor(renderer, adaptor) {\n    /** @internal */\n    this.state = State.for2d();\n    /** Local uniforms that are used for rendering particles. */\n    this.localUniforms = new UniformGroup({\n      uTranslationMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uColor: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uRound: { value: 1, type: \"f32\" },\n      uResolution: { value: [0, 0], type: \"vec2<f32>\" }\n    });\n    this.renderer = renderer;\n    this.adaptor = adaptor;\n    this.defaultShader = new ParticleShader();\n    this.state = State.for2d();\n  }\n  validateRenderable(_renderable) {\n    return false;\n  }\n  addRenderable(renderable, instructionSet) {\n    this.renderer.renderPipes.batch.break(instructionSet);\n    instructionSet.add(renderable);\n  }\n  getBuffers(renderable) {\n    return renderable._gpuData[this.renderer.uid] || this._initBuffer(renderable);\n  }\n  _initBuffer(renderable) {\n    renderable._gpuData[this.renderer.uid] = new ParticleBuffer({\n      size: renderable.particleChildren.length,\n      properties: renderable._properties\n    });\n    return renderable._gpuData[this.renderer.uid];\n  }\n  updateRenderable(_renderable) {\n  }\n  execute(container) {\n    const children = container.particleChildren;\n    if (children.length === 0) {\n      return;\n    }\n    const renderer = this.renderer;\n    const buffer = this.getBuffers(container);\n    container.texture || (container.texture = children[0].texture);\n    const state = this.state;\n    buffer.update(children, container._childrenDirty);\n    container._childrenDirty = false;\n    state.blendMode = getAdjustedBlendModeBlend(container.blendMode, container.texture._source);\n    const uniforms = this.localUniforms.uniforms;\n    const transformationMatrix = uniforms.uTranslationMatrix;\n    container.worldTransform.copyTo(transformationMatrix);\n    transformationMatrix.prepend(renderer.globalUniforms.globalUniformData.projectionMatrix);\n    uniforms.uResolution = renderer.globalUniforms.globalUniformData.resolution;\n    uniforms.uRound = renderer._roundPixels | container._roundPixels;\n    color32BitToUniform(\n      container.groupColorAlpha,\n      uniforms.uColor,\n      0\n    );\n    this.adaptor.execute(this, container);\n  }\n  /** Destroys the ParticleRenderer. */\n  destroy() {\n    this.renderer = null;\n    if (this.defaultShader) {\n      this.defaultShader.destroy();\n      this.defaultShader = null;\n    }\n  }\n}\n\nexport { ParticleContainerPipe };\n//# sourceMappingURL=ParticleContainerPipe.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { GlParticleContainerAdaptor } from '../gl/GlParticleContainerAdaptor.mjs';\nimport { ParticleContainerPipe } from './ParticleContainerPipe.mjs';\n\n\"use strict\";\nclass GlParticleContainerPipe extends ParticleContainerPipe {\n  constructor(renderer) {\n    super(renderer, new GlParticleContainerAdaptor());\n  }\n}\n/** @ignore */\nGlParticleContainerPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes\n  ],\n  name: \"particle\"\n};\n\nexport { GlParticleContainerPipe };\n//# sourceMappingURL=GlParticleContainerPipe.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { GpuParticleContainerAdaptor } from '../gpu/GpuParticleContainerAdaptor.mjs';\nimport { ParticleContainerPipe } from './ParticleContainerPipe.mjs';\n\n\"use strict\";\nclass GpuParticleContainerPipe extends ParticleContainerPipe {\n  constructor(renderer) {\n    super(renderer, new GpuParticleContainerAdaptor());\n  }\n}\n/** @ignore */\nGpuParticleContainerPipe.extension = {\n  type: [\n    ExtensionType.WebGPUPipes\n  ],\n  name: \"particle\"\n};\n\nexport { GpuParticleContainerPipe };\n//# sourceMappingURL=GpuParticleContainerPipe.mjs.map\n","import { PlaneGeometry } from '../mesh-plane/PlaneGeometry.mjs';\n\n\"use strict\";\nconst _NineSliceGeometry = class _NineSliceGeometry extends PlaneGeometry {\n  constructor(options = {}) {\n    options = { ..._NineSliceGeometry.defaultOptions, ...options };\n    super({\n      width: options.width,\n      height: options.height,\n      verticesX: 4,\n      verticesY: 4\n    });\n    this.update(options);\n  }\n  /**\n   * Updates the NineSliceGeometry with the options.\n   * @param options - The options of the NineSliceGeometry.\n   */\n  update(options) {\n    this.width = options.width ?? this.width;\n    this.height = options.height ?? this.height;\n    this._originalWidth = options.originalWidth ?? this._originalWidth;\n    this._originalHeight = options.originalHeight ?? this._originalHeight;\n    this._leftWidth = options.leftWidth ?? this._leftWidth;\n    this._rightWidth = options.rightWidth ?? this._rightWidth;\n    this._topHeight = options.topHeight ?? this._topHeight;\n    this._bottomHeight = options.bottomHeight ?? this._bottomHeight;\n    this._anchorX = options.anchor?.x;\n    this._anchorY = options.anchor?.y;\n    this.updateUvs();\n    this.updatePositions();\n  }\n  /** Updates the positions of the vertices. */\n  updatePositions() {\n    const p = this.positions;\n    const {\n      width,\n      height,\n      _leftWidth,\n      _rightWidth,\n      _topHeight,\n      _bottomHeight,\n      _anchorX,\n      _anchorY\n    } = this;\n    const w = _leftWidth + _rightWidth;\n    const scaleW = width > w ? 1 : width / w;\n    const h = _topHeight + _bottomHeight;\n    const scaleH = height > h ? 1 : height / h;\n    const scale = Math.min(scaleW, scaleH);\n    const anchorOffsetX = _anchorX * width;\n    const anchorOffsetY = _anchorY * height;\n    p[0] = p[8] = p[16] = p[24] = -anchorOffsetX;\n    p[2] = p[10] = p[18] = p[26] = _leftWidth * scale - anchorOffsetX;\n    p[4] = p[12] = p[20] = p[28] = width - _rightWidth * scale - anchorOffsetX;\n    p[6] = p[14] = p[22] = p[30] = width - anchorOffsetX;\n    p[1] = p[3] = p[5] = p[7] = -anchorOffsetY;\n    p[9] = p[11] = p[13] = p[15] = _topHeight * scale - anchorOffsetY;\n    p[17] = p[19] = p[21] = p[23] = height - _bottomHeight * scale - anchorOffsetY;\n    p[25] = p[27] = p[29] = p[31] = height - anchorOffsetY;\n    this.getBuffer(\"aPosition\").update();\n  }\n  /** Updates the UVs of the vertices. */\n  updateUvs() {\n    const uvs = this.uvs;\n    uvs[0] = uvs[8] = uvs[16] = uvs[24] = 0;\n    uvs[1] = uvs[3] = uvs[5] = uvs[7] = 0;\n    uvs[6] = uvs[14] = uvs[22] = uvs[30] = 1;\n    uvs[25] = uvs[27] = uvs[29] = uvs[31] = 1;\n    const _uvw = 1 / this._originalWidth;\n    const _uvh = 1 / this._originalHeight;\n    uvs[2] = uvs[10] = uvs[18] = uvs[26] = _uvw * this._leftWidth;\n    uvs[9] = uvs[11] = uvs[13] = uvs[15] = _uvh * this._topHeight;\n    uvs[4] = uvs[12] = uvs[20] = uvs[28] = 1 - _uvw * this._rightWidth;\n    uvs[17] = uvs[19] = uvs[21] = uvs[23] = 1 - _uvh * this._bottomHeight;\n    this.getBuffer(\"aUV\").update();\n  }\n};\n/** The default options for the NineSliceGeometry. */\n_NineSliceGeometry.defaultOptions = {\n  /** The width of the NineSlicePlane, setting this will actually modify the vertices and UV's of this plane. */\n  width: 100,\n  /** The height of the NineSlicePlane, setting this will actually modify the vertices and UV's of this plane. */\n  height: 100,\n  /** The width of the left column. */\n  leftWidth: 10,\n  /** The height of the top row. */\n  topHeight: 10,\n  /** The width of the right column. */\n  rightWidth: 10,\n  /** The height of the bottom row. */\n  bottomHeight: 10,\n  /** The original width of the texture */\n  originalWidth: 100,\n  /** The original height of the texture */\n  originalHeight: 100\n};\nlet NineSliceGeometry = _NineSliceGeometry;\n\nexport { NineSliceGeometry };\n//# sourceMappingURL=NineSliceGeometry.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { BatchableMesh } from '../mesh/shared/BatchableMesh.mjs';\nimport { NineSliceGeometry } from './NineSliceGeometry.mjs';\n\n\"use strict\";\nclass NineSliceSpriteGpuData extends BatchableMesh {\n  constructor() {\n    super();\n    this.geometry = new NineSliceGeometry();\n  }\n  destroy() {\n    this.geometry.destroy();\n  }\n}\nclass NineSliceSpritePipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  addRenderable(sprite, instructionSet) {\n    const gpuSprite = this._getGpuSprite(sprite);\n    if (sprite.didViewUpdate)\n      this._updateBatchableSprite(sprite, gpuSprite);\n    this._renderer.renderPipes.batch.addToBatch(gpuSprite, instructionSet);\n  }\n  updateRenderable(sprite) {\n    const gpuSprite = this._getGpuSprite(sprite);\n    if (sprite.didViewUpdate)\n      this._updateBatchableSprite(sprite, gpuSprite);\n    gpuSprite._batcher.updateElement(gpuSprite);\n  }\n  validateRenderable(sprite) {\n    const gpuSprite = this._getGpuSprite(sprite);\n    return !gpuSprite._batcher.checkAndUpdateTexture(\n      gpuSprite,\n      sprite._texture\n    );\n  }\n  _updateBatchableSprite(sprite, batchableSprite) {\n    batchableSprite.geometry.update(sprite);\n    batchableSprite.setTexture(sprite._texture);\n  }\n  _getGpuSprite(sprite) {\n    return sprite._gpuData[this._renderer.uid] || this._initGPUSprite(sprite);\n  }\n  _initGPUSprite(sprite) {\n    const gpuData = sprite._gpuData[this._renderer.uid] = new NineSliceSpriteGpuData();\n    const batchableMesh = gpuData;\n    batchableMesh.renderable = sprite;\n    batchableMesh.transform = sprite.groupTransform;\n    batchableMesh.texture = sprite._texture;\n    batchableMesh.roundPixels = this._renderer._roundPixels | sprite._roundPixels;\n    if (!sprite.didViewUpdate) {\n      this._updateBatchableSprite(sprite, batchableMesh);\n    }\n    return gpuData;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nNineSliceSpritePipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"nineSliceSprite\"\n};\n\nexport { NineSliceSpriteGpuData, NineSliceSpritePipe };\n//# sourceMappingURL=NineSliceSpritePipe.mjs.map\n","\"use strict\";\nconst tilingBit = {\n  name: \"tiling-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;\n\n            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* wgsl */\n      `\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n\n            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);\n            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;\n            var unclamped = coord;\n            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);\n\n            var bias = 0.;\n\n            if(unclamped.x == coord.x && unclamped.y == coord.y)\n            {\n                bias = -32.;\n            }\n\n            outColor = textureSampleBias(uTexture, uSampler, coord, bias);\n        `\n    )\n  }\n};\nconst tilingBitGl = {\n  name: \"tiling-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n            uniform mat3 uTextureTransform;\n            uniform vec4 uSizeAnchor;\n\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;\n\n            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* glsl */\n      `\n            uniform sampler2D uTexture;\n            uniform mat3 uMapCoord;\n            uniform vec4 uClampFrame;\n            uniform vec2 uClampOffset;\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n\n        vec2 coord = vUV + ceil(uClampOffset - vUV);\n        coord = (uMapCoord * vec3(coord, 1.0)).xy;\n        vec2 unclamped = coord;\n        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0\n\n        `\n    )\n  }\n};\n\nexport { tilingBit, tilingBitGl };\n//# sourceMappingURL=tilingBit.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { compileHighShaderGpuProgram, compileHighShaderGlProgram } from '../../../rendering/high-shader/compileHighShaderToProgram.mjs';\nimport { localUniformBit, localUniformBitGl } from '../../../rendering/high-shader/shader-bits/localUniformBit.mjs';\nimport { roundPixelsBit, roundPixelsBitGl } from '../../../rendering/high-shader/shader-bits/roundPixelsBit.mjs';\nimport { Shader } from '../../../rendering/renderers/shared/shader/Shader.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { Texture } from '../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { tilingBit, tilingBitGl } from './tilingBit.mjs';\n\n\"use strict\";\nlet gpuProgram;\nlet glProgram;\nclass TilingSpriteShader extends Shader {\n  constructor() {\n    gpuProgram ?? (gpuProgram = compileHighShaderGpuProgram({\n      name: \"tiling-sprite-shader\",\n      bits: [\n        localUniformBit,\n        tilingBit,\n        roundPixelsBit\n      ]\n    }));\n    glProgram ?? (glProgram = compileHighShaderGlProgram({\n      name: \"tiling-sprite-shader\",\n      bits: [\n        localUniformBitGl,\n        tilingBitGl,\n        roundPixelsBitGl\n      ]\n    }));\n    const tilingUniforms = new UniformGroup({\n      uMapCoord: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uClampFrame: { value: new Float32Array([0, 0, 1, 1]), type: \"vec4<f32>\" },\n      uClampOffset: { value: new Float32Array([0, 0]), type: \"vec2<f32>\" },\n      uTextureTransform: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uSizeAnchor: { value: new Float32Array([100, 100, 0.5, 0.5]), type: \"vec4<f32>\" }\n    });\n    super({\n      glProgram,\n      gpuProgram,\n      resources: {\n        localUniforms: new UniformGroup({\n          uTransformMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n          uColor: { value: new Float32Array([1, 1, 1, 1]), type: \"vec4<f32>\" },\n          uRound: { value: 0, type: \"f32\" }\n        }),\n        tilingUniforms,\n        uTexture: Texture.EMPTY.source,\n        uSampler: Texture.EMPTY.source.style\n      }\n    });\n  }\n  updateUniforms(width, height, matrix, anchorX, anchorY, texture) {\n    const tilingUniforms = this.resources.tilingUniforms;\n    const textureWidth = texture.width;\n    const textureHeight = texture.height;\n    const textureMatrix = texture.textureMatrix;\n    const uTextureTransform = tilingUniforms.uniforms.uTextureTransform;\n    uTextureTransform.set(\n      matrix.a * textureWidth / width,\n      matrix.b * textureWidth / height,\n      matrix.c * textureHeight / width,\n      matrix.d * textureHeight / height,\n      matrix.tx / width,\n      matrix.ty / height\n    );\n    uTextureTransform.invert();\n    tilingUniforms.uniforms.uMapCoord = textureMatrix.mapCoord;\n    tilingUniforms.uniforms.uClampFrame = textureMatrix.uClampFrame;\n    tilingUniforms.uniforms.uClampOffset = textureMatrix.uClampOffset;\n    tilingUniforms.uniforms.uTextureTransform = uTextureTransform;\n    tilingUniforms.uniforms.uSizeAnchor[0] = width;\n    tilingUniforms.uniforms.uSizeAnchor[1] = height;\n    tilingUniforms.uniforms.uSizeAnchor[2] = anchorX;\n    tilingUniforms.uniforms.uSizeAnchor[3] = anchorY;\n    if (texture) {\n      this.resources.uTexture = texture.source;\n      this.resources.uSampler = texture.source.style;\n    }\n  }\n}\n\nexport { TilingSpriteShader };\n//# sourceMappingURL=TilingSpriteShader.mjs.map\n","import { MeshGeometry } from '../../mesh/shared/MeshGeometry.mjs';\n\n\"use strict\";\nclass QuadGeometry extends MeshGeometry {\n  constructor() {\n    super({\n      positions: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\n      uvs: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\n      indices: new Uint32Array([0, 1, 2, 0, 2, 3])\n    });\n  }\n}\n\nexport { QuadGeometry };\n//# sourceMappingURL=QuadGeometry.mjs.map\n","\"use strict\";\nfunction setPositions(tilingSprite, positions) {\n  const anchorX = tilingSprite.anchor.x;\n  const anchorY = tilingSprite.anchor.y;\n  positions[0] = -anchorX * tilingSprite.width;\n  positions[1] = -anchorY * tilingSprite.height;\n  positions[2] = (1 - anchorX) * tilingSprite.width;\n  positions[3] = -anchorY * tilingSprite.height;\n  positions[4] = (1 - anchorX) * tilingSprite.width;\n  positions[5] = (1 - anchorY) * tilingSprite.height;\n  positions[6] = -anchorX * tilingSprite.width;\n  positions[7] = (1 - anchorY) * tilingSprite.height;\n}\n\nexport { setPositions };\n//# sourceMappingURL=setPositions.mjs.map\n","\"use strict\";\nfunction applyMatrix(array, stride, offset, matrix) {\n  let index = 0;\n  const size = array.length / (stride || 2);\n  const a = matrix.a;\n  const b = matrix.b;\n  const c = matrix.c;\n  const d = matrix.d;\n  const tx = matrix.tx;\n  const ty = matrix.ty;\n  offset *= stride;\n  while (index < size) {\n    const x = array[offset];\n    const y = array[offset + 1];\n    array[offset] = a * x + c * y + tx;\n    array[offset + 1] = b * x + d * y + ty;\n    offset += stride;\n    index++;\n  }\n}\n\nexport { applyMatrix };\n//# sourceMappingURL=applyMatrix.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { applyMatrix } from './applyMatrix.mjs';\n\n\"use strict\";\nfunction setUvs(tilingSprite, uvs) {\n  const texture = tilingSprite.texture;\n  const width = texture.frame.width;\n  const height = texture.frame.height;\n  let anchorX = 0;\n  let anchorY = 0;\n  if (tilingSprite.applyAnchorToTexture) {\n    anchorX = tilingSprite.anchor.x;\n    anchorY = tilingSprite.anchor.y;\n  }\n  uvs[0] = uvs[6] = -anchorX;\n  uvs[2] = uvs[4] = 1 - anchorX;\n  uvs[1] = uvs[3] = -anchorY;\n  uvs[5] = uvs[7] = 1 - anchorY;\n  const textureMatrix = Matrix.shared;\n  textureMatrix.copyFrom(tilingSprite._tileTransform.matrix);\n  textureMatrix.tx /= tilingSprite.width;\n  textureMatrix.ty /= tilingSprite.height;\n  textureMatrix.invert();\n  textureMatrix.scale(tilingSprite.width / width, tilingSprite.height / height);\n  applyMatrix(uvs, 2, 0, textureMatrix);\n}\n\nexport { setUvs };\n//# sourceMappingURL=setUvs.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { getAdjustedBlendModeBlend } from '../../rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nimport { State } from '../../rendering/renderers/shared/state/State.mjs';\nimport { RendererType } from '../../rendering/renderers/types.mjs';\nimport { color32BitToUniform } from '../graphics/gpu/colorToUniform.mjs';\nimport { BatchableMesh } from '../mesh/shared/BatchableMesh.mjs';\nimport { MeshGeometry } from '../mesh/shared/MeshGeometry.mjs';\nimport { TilingSpriteShader } from './shader/TilingSpriteShader.mjs';\nimport { QuadGeometry } from './utils/QuadGeometry.mjs';\nimport { setPositions } from './utils/setPositions.mjs';\nimport { setUvs } from './utils/setUvs.mjs';\n\n\"use strict\";\nconst sharedQuad = new QuadGeometry();\nclass TilingSpriteGpuData {\n  constructor() {\n    this.canBatch = true;\n    this.geometry = new MeshGeometry({\n      indices: sharedQuad.indices.slice(),\n      positions: sharedQuad.positions.slice(),\n      uvs: sharedQuad.uvs.slice()\n    });\n  }\n  destroy() {\n    this.geometry.destroy();\n    this.shader?.destroy();\n  }\n}\nclass TilingSpritePipe {\n  constructor(renderer) {\n    this._state = State.default2d;\n    this._renderer = renderer;\n  }\n  validateRenderable(renderable) {\n    const tilingSpriteData = this._getTilingSpriteData(renderable);\n    const couldBatch = tilingSpriteData.canBatch;\n    this._updateCanBatch(renderable);\n    const canBatch = tilingSpriteData.canBatch;\n    if (canBatch && canBatch === couldBatch) {\n      const { batchableMesh } = tilingSpriteData;\n      return !batchableMesh._batcher.checkAndUpdateTexture(\n        batchableMesh,\n        renderable.texture\n      );\n    }\n    return couldBatch !== canBatch;\n  }\n  addRenderable(tilingSprite, instructionSet) {\n    const batcher = this._renderer.renderPipes.batch;\n    this._updateCanBatch(tilingSprite);\n    const tilingSpriteData = this._getTilingSpriteData(tilingSprite);\n    const { geometry, canBatch } = tilingSpriteData;\n    if (canBatch) {\n      tilingSpriteData.batchableMesh || (tilingSpriteData.batchableMesh = new BatchableMesh());\n      const batchableMesh = tilingSpriteData.batchableMesh;\n      if (tilingSprite.didViewUpdate) {\n        this._updateBatchableMesh(tilingSprite);\n        batchableMesh.geometry = geometry;\n        batchableMesh.renderable = tilingSprite;\n        batchableMesh.transform = tilingSprite.groupTransform;\n        batchableMesh.setTexture(tilingSprite._texture);\n      }\n      batchableMesh.roundPixels = this._renderer._roundPixels | tilingSprite._roundPixels;\n      batcher.addToBatch(batchableMesh, instructionSet);\n    } else {\n      batcher.break(instructionSet);\n      tilingSpriteData.shader || (tilingSpriteData.shader = new TilingSpriteShader());\n      this.updateRenderable(tilingSprite);\n      instructionSet.add(tilingSprite);\n    }\n  }\n  execute(tilingSprite) {\n    const { shader } = this._getTilingSpriteData(tilingSprite);\n    shader.groups[0] = this._renderer.globalUniforms.bindGroup;\n    const localUniforms = shader.resources.localUniforms.uniforms;\n    localUniforms.uTransformMatrix = tilingSprite.groupTransform;\n    localUniforms.uRound = this._renderer._roundPixels | tilingSprite._roundPixels;\n    color32BitToUniform(\n      tilingSprite.groupColorAlpha,\n      localUniforms.uColor,\n      0\n    );\n    this._state.blendMode = getAdjustedBlendModeBlend(tilingSprite.groupBlendMode, tilingSprite.texture._source);\n    this._renderer.encoder.draw({\n      geometry: sharedQuad,\n      shader,\n      state: this._state\n    });\n  }\n  updateRenderable(tilingSprite) {\n    const tilingSpriteData = this._getTilingSpriteData(tilingSprite);\n    const { canBatch } = tilingSpriteData;\n    if (canBatch) {\n      const { batchableMesh } = tilingSpriteData;\n      if (tilingSprite.didViewUpdate)\n        this._updateBatchableMesh(tilingSprite);\n      batchableMesh._batcher.updateElement(batchableMesh);\n    } else if (tilingSprite.didViewUpdate) {\n      const { shader } = tilingSpriteData;\n      shader.updateUniforms(\n        tilingSprite.width,\n        tilingSprite.height,\n        tilingSprite._tileTransform.matrix,\n        tilingSprite.anchor.x,\n        tilingSprite.anchor.y,\n        tilingSprite.texture\n      );\n    }\n  }\n  _getTilingSpriteData(renderable) {\n    return renderable._gpuData[this._renderer.uid] || this._initTilingSpriteData(renderable);\n  }\n  _initTilingSpriteData(tilingSprite) {\n    const gpuData = new TilingSpriteGpuData();\n    gpuData.renderable = tilingSprite;\n    tilingSprite._gpuData[this._renderer.uid] = gpuData;\n    return gpuData;\n  }\n  _updateBatchableMesh(tilingSprite) {\n    const renderableData = this._getTilingSpriteData(tilingSprite);\n    const { geometry } = renderableData;\n    const style = tilingSprite.texture.source.style;\n    if (style.addressMode !== \"repeat\") {\n      style.addressMode = \"repeat\";\n      style.update();\n    }\n    setUvs(tilingSprite, geometry.uvs);\n    setPositions(tilingSprite, geometry.positions);\n  }\n  destroy() {\n    this._renderer = null;\n  }\n  _updateCanBatch(tilingSprite) {\n    const renderableData = this._getTilingSpriteData(tilingSprite);\n    const texture = tilingSprite.texture;\n    let _nonPowOf2wrapping = true;\n    if (this._renderer.type === RendererType.WEBGL) {\n      _nonPowOf2wrapping = this._renderer.context.supports.nonPowOf2wrapping;\n    }\n    renderableData.canBatch = texture.textureMatrix.isSimple && (_nonPowOf2wrapping || texture.source.isPowerOfTwo);\n    return renderableData.canBatch;\n  }\n}\n/** @ignore */\nTilingSpritePipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"tilingSprite\"\n};\n\nexport { TilingSpriteGpuData, TilingSpritePipe };\n//# sourceMappingURL=TilingSpritePipe.mjs.map\n","\"use strict\";\nconst localUniformMSDFBit = {\n  name: \"local-uniform-msdf-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32,\n                uRound:f32,\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        `\n    ),\n    end: (\n      /* wgsl */\n      `\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* wgsl */\n      `\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n         `\n    ),\n    main: (\n      /* wgsl */\n      `\n            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));\n        `\n    )\n  }\n};\nconst localUniformMSDFBitGl = {\n  name: \"local-uniform-msdf-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n            vColor *= uColor;\n            modelMatrix *= uTransformMatrix;\n        `\n    ),\n    end: (\n      /* glsl */\n      `\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* glsl */\n      `\n            uniform float uDistance;\n         `\n    ),\n    main: (\n      /* glsl */\n      `\n            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));\n        `\n    )\n  }\n};\n\nexport { localUniformMSDFBit, localUniformMSDFBitGl };\n//# sourceMappingURL=localUniformMSDFBit.mjs.map\n","\"use strict\";\nconst mSDFBit = {\n  name: \"msdf-bit\",\n  fragment: {\n    header: (\n      /* wgsl */\n      `\n            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {\n\n                // MSDF\n                var median = msdfColor.r + msdfColor.g + msdfColor.b -\n                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                var screenPxDistance = distance * (median - 0.5);\n                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));\n                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);\n                var coverage: f32 = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n\n            }\n        `\n    )\n  }\n};\nconst mSDFBitGl = {\n  name: \"msdf-bit\",\n  fragment: {\n    header: (\n      /* glsl */\n      `\n            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {\n\n                // MSDF\n                float median = msdfColor.r + msdfColor.g + msdfColor.b -\n                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                float screenPxDistance = distance * (median - 0.5);\n                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));\n                float gamma = mix(1.0, 1.0 / 2.2, luma);\n                float coverage = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n            }\n        `\n    )\n  }\n};\n\nexport { mSDFBit, mSDFBitGl };\n//# sourceMappingURL=mSDFBit.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { compileHighShaderGpuProgram, compileHighShaderGlProgram } from '../../../rendering/high-shader/compileHighShaderToProgram.mjs';\nimport { colorBit, colorBitGl } from '../../../rendering/high-shader/shader-bits/colorBit.mjs';\nimport { generateTextureBatchBit, generateTextureBatchBitGl } from '../../../rendering/high-shader/shader-bits/generateTextureBatchBit.mjs';\nimport { roundPixelsBit, roundPixelsBitGl } from '../../../rendering/high-shader/shader-bits/roundPixelsBit.mjs';\nimport { getBatchSamplersUniformGroup } from '../../../rendering/renderers/gl/shader/getBatchSamplersUniformGroup.mjs';\nimport { Shader } from '../../../rendering/renderers/shared/shader/Shader.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { localUniformMSDFBit, localUniformMSDFBitGl } from './shader-bits/localUniformMSDFBit.mjs';\nimport { mSDFBit, mSDFBitGl } from './shader-bits/mSDFBit.mjs';\n\n\"use strict\";\nlet gpuProgram;\nlet glProgram;\nclass SdfShader extends Shader {\n  constructor(maxTextures) {\n    const uniforms = new UniformGroup({\n      uColor: { value: new Float32Array([1, 1, 1, 1]), type: \"vec4<f32>\" },\n      uTransformMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uDistance: { value: 4, type: \"f32\" },\n      uRound: { value: 0, type: \"f32\" }\n    });\n    gpuProgram ?? (gpuProgram = compileHighShaderGpuProgram({\n      name: \"sdf-shader\",\n      bits: [\n        colorBit,\n        generateTextureBatchBit(maxTextures),\n        localUniformMSDFBit,\n        mSDFBit,\n        roundPixelsBit\n      ]\n    }));\n    glProgram ?? (glProgram = compileHighShaderGlProgram({\n      name: \"sdf-shader\",\n      bits: [\n        colorBitGl,\n        generateTextureBatchBitGl(maxTextures),\n        localUniformMSDFBitGl,\n        mSDFBitGl,\n        roundPixelsBitGl\n      ]\n    }));\n    super({\n      glProgram,\n      gpuProgram,\n      resources: {\n        localUniforms: uniforms,\n        batchSamplers: getBatchSamplersUniformGroup(maxTextures)\n      }\n    });\n  }\n}\n\nexport { SdfShader };\n//# sourceMappingURL=SdfShader.mjs.map\n","import { Cache } from '../../assets/cache/Cache.mjs';\nimport { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { Graphics } from '../graphics/shared/Graphics.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { SdfShader } from '../text/sdfShader/SdfShader.mjs';\nimport { BitmapFontManager } from './BitmapFontManager.mjs';\nimport { getBitmapTextLayout } from './utils/getBitmapTextLayout.mjs';\n\n\"use strict\";\nclass BitmapTextGraphics extends Graphics {\n  destroy() {\n    if (this.context.customShader) {\n      this.context.customShader.destroy();\n    }\n    super.destroy();\n  }\n}\nclass BitmapTextPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  validateRenderable(bitmapText) {\n    const graphicsRenderable = this._getGpuBitmapText(bitmapText);\n    return this._renderer.renderPipes.graphics.validateRenderable(graphicsRenderable);\n  }\n  addRenderable(bitmapText, instructionSet) {\n    const graphicsRenderable = this._getGpuBitmapText(bitmapText);\n    syncWithProxy(bitmapText, graphicsRenderable);\n    if (bitmapText._didTextUpdate) {\n      bitmapText._didTextUpdate = false;\n      this._updateContext(bitmapText, graphicsRenderable);\n    }\n    this._renderer.renderPipes.graphics.addRenderable(graphicsRenderable, instructionSet);\n    if (graphicsRenderable.context.customShader) {\n      this._updateDistanceField(bitmapText);\n    }\n  }\n  updateRenderable(bitmapText) {\n    const graphicsRenderable = this._getGpuBitmapText(bitmapText);\n    syncWithProxy(bitmapText, graphicsRenderable);\n    this._renderer.renderPipes.graphics.updateRenderable(graphicsRenderable);\n    if (graphicsRenderable.context.customShader) {\n      this._updateDistanceField(bitmapText);\n    }\n  }\n  _updateContext(bitmapText, proxyGraphics) {\n    const { context } = proxyGraphics;\n    const bitmapFont = BitmapFontManager.getFont(bitmapText.text, bitmapText._style);\n    context.clear();\n    if (bitmapFont.distanceField.type !== \"none\") {\n      if (!context.customShader) {\n        context.customShader = new SdfShader(this._renderer.limits.maxBatchableTextures);\n      }\n    }\n    const chars = CanvasTextMetrics.graphemeSegmenter(bitmapText.text);\n    const style = bitmapText._style;\n    let currentY = bitmapFont.baseLineOffset;\n    const bitmapTextLayout = getBitmapTextLayout(chars, style, bitmapFont, true);\n    const padding = style.padding;\n    const scale = bitmapTextLayout.scale;\n    let tx = bitmapTextLayout.width;\n    let ty = bitmapTextLayout.height + bitmapTextLayout.offsetY;\n    if (style._stroke) {\n      tx += style._stroke.width / scale;\n      ty += style._stroke.width / scale;\n    }\n    context.translate(-bitmapText._anchor._x * tx - padding, -bitmapText._anchor._y * ty - padding).scale(scale, scale);\n    const tint = bitmapFont.applyFillAsTint ? style._fill.color : 16777215;\n    let fontSize = bitmapFont.fontMetrics.fontSize;\n    let lineHeight = bitmapFont.lineHeight;\n    if (style.lineHeight) {\n      fontSize = style.fontSize / scale;\n      lineHeight = style.lineHeight / scale;\n    }\n    let linePositionYShift = (lineHeight - fontSize) / 2;\n    if (linePositionYShift - bitmapFont.baseLineOffset < 0) {\n      linePositionYShift = 0;\n    }\n    for (let i = 0; i < bitmapTextLayout.lines.length; i++) {\n      const line = bitmapTextLayout.lines[i];\n      for (let j = 0; j < line.charPositions.length; j++) {\n        const char = line.chars[j];\n        const charData = bitmapFont.chars[char];\n        if (charData?.texture) {\n          const texture = charData.texture;\n          context.texture(\n            texture,\n            tint ? tint : \"black\",\n            Math.round(line.charPositions[j] + charData.xOffset),\n            Math.round(currentY + charData.yOffset + linePositionYShift),\n            texture.orig.width,\n            texture.orig.height\n          );\n        }\n      }\n      currentY += lineHeight;\n    }\n  }\n  _getGpuBitmapText(bitmapText) {\n    return bitmapText._gpuData[this._renderer.uid] || this.initGpuText(bitmapText);\n  }\n  initGpuText(bitmapText) {\n    const proxyRenderable = new BitmapTextGraphics();\n    bitmapText._gpuData[this._renderer.uid] = proxyRenderable;\n    this._updateContext(bitmapText, proxyRenderable);\n    return proxyRenderable;\n  }\n  _updateDistanceField(bitmapText) {\n    const context = this._getGpuBitmapText(bitmapText).context;\n    const fontFamily = bitmapText._style.fontFamily;\n    const dynamicFont = Cache.get(`${fontFamily}-bitmap`);\n    const { a, b, c, d } = bitmapText.groupTransform;\n    const dx = Math.sqrt(a * a + b * b);\n    const dy = Math.sqrt(c * c + d * d);\n    const worldScale = (Math.abs(dx) + Math.abs(dy)) / 2;\n    const fontScale = dynamicFont.baseRenderedFontSize / bitmapText._style.fontSize;\n    const distance = worldScale * dynamicFont.distanceField.range * (1 / fontScale);\n    context.customShader.resources.localUniforms.uniforms.uDistance = distance;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nBitmapTextPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"bitmapText\"\n};\nfunction syncWithProxy(container, proxy) {\n  proxy.groupTransform = container.groupTransform;\n  proxy.groupColorAlpha = container.groupColorAlpha;\n  proxy.groupColor = container.groupColor;\n  proxy.groupBlendMode = container.groupBlendMode;\n  proxy.globalDisplayStatus = container.globalDisplayStatus;\n  proxy.groupTransform = container.groupTransform;\n  proxy.localDisplayStatus = container.localDisplayStatus;\n  proxy.groupAlpha = container.groupAlpha;\n  proxy._roundPixels = container._roundPixels;\n}\n\nexport { BitmapTextGraphics, BitmapTextPipe };\n//# sourceMappingURL=BitmapTextPipe.mjs.map\n","import { BatchableSprite } from '../sprite/BatchableSprite.mjs';\n\n\"use strict\";\nclass BatchableHTMLText extends BatchableSprite {\n  /**\n   * Creates an instance of BatchableHTMLText.\n   * @param renderer - The renderer instance to be used.\n   */\n  constructor(renderer) {\n    super();\n    this.generatingTexture = false;\n    this.currentKey = \"--\";\n    this._renderer = renderer;\n    renderer.runners.resolutionChange.add(this);\n  }\n  /** Handles resolution changes for the HTML text. If the text has auto resolution enabled, it triggers a view update. */\n  resolutionChange() {\n    const text = this.renderable;\n    if (text._autoResolution) {\n      text.onViewUpdate();\n    }\n  }\n  /** Destroys the BatchableHTMLText instance. Returns the texture promise to the renderer and cleans up references. */\n  destroy() {\n    const { htmlText } = this._renderer;\n    htmlText.getReferenceCount(this.currentKey) === null ? htmlText.returnTexturePromise(this.texturePromise) : htmlText.decreaseReferenceCount(this.currentKey);\n    this._renderer.runners.resolutionChange.remove(this);\n    this.texturePromise = null;\n    this._renderer = null;\n  }\n}\n\nexport { BatchableHTMLText };\n//# sourceMappingURL=BatchableHTMLText.mjs.map\n","import { updateQuadBounds } from '../../../utils/data/updateQuadBounds.mjs';\n\n\"use strict\";\nfunction updateTextBounds(batchableSprite, text) {\n  const { texture, bounds } = batchableSprite;\n  const padding = text._style._getFinalPadding();\n  updateQuadBounds(bounds, text._anchor, texture);\n  const paddingOffset = text._anchor._x * padding * 2;\n  const paddingOffsetY = text._anchor._y * padding * 2;\n  bounds.minX -= padding - paddingOffset;\n  bounds.minY -= padding - paddingOffsetY;\n  bounds.maxX -= padding - paddingOffset;\n  bounds.maxY -= padding - paddingOffsetY;\n}\n\nexport { updateTextBounds };\n//# sourceMappingURL=updateTextBounds.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { updateTextBounds } from '../text/utils/updateTextBounds.mjs';\nimport { BatchableHTMLText } from './BatchableHTMLText.mjs';\n\n\"use strict\";\nclass HTMLTextPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  validateRenderable(htmlText) {\n    const gpuText = this._getGpuText(htmlText);\n    const newKey = htmlText.styleKey;\n    if (gpuText.currentKey !== newKey) {\n      return true;\n    }\n    return false;\n  }\n  addRenderable(htmlText, instructionSet) {\n    const batchableHTMLText = this._getGpuText(htmlText);\n    if (htmlText._didTextUpdate) {\n      const resolution = htmlText._autoResolution ? this._renderer.resolution : htmlText.resolution;\n      if (batchableHTMLText.currentKey !== htmlText.styleKey || htmlText.resolution !== resolution) {\n        this._updateGpuText(htmlText).catch((e) => {\n          console.error(e);\n        });\n      }\n      htmlText._didTextUpdate = false;\n      updateTextBounds(batchableHTMLText, htmlText);\n    }\n    this._renderer.renderPipes.batch.addToBatch(batchableHTMLText, instructionSet);\n  }\n  updateRenderable(htmlText) {\n    const batchableHTMLText = this._getGpuText(htmlText);\n    batchableHTMLText._batcher.updateElement(batchableHTMLText);\n  }\n  async _updateGpuText(htmlText) {\n    htmlText._didTextUpdate = false;\n    const batchableHTMLText = this._getGpuText(htmlText);\n    if (batchableHTMLText.generatingTexture)\n      return;\n    const oldTexturePromise = batchableHTMLText.texturePromise;\n    batchableHTMLText.texturePromise = null;\n    batchableHTMLText.generatingTexture = true;\n    htmlText._resolution = htmlText._autoResolution ? this._renderer.resolution : htmlText.resolution;\n    let texturePromise = this._renderer.htmlText.getTexturePromise(htmlText);\n    if (oldTexturePromise) {\n      texturePromise = texturePromise.finally(() => {\n        this._renderer.htmlText.decreaseReferenceCount(batchableHTMLText.currentKey);\n        this._renderer.htmlText.returnTexturePromise(oldTexturePromise);\n      });\n    }\n    batchableHTMLText.texturePromise = texturePromise;\n    batchableHTMLText.currentKey = htmlText.styleKey;\n    batchableHTMLText.texture = await texturePromise;\n    const renderGroup = htmlText.renderGroup || htmlText.parentRenderGroup;\n    if (renderGroup) {\n      renderGroup.structureDidChange = true;\n    }\n    batchableHTMLText.generatingTexture = false;\n    updateTextBounds(batchableHTMLText, htmlText);\n  }\n  _getGpuText(htmlText) {\n    return htmlText._gpuData[this._renderer.uid] || this.initGpuText(htmlText);\n  }\n  initGpuText(htmlText) {\n    const batchableHTMLText = new BatchableHTMLText(this._renderer);\n    batchableHTMLText.renderable = htmlText;\n    batchableHTMLText.transform = htmlText.groupTransform;\n    batchableHTMLText.texture = Texture.EMPTY;\n    batchableHTMLText.bounds = { minX: 0, maxX: 1, minY: 0, maxY: 0 };\n    batchableHTMLText.roundPixels = this._renderer._roundPixels | htmlText._roundPixels;\n    htmlText._resolution = htmlText._autoResolution ? this._renderer.resolution : htmlText.resolution;\n    htmlText._gpuData[this._renderer.uid] = batchableHTMLText;\n    return batchableHTMLText;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nHTMLTextPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"htmlText\"\n};\n\nexport { HTMLTextPipe };\n//# sourceMappingURL=HTMLTextPipe.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\n\n\"use strict\";\nfunction isSafari() {\n  const { userAgent } = DOMAdapter.get().getNavigator();\n  return /^((?!chrome|android).)*safari/i.test(userAgent);\n}\n\nexport { isSafari };\n//# sourceMappingURL=isSafari.mjs.map\n","import { TexturePool } from '../../../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { Bounds } from '../../container/bounds/Bounds.mjs';\n\n\"use strict\";\nconst tempBounds = new Bounds();\nfunction getPo2TextureFromSource(image, width, height, resolution) {\n  const bounds = tempBounds;\n  bounds.minX = 0;\n  bounds.minY = 0;\n  bounds.maxX = image.width / resolution | 0;\n  bounds.maxY = image.height / resolution | 0;\n  const texture = TexturePool.getOptimalTexture(\n    bounds.width,\n    bounds.height,\n    resolution,\n    false\n  );\n  texture.source.uploadMethodId = \"image\";\n  texture.source.resource = image;\n  texture.source.alphaMode = \"premultiply-alpha-on-upload\";\n  texture.frame.width = width / resolution;\n  texture.frame.height = height / resolution;\n  texture.source.emit(\"update\", texture.source);\n  texture.updateUvs();\n  return texture;\n}\n\nexport { getPo2TextureFromSource };\n//# sourceMappingURL=getPo2TextureFromSource.mjs.map\n","\"use strict\";\nfunction extractFontFamilies(text, style) {\n  const fontFamily = style.fontFamily;\n  const fontFamilies = [];\n  const dedupe = {};\n  const regex = /font-family:([^;\"\\s]+)/g;\n  const matches = text.match(regex);\n  function addFontFamily(fontFamily2) {\n    if (!dedupe[fontFamily2]) {\n      fontFamilies.push(fontFamily2);\n      dedupe[fontFamily2] = true;\n    }\n  }\n  if (Array.isArray(fontFamily)) {\n    for (let i = 0; i < fontFamily.length; i++) {\n      addFontFamily(fontFamily[i]);\n    }\n  } else {\n    addFontFamily(fontFamily);\n  }\n  if (matches) {\n    matches.forEach((match) => {\n      const fontFamily2 = match.split(\":\")[1].trim();\n      addFontFamily(fontFamily2);\n    });\n  }\n  for (const i in style.tagStyles) {\n    const fontFamily2 = style.tagStyles[i].fontFamily;\n    addFontFamily(fontFamily2);\n  }\n  return fontFamilies;\n}\n\nexport { extractFontFamilies };\n//# sourceMappingURL=extractFontFamilies.mjs.map\n","import { DOMAdapter } from '../../../environment/adapter.mjs';\n\n\"use strict\";\nasync function loadFontAsBase64(url) {\n  const response = await DOMAdapter.get().fetch(url);\n  const blob = await response.blob();\n  const reader = new FileReader();\n  const dataSrc = await new Promise((resolve, reject) => {\n    reader.onloadend = () => resolve(reader.result);\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n  return dataSrc;\n}\n\nexport { loadFontAsBase64 };\n//# sourceMappingURL=loadFontAsBase64.mjs.map\n","import { loadFontAsBase64 } from './loadFontAsBase64.mjs';\n\n\"use strict\";\nasync function loadFontCSS(style, url) {\n  const dataSrc = await loadFontAsBase64(url);\n  return `@font-face {\n        font-family: \"${style.fontFamily}\";\n        font-weight: ${style.fontWeight};\n        font-style: ${style.fontStyle};\n        src: url('${dataSrc}');\n    }`;\n}\n\nexport { loadFontCSS };\n//# sourceMappingURL=loadFontCSS.mjs.map\n","import { Cache } from '../../../assets/cache/Cache.mjs';\nimport { loadFontCSS } from './loadFontCSS.mjs';\n\n\"use strict\";\nconst FontStylePromiseCache = /* @__PURE__ */ new Map();\nasync function getFontCss(fontFamilies) {\n  const fontPromises = fontFamilies.filter((fontFamily) => Cache.has(`${fontFamily}-and-url`)).map((fontFamily) => {\n    if (!FontStylePromiseCache.has(fontFamily)) {\n      const { entries } = Cache.get(`${fontFamily}-and-url`);\n      const promises = [];\n      entries.forEach((entry) => {\n        const url = entry.url;\n        const faces = entry.faces;\n        const out = faces.map((face) => ({ weight: face.weight, style: face.style }));\n        promises.push(\n          ...out.map(\n            (style) => loadFontCSS(\n              {\n                fontWeight: style.weight,\n                fontStyle: style.style,\n                fontFamily\n              },\n              url\n            )\n          )\n        );\n      });\n      FontStylePromiseCache.set(\n        fontFamily,\n        Promise.all(promises).then((css) => css.join(\"\\n\"))\n      );\n    }\n    return FontStylePromiseCache.get(fontFamily);\n  });\n  return (await Promise.all(fontPromises)).join(\"\\n\");\n}\n\nexport { FontStylePromiseCache, getFontCss };\n//# sourceMappingURL=getFontCss.mjs.map\n","\"use strict\";\nfunction getSVGUrl(text, style, resolution, fontCSS, htmlTextData) {\n  const { domElement, styleElement, svgRoot } = htmlTextData;\n  domElement.innerHTML = `<style>${style.cssStyle}</style><div style='padding:0;'>${text}</div>`;\n  domElement.setAttribute(\"style\", `transform: scale(${resolution});transform-origin: top left; display: inline-block`);\n  styleElement.textContent = fontCSS;\n  const { width, height } = htmlTextData.image;\n  svgRoot.setAttribute(\"width\", width.toString());\n  svgRoot.setAttribute(\"height\", height.toString());\n  return new XMLSerializer().serializeToString(svgRoot);\n}\n\nexport { getSVGUrl };\n//# sourceMappingURL=getSVGUrl.mjs.map\n","import { CanvasPool } from '../../../rendering/renderers/shared/texture/CanvasPool.mjs';\n\n\"use strict\";\nfunction getTemporaryCanvasFromImage(image, resolution) {\n  const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(\n    image.width,\n    image.height,\n    resolution\n  );\n  const { context } = canvasAndContext;\n  context.clearRect(0, 0, image.width, image.height);\n  context.drawImage(image, 0, 0);\n  return canvasAndContext;\n}\n\nexport { getTemporaryCanvasFromImage };\n//# sourceMappingURL=getTemporaryCanvasFromImage.mjs.map\n","\"use strict\";\nfunction loadSVGImage(image, url, delay) {\n  return new Promise(async (resolve) => {\n    if (delay) {\n      await new Promise((resolve2) => setTimeout(resolve2, 100));\n    }\n    image.onload = () => {\n      resolve();\n    };\n    image.src = `data:image/svg+xml;charset=utf8,${encodeURIComponent(url)}`;\n    image.crossOrigin = \"anonymous\";\n  });\n}\n\nexport { loadSVGImage };\n//# sourceMappingURL=loadSVGImage.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { CanvasPool } from '../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { TexturePool } from '../../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { RendererType } from '../../rendering/renderers/types.mjs';\nimport { isSafari } from '../../utils/browser/isSafari.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { BigPool } from '../../utils/pool/PoolGroup.mjs';\nimport { getPo2TextureFromSource } from '../text/utils/getPo2TextureFromSource.mjs';\nimport { HTMLTextRenderData } from './HTMLTextRenderData.mjs';\nimport { extractFontFamilies } from './utils/extractFontFamilies.mjs';\nimport { getFontCss } from './utils/getFontCss.mjs';\nimport { getSVGUrl } from './utils/getSVGUrl.mjs';\nimport { getTemporaryCanvasFromImage } from './utils/getTemporaryCanvasFromImage.mjs';\nimport { loadSVGImage } from './utils/loadSVGImage.mjs';\nimport { measureHtmlText } from './utils/measureHtmlText.mjs';\n\n\"use strict\";\nclass HTMLTextSystem {\n  constructor(renderer) {\n    this._activeTextures = {};\n    this._renderer = renderer;\n    this._createCanvas = renderer.type === RendererType.WEBGPU;\n  }\n  /**\n   * @param options\n   * @deprecated Use getTexturePromise instead\n   */\n  getTexture(options) {\n    return this.getTexturePromise(options);\n  }\n  /**\n   * Increases the reference count for a texture.\n   * @param text - The HTMLText instance associated with the texture.\n   */\n  getManagedTexture(text) {\n    const textKey = text.styleKey;\n    if (this._activeTextures[textKey]) {\n      this._increaseReferenceCount(textKey);\n      return this._activeTextures[textKey].promise;\n    }\n    const promise = this._buildTexturePromise(text).then((texture) => {\n      this._activeTextures[textKey].texture = texture;\n      return texture;\n    });\n    this._activeTextures[textKey] = {\n      texture: null,\n      promise,\n      usageCount: 1\n    };\n    return promise;\n  }\n  /**\n   * Gets the current reference count for a texture associated with a text key.\n   * @param textKey - The unique key identifying the text style configuration\n   * @returns The number of Text instances currently using this texture\n   */\n  getReferenceCount(textKey) {\n    return this._activeTextures[textKey]?.usageCount ?? null;\n  }\n  _increaseReferenceCount(textKey) {\n    this._activeTextures[textKey].usageCount++;\n  }\n  /**\n   * Decreases the reference count for a texture.\n   * If the count reaches zero, the texture is cleaned up.\n   * @param textKey - The key associated with the HTMLText instance.\n   */\n  decreaseReferenceCount(textKey) {\n    const activeTexture = this._activeTextures[textKey];\n    if (!activeTexture)\n      return;\n    activeTexture.usageCount--;\n    if (activeTexture.usageCount === 0) {\n      if (activeTexture.texture) {\n        this._cleanUp(activeTexture.texture);\n      } else {\n        activeTexture.promise.then((texture) => {\n          activeTexture.texture = texture;\n          this._cleanUp(activeTexture.texture);\n        }).catch(() => {\n          warn(\"HTMLTextSystem: Failed to clean texture\");\n        });\n      }\n      this._activeTextures[textKey] = null;\n    }\n  }\n  /**\n   * Returns a promise that resolves to a texture for the given HTMLText options.\n   * @param options - The options for the HTMLText.\n   * @returns A promise that resolves to a Texture.\n   */\n  getTexturePromise(options) {\n    return this._buildTexturePromise(options);\n  }\n  async _buildTexturePromise(options) {\n    const { text, style, resolution, textureStyle } = options;\n    const htmlTextData = BigPool.get(HTMLTextRenderData);\n    const fontFamilies = extractFontFamilies(text, style);\n    const fontCSS = await getFontCss(fontFamilies);\n    const measured = measureHtmlText(text, style, fontCSS, htmlTextData);\n    const width = Math.ceil(Math.ceil(Math.max(1, measured.width) + style.padding * 2) * resolution);\n    const height = Math.ceil(Math.ceil(Math.max(1, measured.height) + style.padding * 2) * resolution);\n    const image = htmlTextData.image;\n    const uvSafeOffset = 2;\n    image.width = (width | 0) + uvSafeOffset;\n    image.height = (height | 0) + uvSafeOffset;\n    const svgURL = getSVGUrl(text, style, resolution, fontCSS, htmlTextData);\n    await loadSVGImage(image, svgURL, isSafari() && fontFamilies.length > 0);\n    const resource = image;\n    let canvasAndContext;\n    if (this._createCanvas) {\n      canvasAndContext = getTemporaryCanvasFromImage(image, resolution);\n    }\n    const texture = getPo2TextureFromSource(\n      canvasAndContext ? canvasAndContext.canvas : resource,\n      image.width - uvSafeOffset,\n      image.height - uvSafeOffset,\n      resolution\n    );\n    if (textureStyle)\n      texture.source.style = textureStyle;\n    if (this._createCanvas) {\n      this._renderer.texture.initSource(texture.source);\n      CanvasPool.returnCanvasAndContext(canvasAndContext);\n    }\n    BigPool.return(htmlTextData);\n    return texture;\n  }\n  returnTexturePromise(texturePromise) {\n    texturePromise.then((texture) => {\n      this._cleanUp(texture);\n    }).catch(() => {\n      warn(\"HTMLTextSystem: Failed to clean texture\");\n    });\n  }\n  _cleanUp(texture) {\n    TexturePool.returnTexture(texture, true);\n    texture.source.resource = null;\n    texture.source.uploadMethodId = \"unknown\";\n  }\n  destroy() {\n    this._renderer = null;\n    for (const key in this._activeTextures) {\n      if (this._activeTextures[key])\n        this.returnTexturePromise(this._activeTextures[key].promise);\n    }\n    this._activeTextures = null;\n  }\n}\n/** @ignore */\nHTMLTextSystem.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem,\n    ExtensionType.CanvasSystem\n  ],\n  name: \"htmlText\"\n};\n\nexport { HTMLTextSystem };\n//# sourceMappingURL=HTMLTextSystem.mjs.map\n","import { BatchableSprite } from '../../sprite/BatchableSprite.mjs';\n\n\"use strict\";\nclass BatchableText extends BatchableSprite {\n  constructor(renderer) {\n    super();\n    this._renderer = renderer;\n    renderer.runners.resolutionChange.add(this);\n  }\n  resolutionChange() {\n    const text = this.renderable;\n    if (text._autoResolution) {\n      text.onViewUpdate();\n    }\n  }\n  destroy() {\n    const { canvasText } = this._renderer;\n    const refCount = canvasText.getReferenceCount(this.currentKey);\n    if (refCount > 0) {\n      canvasText.decreaseReferenceCount(this.currentKey);\n    } else if (this.texture) {\n      canvasText.returnTexture(this.texture);\n    }\n    this._renderer.runners.resolutionChange.remove(this);\n    this._renderer = null;\n  }\n}\n\nexport { BatchableText };\n//# sourceMappingURL=BatchableText.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { updateTextBounds } from '../utils/updateTextBounds.mjs';\nimport { BatchableText } from './BatchableText.mjs';\n\n\"use strict\";\nclass CanvasTextPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  validateRenderable(text) {\n    const gpuText = this._getGpuText(text);\n    const newKey = text.styleKey;\n    if (gpuText.currentKey !== newKey)\n      return true;\n    return text._didTextUpdate;\n  }\n  addRenderable(text, instructionSet) {\n    const batchableText = this._getGpuText(text);\n    if (text._didTextUpdate) {\n      const resolution = text._autoResolution ? this._renderer.resolution : text.resolution;\n      if (batchableText.currentKey !== text.styleKey || text.resolution !== resolution) {\n        this._updateGpuText(text);\n      }\n      text._didTextUpdate = false;\n      updateTextBounds(batchableText, text);\n    }\n    this._renderer.renderPipes.batch.addToBatch(batchableText, instructionSet);\n  }\n  updateRenderable(text) {\n    const batchableText = this._getGpuText(text);\n    batchableText._batcher.updateElement(batchableText);\n  }\n  _updateGpuText(text) {\n    const batchableText = this._getGpuText(text);\n    if (batchableText.texture) {\n      this._renderer.canvasText.decreaseReferenceCount(batchableText.currentKey);\n    }\n    text._resolution = text._autoResolution ? this._renderer.resolution : text.resolution;\n    batchableText.texture = this._renderer.canvasText.getManagedTexture(text);\n    batchableText.currentKey = text.styleKey;\n  }\n  _getGpuText(text) {\n    return text._gpuData[this._renderer.uid] || this.initGpuText(text);\n  }\n  initGpuText(text) {\n    const batchableText = new BatchableText(this._renderer);\n    batchableText.currentKey = \"--\";\n    batchableText.renderable = text;\n    batchableText.transform = text.groupTransform;\n    batchableText.bounds = { minX: 0, maxX: 1, minY: 0, maxY: 0 };\n    batchableText.roundPixels = this._renderer._roundPixels | text._roundPixels;\n    text._gpuData[this._renderer.uid] = batchableText;\n    return batchableText;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nCanvasTextPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"text\"\n};\n\nexport { CanvasTextPipe };\n//# sourceMappingURL=CanvasTextPipe.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { TexturePool } from '../../../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { TextureStyle } from '../../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport { deprecation } from '../../../utils/logging/deprecation.mjs';\nimport { TextStyle } from '../TextStyle.mjs';\nimport { getPo2TextureFromSource } from '../utils/getPo2TextureFromSource.mjs';\nimport { CanvasTextGenerator } from './CanvasTextGenerator.mjs';\n\n\"use strict\";\nclass CanvasTextSystem {\n  constructor(_renderer) {\n    this._activeTextures = {};\n    this._renderer = _renderer;\n  }\n  getTexture(options, _resolution, _style, _textKey) {\n    if (typeof options === \"string\") {\n      deprecation(\"8.0.0\", \"CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments\");\n      options = {\n        text: options,\n        style: _style,\n        resolution: _resolution\n      };\n    }\n    if (!(options.style instanceof TextStyle)) {\n      options.style = new TextStyle(options.style);\n    }\n    if (!(options.textureStyle instanceof TextureStyle)) {\n      options.textureStyle = new TextureStyle(options.textureStyle);\n    }\n    if (typeof options.text !== \"string\") {\n      options.text = options.text.toString();\n    }\n    const { text, style, textureStyle } = options;\n    const resolution = options.resolution ?? this._renderer.resolution;\n    const { frame, canvasAndContext } = CanvasTextGenerator.getCanvasAndContext({\n      text,\n      style,\n      resolution\n    });\n    const texture = getPo2TextureFromSource(canvasAndContext.canvas, frame.width, frame.height, resolution);\n    if (textureStyle)\n      texture.source.style = textureStyle;\n    if (style.trim) {\n      frame.pad(style.padding);\n      texture.frame.copyFrom(frame);\n      texture.frame.scale(1 / resolution);\n      texture.updateUvs();\n    }\n    if (style.filters) {\n      const filteredTexture = this._applyFilters(texture, style.filters);\n      this.returnTexture(texture);\n      CanvasTextGenerator.returnCanvasAndContext(canvasAndContext);\n      return filteredTexture;\n    }\n    this._renderer.texture.initSource(texture._source);\n    CanvasTextGenerator.returnCanvasAndContext(canvasAndContext);\n    return texture;\n  }\n  /**\n   * Returns a texture that was created wit the above `getTexture` function.\n   * Handy if you are done with a texture and want to return it to the pool.\n   * @param texture - The texture to be returned.\n   */\n  returnTexture(texture) {\n    const source = texture.source;\n    source.resource = null;\n    source.uploadMethodId = \"unknown\";\n    source.alphaMode = \"no-premultiply-alpha\";\n    TexturePool.returnTexture(texture, true);\n  }\n  /**\n   * Renders text to its canvas, and updates its texture.\n   * @deprecated since 8.10.0\n   */\n  renderTextToCanvas() {\n    deprecation(\n      \"8.10.0\",\n      \"CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead\"\n    );\n  }\n  /**\n   * Gets or creates a managed texture for a Text object. This method handles texture reuse and reference counting.\n   * @param text - The Text object that needs a texture\n   * @returns A Texture instance that represents the rendered text\n   * @remarks\n   * This method performs the following:\n   * 1. Sets the appropriate resolution based on auto-resolution settings\n   * 2. Checks if a texture already exists for the text's style\n   * 3. Creates a new texture if needed or returns an existing one\n   * 4. Manages reference counting for texture reuse\n   */\n  getManagedTexture(text) {\n    text._resolution = text._autoResolution ? this._renderer.resolution : text.resolution;\n    const textKey = text.styleKey;\n    if (this._activeTextures[textKey]) {\n      this._increaseReferenceCount(textKey);\n      return this._activeTextures[textKey].texture;\n    }\n    const texture = this.getTexture({\n      text: text.text,\n      style: text.style,\n      resolution: text._resolution,\n      textureStyle: text.textureStyle\n    });\n    this._activeTextures[textKey] = {\n      texture,\n      usageCount: 1\n    };\n    return texture;\n  }\n  /**\n   * Decreases the reference count for a texture associated with a text key.\n   * When the reference count reaches zero, the texture is returned to the pool.\n   * @param textKey - The unique key identifying the text style configuration\n   * @remarks\n   * This method is crucial for memory management, ensuring textures are properly\n   * cleaned up when they are no longer needed by any Text instances.\n   */\n  decreaseReferenceCount(textKey) {\n    const activeTexture = this._activeTextures[textKey];\n    activeTexture.usageCount--;\n    if (activeTexture.usageCount === 0) {\n      this.returnTexture(activeTexture.texture);\n      this._activeTextures[textKey] = null;\n    }\n  }\n  /**\n   * Gets the current reference count for a texture associated with a text key.\n   * @param textKey - The unique key identifying the text style configuration\n   * @returns The number of Text instances currently using this texture\n   */\n  getReferenceCount(textKey) {\n    return this._activeTextures[textKey]?.usageCount ?? 0;\n  }\n  _increaseReferenceCount(textKey) {\n    this._activeTextures[textKey].usageCount++;\n  }\n  /**\n   * Applies the specified filters to the given texture.\n   *\n   * This method takes a texture and a list of filters, applies the filters to the texture,\n   * and returns the resulting texture. It also ensures that the alpha mode of the resulting\n   * texture is set to 'premultiplied-alpha'.\n   * @param {Texture} texture - The texture to which the filters will be applied.\n   * @param {Filter[]} filters - The filters to apply to the texture.\n   * @returns {Texture} The resulting texture after all filters have been applied.\n   */\n  _applyFilters(texture, filters) {\n    const currentRenderTarget = this._renderer.renderTarget.renderTarget;\n    const resultTexture = this._renderer.filter.generateFilteredTexture({\n      texture,\n      filters\n    });\n    this._renderer.renderTarget.bind(currentRenderTarget, false);\n    return resultTexture;\n  }\n  destroy() {\n    this._renderer = null;\n    for (const key in this._activeTextures) {\n      if (this._activeTextures[key])\n        this.returnTexture(this._activeTextures[key].texture);\n    }\n    this._activeTextures = null;\n  }\n}\n/** @ignore */\nCanvasTextSystem.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem,\n    ExtensionType.CanvasSystem\n  ],\n  name: \"canvasText\"\n};\n\nexport { CanvasTextSystem };\n//# sourceMappingURL=CanvasTextSystem.mjs.map\n","import { extensions } from '../extensions/Extensions.mjs';\nimport { ResizePlugin } from './ResizePlugin.mjs';\nimport { TickerPlugin } from './TickerPlugin.mjs';\n\n\"use strict\";\nextensions.add(ResizePlugin);\nextensions.add(TickerPlugin);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { GraphicsContextSystem } from './shared/GraphicsContextSystem.mjs';\nimport { GraphicsPipe } from './shared/GraphicsPipe.mjs';\n\n\"use strict\";\nextensions.add(GraphicsPipe);\nextensions.add(GraphicsContextSystem);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { MeshPipe } from './shared/MeshPipe.mjs';\n\n\"use strict\";\nextensions.add(MeshPipe);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { GlParticleContainerPipe } from './shared/GlParticleContainerPipe.mjs';\nimport { GpuParticleContainerPipe } from './shared/GpuParticleContainerPipe.mjs';\n\n\"use strict\";\nextensions.add(GlParticleContainerPipe);\nextensions.add(GpuParticleContainerPipe);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { CanvasTextPipe } from './canvas/CanvasTextPipe.mjs';\nimport { CanvasTextSystem } from './canvas/CanvasTextSystem.mjs';\n\n\"use strict\";\nextensions.add(CanvasTextSystem);\nextensions.add(CanvasTextPipe);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { BitmapTextPipe } from './BitmapTextPipe.mjs';\n\n\"use strict\";\nextensions.add(BitmapTextPipe);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { HTMLTextPipe } from './HTMLTextPipe.mjs';\nimport { HTMLTextSystem } from './HTMLTextSystem.mjs';\n\n\"use strict\";\nextensions.add(HTMLTextSystem);\nextensions.add(HTMLTextPipe);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { TilingSpritePipe } from './TilingSpritePipe.mjs';\n\n\"use strict\";\nextensions.add(TilingSpritePipe);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { NineSliceSpritePipe } from './NineSliceSpritePipe.mjs';\n\n\"use strict\";\nextensions.add(NineSliceSpritePipe);\n//# sourceMappingURL=init.mjs.map\n","import { extensions } from '../extensions/Extensions.mjs';\nimport { FilterPipe } from './FilterPipe.mjs';\nimport { FilterSystem } from './FilterSystem.mjs';\n\n\"use strict\";\nextensions.add(FilterSystem);\nextensions.add(FilterPipe);\n//# sourceMappingURL=init.mjs.map\n"],"names":["ResizePlugin","options","dom","width","height","clientWidth","clientHeight","ExtensionType","TickerPlugin","ticker","UPDATE_PRIORITY","Ticker","oldTicker","AbstractBitmapFont","EventEmitter","deprecation","v8_0_0","destroyTextures","i","page","LRU","max","ttl","resetTtl","key","item","keys","bypass","result","x","value","evicted","lru","genericFontFamilies","fontStringFromTextStyle","style","fontSizeString","fontFamilies","fontFamily","contextSettings","_CanvasTextMetrics","proto","DOMAdapter","text","lines","lineWidths","lineHeight","maxLineWidth","fontProperties","canvas","wordWrap","textKey","font","context","lineWidth","strokeWidth","measurements","letterSpacing","useExperimentalLetterSpacing","metrics","metricWidth","actualBoundingBoxLeft","boundsWidth","val","line","cache","whiteSpace","collapseSpaces","collapseNewlines","canPrependSpaces","wordWrapWidth","tokens","token","currIsBreakingSpace","lastIsBreakingSpace","tokenWidth","characters","j","char","lastChar","k","nextChar","characterWidth","isLastToken","newLine","_nextChar","_token","breakWords","_char","_index","_breakWords","properties","c","segmenter","s","segments","segment","CanvasTextMetrics","_TextStyle","uid","convertV7Tov8Style","fullStyle","thisKey","GraphicsContext","toFillStyle","toStrokeStyle","defaultStyle","filterPadding","destroyTextureSource","cb","target","property","newValue","Color","FillGradient","FillPattern","TextStyle","oldStyle","defaults","color","obj","warn","gradientFill","fillGradientStops","fills","stop","index","PRECISION","getCanvasFillStyle","fillStyle","textMetrics","padding","Texture","fillPattern","pattern","tempMatrix","Matrix","fillGradient","isLinear","isLocal","gradient","isNearlyVertical","start","end","center","innerRadius","outerCenter","outerRadius","ratio","globalStop","_DynamicBitmapFont","dynamicOptions","requestedFontSize","TextureStyle","chars","charList","self","pageData","textureSource","currentX","currentY","currentMaxCharHeight","fontScale","skipTexture","maxTextureWidth","maxTextureHeight","textureGlyphWidth","paddedWidth","paddedHeight","pageData2","xAdvance","px","py","frame","Rectangle","newChars","measureCache","first","second","c1","c2","total","amount","textureResolution","canvasAndContext","CanvasPool","resolution","texture","ImageSource","stroke","strokeThickness","shadowOptions","rgb","dropShadowBlur","dropShadowDistance","y","tx","ty","descent","removeShadow","shadowBlur","shadowOffsetX","shadowOffsetY","DynamicBitmapFont","getBitmapTextLayout","trimEnd","layoutData","currentLine","previousChar","firstWord","currentWord","scale","adjustedLetterSpacing","adjustedWordWrapWidth","adjustedLineHeight","nextWord","word","position","nextLine","checkIsOverflow","isEnd","charData","spaceWidth","kerning","nextCharWidth","alignCenter","alignRight","alignJustify","measurementData","offset","indy","spaceIndex","totalSpaces","resolveCharacters","startCode","endCode","i2","j2","fontCount","BitmapFontManagerClass","fontFamilyKey","overrideFill","Cache","styleCopy","fnt","dynamicFont","bitmapFont","id","args","name","textStyle","flatChars","cacheKey","BitmapFontManager","vertex","fragment","source","PassthroughFilter","Filter","gpuProgram","GpuProgram","glProgram","GlProgram","FilterPipe","renderer","filterEffect","container","instructionSet","_filterEffect","_container","instruction","tempProjectionMatrix","getGlobalRenderableBounds","renderables","bounds","actualMatrix","renderable","renderGroup","quadGeometry","Geometry","FilterData","Bounds","FilterSystem","UniformGroup","BindGroup","filters","filterData","colorTextureSource","rootResolution","rootAntialias","filter","previousFilterData","globalResolution","offsetX","offsetY","TexturePool","outputTexture","lastRenderSurface","previousBounds","backgroundResolution","backTexture","input","output","clear","isFinalTarget","filterToApply","outputMatrix","sprite","data","mappedMatrix","worldTransform","batchUniforms","RendererType","renderTarget","sourceWidth","sourceHeight","globalFrame","uniforms","outputFrame","inputSize","inputPixel","inputClamp","rootTexture","currentIndex","lastIndex","prevFilterData","filterFrameTransform","inputTexture","firstEnabled","lastEnabled","flip","tempTexture","flop","t","viewPort","paddingMultiplier","antialias","blendRequired","enabled","clipToViewport","firstEnabledIndex","lastEnabledIndex","_MeshGeometry","positions","uvs","indices","shrinkToFit","positionBuffer","Buffer","BufferUsage","uvBuffer","indexBuffer","MeshGeometry","_internalCanvas","_internalContext","ensureInternalCanvas","nextPow2","checkRow","checkColumn","top","bottom","stride","getCanvasBoundingBox","left","right","tempRect","CanvasTextGeneratorClass","measured","strokeStyle","linePositionX","linePositionY","passesCount","isShadowPass","dsOffsetText","dsOffsetShadow","dropShadowColor","dropShadowAlpha","strokePadding","linePositionYShift","isStroke","currentPosition","stringArray","previousWidth","currentWidth","currentChar","textStr","CanvasTextGenerator","nssvg","nsxhtml","HTMLTextRenderData","foreignObject","svgRoot","styleElement","domElement","tempHTMLTextRenderData","measureHtmlText","fontStyleCSS","htmlTextRenderData","contentBounds","doublePadding","GraphicsGpuData","batch","BigPool","GraphicsPipe","adaptor","State","graphics","wasBatched","gpuContext","batches","shader","localUniforms","color32BitToUniform","gpuData","batchPipe","roundPixels","batchClone","BatchableGraphics","_PlaneGeometry","verts","verticesX","verticesY","sizeX","sizeY","totalSub","xpos","ypos","value2","value3","value4","PlaneGeometry","BatchableMesh","transformedUvs","textureMatrix","MeshGpuData","MeshPipe","mesh","meshData","isBatched","geometry","batchableMesh","batcher","gpuBatchableMesh","getAdjustedBlendModeBlend","_a","_b","gpuMesh","GlParticleContainerAdaptor","particleContainerPipe","state","gl","buffer","glType","GpuParticleContainerAdaptor","createIndicesForQuads","size","outBuffer","totalIndices","generateParticleUpdateFunction","generateUpdateFunction","dynamic","funcFragments","attributeInfo","getAttributeInfoFromFormat","functionSource","ParticleBuffer","staticVertexSize","dynamicVertexSize","ViewableBuffer","dynamicOffset","staticOffset","uploadFunction","getParticleSyncKey","particles","uploadStatic","dynamicAttributeBuffer","staticAttributeBuffer","keyGen","wgsl","ParticleShader","Shader","ParticleContainerPipe","_renderable","children","transformationMatrix","GlParticleContainerPipe","GpuParticleContainerPipe","_NineSliceGeometry","p","_leftWidth","_rightWidth","_topHeight","_bottomHeight","_anchorX","_anchorY","w","scaleW","h","scaleH","anchorOffsetX","anchorOffsetY","_uvw","_uvh","NineSliceGeometry","NineSliceSpriteGpuData","NineSliceSpritePipe","gpuSprite","batchableSprite","tilingBit","tilingBitGl","TilingSpriteShader","compileHighShaderGpuProgram","localUniformBit","roundPixelsBit","compileHighShaderGlProgram","localUniformBitGl","roundPixelsBitGl","tilingUniforms","matrix","anchorX","anchorY","textureWidth","textureHeight","uTextureTransform","QuadGeometry","setPositions","tilingSprite","applyMatrix","array","a","b","d","setUvs","sharedQuad","TilingSpriteGpuData","TilingSpritePipe","tilingSpriteData","couldBatch","canBatch","renderableData","_nonPowOf2wrapping","localUniformMSDFBit","localUniformMSDFBitGl","mSDFBit","mSDFBitGl","SdfShader","maxTextures","colorBit","generateTextureBatchBit","colorBitGl","generateTextureBatchBitGl","getBatchSamplersUniformGroup","BitmapTextGraphics","Graphics","BitmapTextPipe","bitmapText","graphicsRenderable","syncWithProxy","proxyGraphics","bitmapTextLayout","tint","fontSize","proxyRenderable","dx","dy","worldScale","distance","proxy","BatchableHTMLText","BatchableSprite","htmlText","updateTextBounds","updateQuadBounds","paddingOffset","paddingOffsetY","HTMLTextPipe","gpuText","newKey","batchableHTMLText","e","oldTexturePromise","texturePromise","isSafari","userAgent","tempBounds","getPo2TextureFromSource","image","extractFontFamilies","dedupe","regex","matches","addFontFamily","fontFamily2","match","loadFontAsBase64","url","blob","reader","resolve","reject","loadFontCSS","dataSrc","FontStylePromiseCache","getFontCss","fontPromises","entries","promises","entry","out","face","css","getSVGUrl","fontCSS","htmlTextData","getTemporaryCanvasFromImage","loadSVGImage","delay","resolve2","HTMLTextSystem","promise","activeTexture","textureStyle","uvSafeOffset","svgURL","resource","BatchableText","canvasText","CanvasTextPipe","batchableText","CanvasTextSystem","_renderer","_resolution","_style","_textKey","filteredTexture","currentRenderTarget","resultTexture","extensions","GraphicsContextSystem"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78]}